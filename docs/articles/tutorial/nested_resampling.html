<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- Google Site Verification --><meta name="google-site-verification" content="BrjL5fpoyHZu1rR8rwnnM2MBO3u3iIFB8NsmSuOsY84">
<title>Nested Resampling â€¢ mlr</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../jquery.sticky-kit.min.js"></script><script src="../../pkgdown.js"></script><link href="../../extra.css" rel="stylesheet">
<script src="../../extra.js"></script><meta property="og:title" content="Nested Resampling">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css">
<link rel="icon" type="image/png" href="https://mlr-org.github.io/mlr/favicon.ico">
<link rel="apple-touch-icon" type="image/png" href="https://mlr-org.github.io/mlr/favicon.ico">
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a class="navbar-brand" href="../../index.html"></a>
      </div>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Basics
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/tutorial/task.html">Tasks</a>
    </li>
    <li>
      <a href="../../articles/tutorial/learner.html">Learners</a>
    </li>
    <li>
      <a href="../../articles/tutorial/train.html">Train</a>
    </li>
    <li>
      <a href="../../articles/tutorial/predict.html">Predict</a>
    </li>
    <li>
      <a href="../../articles/tutorial/preproc.html">Preprocessing</a>
    </li>
    <li>
      <a href="../../articles/tutorial/performance.html">Performance</a>
    </li>
    <li>
      <a href="../../articles/tutorial/resample.html">Resampling</a>
    </li>
    <li>
      <a href="../../articles/tutorial/tune.html">Tuning</a>
    </li>
    <li>
      <a href="../../articles/tutorial/benchmark_experiments.html">Benchmark Experiments</a>
    </li>
    <li>
      <a href="../../articles/tutorial/parallelization.html">Parallelization</a>
    </li>
    <li>
      <a href="../../articles/tutorial/visualization.html">Visualization</a>
    </li>
    <li>
      <a href="../../articles/tutorial/usecase_regression.html">Use case - Regression</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Advanced
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/tutorial/configureMlr.html">Configuration</a>
    </li>
    <li>
      <a href="../../articles/tutorial/wrapper.html">Wrapped Learners</a>
    </li>
    <li>
      <a href="../../articles/tutorial/impute.html">Imputation</a>
    </li>
    <li>
      <a href="../../articles/tutorial/bagging.html">Generic Bagging</a>
    </li>
    <li>
      <a href="../../articles/tutorial/advanced_tune.html">Advanced Tuning</a>
    </li>
    <li>
      <a href="../../articles/tutorial/feature_selection.html">Feature Selection/Filtering</a>
    </li>
    <li>
      <a href="../../articles/tutorial/nested_resampling.html">Nested Resampling</a>
    </li>
    <li>
      <a href="../../articles/tutorial/cost_sensitive_classif.html">Cost-Sensitive Classification</a>
    </li>
    <li>
      <a href="../../articles/tutorial/over_and_undersampling.html">Imbalanced Classification Problems</a>
    </li>
    <li>
      <a href="../../articles/tutorial/roc_analysis.html">ROC Analysis and Performance Curves</a>
    </li>
    <li>
      <a href="../../articles/tutorial/multilabel.html">Multilabel Classification</a>
    </li>
    <li>
      <a href="../../articles/tutorial/learning_curve.html">Learning Curve Analysis</a>
    </li>
    <li>
      <a href="../../articles/tutorial/partial_dependence.html">Partial Dependence Plots</a>
    </li>
    <li>
      <a href="../../articles/tutorial/classifier_calibration.html">Classifier Calibration</a>
    </li>
    <li>
      <a href="../../articles/tutorial/hyperpar_tuning_effects.html">Hyperparameter Tuning Effects</a>
    </li>
    <li>
      <a href="../../articles/tutorial/out_of_bag_predictions.html">Out-of-Bag Predictions</a>
    </li>
    <li>
      <a href="../../articles/tutorial/handling_of_spatial_data.html">Handling of Spatial Data</a>
    </li>
    <li>
      <a href="../../articles/tutorial/functional_data.html">Functional Data</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Extending
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/tutorial/create_learner.html">Create Custom Learners</a>
    </li>
    <li>
      <a href="../../articles/tutorial/create_measure.html">Create Custom Measures</a>
    </li>
    <li>
      <a href="../../articles/tutorial/create_imputation.html">Create Imputation Methods</a>
    </li>
    <li>
      <a href="../../articles/tutorial/create_filter.html">Create Custom Filters</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Appendix
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../reference/index.html">Function Reference</a>
    </li>
    <li>
      <a href="../../news/index.html">News</a>
    </li>
    <li>
      <a href="../../articles/tutorial/example_tasks.html">Example Tasks</a>
    </li>
    <li>
      <a href="../../articles/tutorial/integrated_learners.html">Integrated Learners</a>
    </li>
    <li>
      <a href="../../articles/tutorial/measures.html">Implemented Measures</a>
    </li>
    <li>
      <a href="../../articles/tutorial/filter_methods.html">Integrated Filter Methods</a>
    </li>
    <li>
      <a href="../../articles/tutorial/mlr_publications.html">mlr Publications</a>
    </li>
    <li>
      <a href="../../articles/tutorial/talks_videos_workshops.html">Talks, Videos and Workshops</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    mlr-org Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="https://github.com/mlr-org/mlrMBO">mlrMBO</a>
    </li>
    <li>
      <a href="https://github.com/mlr-org/mlrCPO">mlrCPO</a>
    </li>
    <li>
      <a href="https://jakob-r.de/mlrHyperopt/index.html">mlrHyperopt</a>
    </li>
    <li>
      <a href="https://openml.github.io/openml-r/vignettes/OpenML.html">OpenML</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mlr-org/mlr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://mlr-org.slack.com">
    <span class="fa fa-slack"></span>
     
  </a>
</li>
<li>
  <a href="https://stackoverflow.com/questions/tagged/mlr">
    <span class="fa fa-stack-overflow"></span>
     
  </a>
</li>
<li>
  <a href="https://mlr-blog.netlify.com/">
    <span class="fa fa-rss"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="search" class="form-control" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Nested Resampling</h1>
            
      
      <!--The 'toc' block was inserted manually by @pat-s. It triggeres the inline ToC in the vignettes.-->
            <div id="toc">
      <h3 class="hasAnchor">
<a href="#toc" class="anchor"></a>Table of Contents</h3>
      <ul>
<li>
<a href="#tuning">Tuning</a><ul>
<li><a href="#accessing-the-tuning-result">Accessing the tuning result</a></li>
      </ul>
</li>
      <li>
<a href="#feature-selection">Feature selection</a><ul>
<li><a href="#wrapper-methods">Wrapper methods</a></li>
      <li><a href="#filter-methods-with-tuning">Filter methods with tuning</a></li>
      </ul>
</li>
      <li>
<a href="#benchmark-experiments">Benchmark experiments</a><ul>
<li><a href="#example-1-two-tasks-two-learners-tuning">Example 1: Two tasks, two learners, tuning</a></li>
      <li><a href="#example-2-one-task-two-learners-feature-selection">Example 2: One task, two learners, feature selection</a></li>
      <li><a href="#example-3-one-task-two-learners-feature-filtering-with-tuning">Example 3: One task, two learners, feature filtering with tuning</a></li>
      </ul>
</li>
      </ul>
</div>
      
      <small>Source: <a href="https://github.com/mlr-org/mlr/blob/master/vignettes/tutorial/nested_resampling.Rmd"><code>vignettes/tutorial/nested_resampling.Rmd</code></a></small>

    </div>

    
    
<div class="contents">
<p>In order to obtain honest performance estimates for a learner all parts of the model building like preprocessing and model selection steps should be included in the resampling, i.e., repeated for every pair of training/test data. For steps that themselves require resampling like parameter <a href="tune.html" target="_blank">tuning</a> or <a href="feature_selection.html" target="_blank">feature selection</a> (via the wrapper approach) this results in two nested resampling loops.</p>
<div class="figure" style="text-align: center">
<img src="https://raw.githubusercontent.com/pat-s/mlr/master/vignettes/tutorial/devel/pdf/img/nested_resampling.png" alt="Nested Resampling Figure" width="600px"><p class="caption">
Nested Resampling Figure
</p>
</div>
<p>The graphic above illustrates nested resampling for parameter tuning with 3-fold cross-validation in the outer and 4-fold cross-validation in the inner loop.</p>
<p>In the outer resampling loop, we have three pairs of training/test sets. On each of these outer training sets parameter tuning is done, thereby executing the inner resampling loop. This way, we get one set of selected hyperparameters for each outer training set. Then the learner is fitted on each outer training set using the corresponding selected hyperparameters and its performance is evaluated on the outer test sets.</p>
<p>In <code>mlr</code>, you can get nested resampling for free without programming any looping by using the <a href="wrapper.html" target="_blank">wrapper functionality</a>. This works as follows:</p>
<ol style="list-style-type: decimal">
<li>Generate a wrapped Learner (<code><a href="../../reference/makeLearner.html">makeLearner()</a></code>) via function <code><a href="../../reference/makeTuneWrapper.html">makeTuneWrapper()</a></code> or <code><a href="../../reference/makeFeatSelWrapper.html">makeFeatSelWrapper()</a></code>. Specify the inner resampling strategy using their <code>resampling</code> argument.</li>
<li>Call function <code><a href="../../reference/resample.html">resample()</a></code> (see also the section about <a href="resample.html" target="_blank">resampling</a> and pass the outer resampling strategy to its <code>resampling</code> argument.</li>
</ol>
<p>You can freely combine different inner and outer resampling strategies.</p>
<p>The outer strategy can be a resample description <code>ResampleDesc</code> (<code><a href="../../reference/makeResampleDesc.html">makeResampleDesc()</a></code>)) or a resample instance (<code><a href="../../reference/makeResampleInstance.html">makeResampleInstance()</a></code>)). A common setup is prediction and performance evaluation on a fixed outer test set. This can be achieved by using function <code><a href="../../reference/makeFixedHoldoutInstance.html">makeFixedHoldoutInstance()</a></code> to generate the outer resample instance<code>(</code>makeResampleInstance()`).</p>
<p>The inner resampling strategy should preferably be a <code>ResampleDesc</code> (<code><a href="../../reference/makeResampleDesc.html">makeResampleDesc()</a></code>), as the sizes of the outer training sets might differ. Per default, the inner resample description is instantiated once for every outer training set. This way during tuning/feature selection all parameter or feature sets are compared on the same inner training/test sets to reduce variance. You can also turn this off using the <code>same.resampling.instance</code> argument of <code>makeTuneControl*</code> (<code><a href="../../reference/TuneControl.html">TuneControl()</a></code>) or <code>makeFeatSelControl*</code> (<code><a href="../../reference/FeatSelControl.html">FeatSelControl()</a></code>).</p>
<p>Nested resampling is computationally expensive. For this reason in the examples shown below we use relatively small search spaces and a low number of resampling iterations. In practice, you normally have to increase both. As this is computationally intensive you might want to have a look at section <a href="parallelization.html" target="_blank">parallelization</a>.</p>
<div id="tuning" class="section level1">
<h1 class="hasAnchor">
<a href="#tuning" class="anchor"></a>Tuning</h1>
<p>As you might recall from the tutorial page about <a href="tune.html" target="_blank">tuning</a>, you need to define a search space by function <code><a href="http://www.rdocumentation.org/packages/ParamHelpers/topics/makeParamSet">ParamHelpers::makeParamSet()</a></code>, a search strategy by <code>makeTuneControl*</code>(<code><a href="../../reference/TuneControl.html">TuneControl()</a></code>), and a method to evaluate hyperparameter settings (i.e., the inner resampling strategy and a performance measure).</p>
<p>Below is a classification example. We evaluate the performance of a support vector machine (<code><a href="http://www.rdocumentation.org/packages/kernlab/topics/ksvm">kernlab::ksvm()</a></code>) with tuned cost parameter <code>C</code> and RBF kernel parameter <code>sigma</code>. We use 3-fold cross-validation in the outer and subsampling with 2 iterations in the inner loop. For tuing a grid search is used to find the hyperparameters with lowest error rate (<a href="measures.html" target="_blank">mmce</a> is the default measure for classification). The wrapped Learner (<code><a href="../../reference/makeLearner.html">makeLearner()</a></code>) is generated by calling <code><a href="../../reference/makeTuneWrapper.html">makeTuneWrapper()</a></code>.</p>
<p>Note that in practice the parameter set should be larger. A common recommendation is <code>2^(-12:12)</code> for both <code>C</code> and <code>sigma</code>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="co"># Tuning in inner resampling loop</span></a>
<a class="sourceLine" id="cb1-2" title="2">ps =<span class="st"> </span><span class="kw">makeParamSet</span>(</a>
<a class="sourceLine" id="cb1-3" title="3">  <span class="kw">makeDiscreteParam</span>(<span class="st">"C"</span>, <span class="dt">values =</span> <span class="dv">2</span><span class="op">^</span>(<span class="op">-</span><span class="dv">2</span><span class="op">:</span><span class="dv">2</span>)),</a>
<a class="sourceLine" id="cb1-4" title="4">  <span class="kw">makeDiscreteParam</span>(<span class="st">"sigma"</span>, <span class="dt">values =</span> <span class="dv">2</span><span class="op">^</span>(<span class="op">-</span><span class="dv">2</span><span class="op">:</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb1-5" title="5">)</a>
<a class="sourceLine" id="cb1-6" title="6">ctrl =<span class="st"> </span><span class="kw"><a href="../../reference/makeTuneControlGrid.html">makeTuneControlGrid</a></span>()</a>
<a class="sourceLine" id="cb1-7" title="7">inner =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"Subsample"</span>, <span class="dt">iters =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1-8" title="8">lrn =<span class="st"> </span><span class="kw"><a href="../../reference/makeTuneWrapper.html">makeTuneWrapper</a></span>(<span class="st">"classif.ksvm"</span>, <span class="dt">resampling =</span> inner, <span class="dt">par.set =</span> ps, <span class="dt">control =</span> ctrl, <span class="dt">show.info =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb1-9" title="9"></a>
<a class="sourceLine" id="cb1-10" title="10"><span class="co"># Outer resampling loop</span></a>
<a class="sourceLine" id="cb1-11" title="11">outer =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"CV"</span>, <span class="dt">iters =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb1-12" title="12">r =<span class="st"> </span><span class="kw"><a href="../../reference/resample.html">resample</a></span>(lrn, iris.task, <span class="dt">resampling =</span> outer, <span class="dt">extract =</span> getTuneResult, <span class="dt">show.info =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb1-13" title="13"></a>
<a class="sourceLine" id="cb1-14" title="14">r</a>
<a class="sourceLine" id="cb1-15" title="15"><span class="co">## Resample Result</span></a>
<a class="sourceLine" id="cb1-16" title="16"><span class="co">## Task: iris-example</span></a>
<a class="sourceLine" id="cb1-17" title="17"><span class="co">## Learner: classif.ksvm.tuned</span></a>
<a class="sourceLine" id="cb1-18" title="18"><span class="co">## Aggr perf: mmce.test.mean=0.0400000</span></a>
<a class="sourceLine" id="cb1-19" title="19"><span class="co">## Runtime: 5.50584</span></a></code></pre></div>
<p>You can obtain the error rates on the 3 outer test sets by:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">r<span class="op">$</span>measures.test</a>
<a class="sourceLine" id="cb2-2" title="2"><span class="co">##   iter mmce</span></a>
<a class="sourceLine" id="cb2-3" title="3"><span class="co">## 1    1 0.02</span></a>
<a class="sourceLine" id="cb2-4" title="4"><span class="co">## 2    2 0.06</span></a>
<a class="sourceLine" id="cb2-5" title="5"><span class="co">## 3    3 0.04</span></a></code></pre></div>
<div id="accessing-the-tuning-result" class="section level2">
<h2 class="hasAnchor">
<a href="#accessing-the-tuning-result" class="anchor"></a>Accessing the tuning result</h2>
<p>We have kept the results of the tuning for further evaluations. For example one might want to find out, if the best obtained configurations vary for the different outer splits. As storing entire models may be expensive (but possible by setting <code>models = TRUE</code>) we used the <code>extract</code> option of <code><a href="../../reference/resample.html">resample()</a></code>. Function <code><a href="../../reference/getTuneResult.html">getTuneResult()</a></code> returns, among other things, the optimal hyperparameter values and the optimization path (<code><a href="http://www.rdocumentation.org/packages/ParamHelpers/topics/OptPath">ParamHelpers::OptPath()</a></code>) for each iteration of the outer resampling loop. Note that the performance values shown when printing <code>r$extract</code> are the aggregated performances resulting from inner resampling on the outer training set for the best hyperparameter configurations (not to be confused with <code>r$measures.test</code> shown above).</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">r<span class="op">$</span>extract</a>
<a class="sourceLine" id="cb3-2" title="2"><span class="co">## [[1]]</span></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="co">## Tune result:</span></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="co">## Op. pars: C=0.5; sigma=0.5</span></a>
<a class="sourceLine" id="cb3-5" title="5"><span class="co">## mmce.test.mean=0.0735294</span></a>
<a class="sourceLine" id="cb3-6" title="6"><span class="co">## </span></a>
<a class="sourceLine" id="cb3-7" title="7"><span class="co">## [[2]]</span></a>
<a class="sourceLine" id="cb3-8" title="8"><span class="co">## Tune result:</span></a>
<a class="sourceLine" id="cb3-9" title="9"><span class="co">## Op. pars: C=1; sigma=0.25</span></a>
<a class="sourceLine" id="cb3-10" title="10"><span class="co">## mmce.test.mean=0.0441176</span></a>
<a class="sourceLine" id="cb3-11" title="11"><span class="co">## </span></a>
<a class="sourceLine" id="cb3-12" title="12"><span class="co">## [[3]]</span></a>
<a class="sourceLine" id="cb3-13" title="13"><span class="co">## Tune result:</span></a>
<a class="sourceLine" id="cb3-14" title="14"><span class="co">## Op. pars: C=2; sigma=0.25</span></a>
<a class="sourceLine" id="cb3-15" title="15"><span class="co">## mmce.test.mean=0.0441176</span></a>
<a class="sourceLine" id="cb3-16" title="16"></a>
<a class="sourceLine" id="cb3-17" title="17"><span class="kw">names</span>(r<span class="op">$</span>extract[[<span class="dv">1</span>]])</a>
<a class="sourceLine" id="cb3-18" title="18"><span class="co">## [1] "learner"    "control"    "x"          "y"          "resampling"</span></a>
<a class="sourceLine" id="cb3-19" title="19"><span class="co">## [6] "threshold"  "opt.path"</span></a></code></pre></div>
<p>We can compare the optimal parameter settings obtained in the 3 resampling iterations. As you can see, the optimal configuration usually depends on the data. You may be able to identify a <em>range</em> of parameter settings that achieve good performance though, e.g., the values for <code>C</code> should be at least 1 and the values for <code>sigma</code> should be between 0 and 1.</p>
<p>With function <code><a href="../../reference/getNestedTuneResultsOptPathDf.html">getNestedTuneResultsOptPathDf()</a></code> you can extract the optimization paths for the 3 outer cross-validation iterations for further inspection and analysis. These are stacked in one <code>data.frame</code> with column <code>iter</code> indicating the resampling iteration.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">opt.paths =<span class="st"> </span><span class="kw"><a href="../../reference/getNestedTuneResultsOptPathDf.html">getNestedTuneResultsOptPathDf</a></span>(r)</a>
<a class="sourceLine" id="cb4-2" title="2"><span class="kw">head</span>(opt.paths, <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb4-3" title="3"><span class="co">##       C sigma mmce.test.mean dob eol error.message exec.time iter</span></a>
<a class="sourceLine" id="cb4-4" title="4"><span class="co">## 1  0.25  0.25     0.10294118   1  NA          &lt;NA&gt;     1.463    1</span></a>
<a class="sourceLine" id="cb4-5" title="5"><span class="co">## 2   0.5  0.25     0.11764706   2  NA          &lt;NA&gt;     0.036    1</span></a>
<a class="sourceLine" id="cb4-6" title="6"><span class="co">## 3     1  0.25     0.07352941   3  NA          &lt;NA&gt;     0.043    1</span></a>
<a class="sourceLine" id="cb4-7" title="7"><span class="co">## 4     2  0.25     0.07352941   4  NA          &lt;NA&gt;     0.040    1</span></a>
<a class="sourceLine" id="cb4-8" title="8"><span class="co">## 5     4  0.25     0.08823529   5  NA          &lt;NA&gt;     0.042    1</span></a>
<a class="sourceLine" id="cb4-9" title="9"><span class="co">## 6  0.25   0.5     0.13235294   6  NA          &lt;NA&gt;     0.041    1</span></a>
<a class="sourceLine" id="cb4-10" title="10"><span class="co">## 7   0.5   0.5     0.07352941   7  NA          &lt;NA&gt;     0.043    1</span></a>
<a class="sourceLine" id="cb4-11" title="11"><span class="co">## 8     1   0.5     0.07352941   8  NA          &lt;NA&gt;     0.042    1</span></a>
<a class="sourceLine" id="cb4-12" title="12"><span class="co">## 9     2   0.5     0.07352941   9  NA          &lt;NA&gt;     0.037    1</span></a>
<a class="sourceLine" id="cb4-13" title="13"><span class="co">## 10    4   0.5     0.10294118  10  NA          &lt;NA&gt;     0.042    1</span></a></code></pre></div>
<p>Below we visualize the <code>opt.path</code>s for the 3 outer resampling iterations.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">g =<span class="st"> </span><span class="kw">ggplot</span>(opt.paths, <span class="kw">aes</span>(<span class="dt">x =</span> C, <span class="dt">y =</span> sigma, <span class="dt">fill =</span> mmce.test.mean))</a>
<a class="sourceLine" id="cb5-2" title="2">g <span class="op">+</span><span class="st"> </span><span class="kw">geom_tile</span>() <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>iter)</a></code></pre></div>
<p><img src="nested_resampling_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<p>Another useful function is <code><a href="../../reference/getNestedTuneResultsX.html">getNestedTuneResultsX()</a></code>, which extracts the best found hyperparameter settings for each outer resampling iteration.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="kw"><a href="../../reference/getNestedTuneResultsX.html">getNestedTuneResultsX</a></span>(r)</a>
<a class="sourceLine" id="cb6-2" title="2"><span class="co">##     C sigma</span></a>
<a class="sourceLine" id="cb6-3" title="3"><span class="co">## 1 0.5  0.50</span></a>
<a class="sourceLine" id="cb6-4" title="4"><span class="co">## 2 1.0  0.25</span></a>
<a class="sourceLine" id="cb6-5" title="5"><span class="co">## 3 2.0  0.25</span></a></code></pre></div>
<p>You can furthermore access the resampling indices of the inner level using <code><a href="../../reference/getResamplingIndices.html">getResamplingIndices()</a></code> if you used either <code>extract = getTuneResult</code> or <code>extract = getFeatSelResult</code> in the <code><a href="../../reference/resample.html">resample()</a></code> call:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="kw"><a href="../../reference/getResamplingIndices.html">getResamplingIndices</a></span>(r, <span class="dt">inner =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb7-2" title="2"><span class="co">## [[1]]</span></a>
<a class="sourceLine" id="cb7-3" title="3"><span class="co">## [[1]]$train.inds</span></a>
<a class="sourceLine" id="cb7-4" title="4"><span class="co">## [[1]]$train.inds[[1]]</span></a>
<a class="sourceLine" id="cb7-5" title="5"><span class="co">##  [1]  48  83 114  98  50 117 141   3 123  90  34 147  20  89  80   7 102</span></a>
<a class="sourceLine" id="cb7-6" title="6"><span class="co">## [18]  91  30  78 107  13 101  46  25 129  37   6  53  73 149 100  74  69</span></a>
<a class="sourceLine" id="cb7-7" title="7"><span class="co">## [35] 127 105  38  18 137  31  86 124  11  85 140 119   1 143 126  99  72</span></a>
<a class="sourceLine" id="cb7-8" title="8"><span class="co">## [52]  60  47  75  57  28  10 138 128  58  36  82  97  68 125  67</span></a>
<a class="sourceLine" id="cb7-9" title="9"><span class="co">## </span></a>
<a class="sourceLine" id="cb7-10" title="10"><span class="co">## [[1]]$train.inds[[2]]</span></a>
<a class="sourceLine" id="cb7-11" title="11"><span class="co">##  [1]   8  24  99  89 102  41 104  86 100  85  82 120  50  59  28  20   9</span></a>
<a class="sourceLine" id="cb7-12" title="12"><span class="co">## [18]  33 148  90  13  68  16   5  25 114  11 117   3  19  35   4 123  74</span></a>
<a class="sourceLine" id="cb7-13" title="13"><span class="co">## [35]  44   1 125 140  98 149  60 124  69  54  88  43  48  91 135  37 127</span></a>
<a class="sourceLine" id="cb7-14" title="14"><span class="co">## [52] 131  62  57  10  83  52  31 137 134  58  30  97 126  66  22</span></a>
<a class="sourceLine" id="cb7-15" title="15"><span class="co">## </span></a>
<a class="sourceLine" id="cb7-16" title="16"><span class="co">## </span></a>
<a class="sourceLine" id="cb7-17" title="17"><span class="co">## [[1]]$test.inds</span></a>
<a class="sourceLine" id="cb7-18" title="18"><span class="co">## [[1]]$test.inds[[1]]</span></a>
<a class="sourceLine" id="cb7-19" title="19"><span class="co">##  [1]  66  33 118 134  41  22  59 139  54  24  35  16   4   5 135  81  62</span></a>
<a class="sourceLine" id="cb7-20" title="20"><span class="co">## [18]  42 104 113  19 150  52  88 148  61   9  44   8  43 131 130 120  45</span></a>
<a class="sourceLine" id="cb7-21" title="21"><span class="co">## </span></a>
<a class="sourceLine" id="cb7-22" title="22"><span class="co">## [[1]]$test.inds[[2]]</span></a>
<a class="sourceLine" id="cb7-23" title="23"><span class="co">##  [1] 118  53  36  67 107 139 119   6 101  34  75  81 143  42 113 147 129</span></a>
<a class="sourceLine" id="cb7-24" title="24"><span class="co">## [18] 150  73 141  38  61 138  47 105   7  80  72  78 130  46  18 128  45</span></a>
<a class="sourceLine" id="cb7-25" title="25"><span class="co">## </span></a>
<a class="sourceLine" id="cb7-26" title="26"><span class="co">## </span></a>
<a class="sourceLine" id="cb7-27" title="27"><span class="co">## </span></a>
<a class="sourceLine" id="cb7-28" title="28"><span class="co">## [[2]]</span></a>
<a class="sourceLine" id="cb7-29" title="29"><span class="co">## [[2]]$train.inds</span></a>
<a class="sourceLine" id="cb7-30" title="30"><span class="co">## [[2]]$train.inds[[1]]</span></a>
<a class="sourceLine" id="cb7-31" title="31"><span class="co">##  [1]  69 113  29 116 135 108  60  71  40  23 121 149  14  55  62 142  53</span></a>
<a class="sourceLine" id="cb7-32" title="32"><span class="co">## [18] 103  74  57  17 150  94  95 100  97  63 114  78 123  87 126  26   1</span></a>
<a class="sourceLine" id="cb7-33" title="33"><span class="co">## [35]  38  77  59  76 137 129 109  34  39 145 111 132  86  58 130  21 127</span></a>
<a class="sourceLine" id="cb7-34" title="34"><span class="co">## [52]   2  12   7 110  20  79 115  30  96  27 105  51  49 124 128</span></a>
<a class="sourceLine" id="cb7-35" title="35"><span class="co">## </span></a>
<a class="sourceLine" id="cb7-36" title="36"><span class="co">## [[2]]$train.inds[[2]]</span></a>
<a class="sourceLine" id="cb7-37" title="37"><span class="co">##  [1] 137  93  39  40  26  38   8  20  49 115  92 109  79  55 101  12 106</span></a>
<a class="sourceLine" id="cb7-38" title="38"><span class="co">## [18] 149  28  84 145 113  41 117 121 129  74 111 116   7  86 124 127  62</span></a>
<a class="sourceLine" id="cb7-39" title="39"><span class="co">## [35]  54  23  72 126 105  34 142  17  51  63 103 150  64  57  29  32  96</span></a>
<a class="sourceLine" id="cb7-40" title="40"><span class="co">## [52] 146  27  58 114   1  56  59 123  95  65 144 130 120 143   2</span></a>
<a class="sourceLine" id="cb7-41" title="41"><span class="co">## </span></a>
<a class="sourceLine" id="cb7-42" title="42"><span class="co">## </span></a>
<a class="sourceLine" id="cb7-43" title="43"><span class="co">## [[2]]$test.inds</span></a>
<a class="sourceLine" id="cb7-44" title="44"><span class="co">## [[2]]$test.inds[[1]]</span></a>
<a class="sourceLine" id="cb7-45" title="45"><span class="co">##  [1]  50 120  67  98  56  84  35  92 101  32  65 136  54 122   8 106  15</span></a>
<a class="sourceLine" id="cb7-46" title="46"><span class="co">## [18]  68 117  41 143 140  64   6 112 146  44 144  72 133  93  70  28  25</span></a>
<a class="sourceLine" id="cb7-47" title="47"><span class="co">## </span></a>
<a class="sourceLine" id="cb7-48" title="48"><span class="co">## [[2]]$test.inds[[2]]</span></a>
<a class="sourceLine" id="cb7-49" title="49"><span class="co">##  [1]  77  94  50  67  98  35 108  78 136 122  53  14  60  15  68 128 135</span></a>
<a class="sourceLine" id="cb7-50" title="50"><span class="co">## [18]  30 140   6 112  97 110  71  21  44 133  69  70 100  76  87  25 132</span></a>
<a class="sourceLine" id="cb7-51" title="51"><span class="co">## </span></a>
<a class="sourceLine" id="cb7-52" title="52"><span class="co">## </span></a>
<a class="sourceLine" id="cb7-53" title="53"><span class="co">## </span></a>
<a class="sourceLine" id="cb7-54" title="54"><span class="co">## [[3]]</span></a>
<a class="sourceLine" id="cb7-55" title="55"><span class="co">## [[3]]$train.inds</span></a>
<a class="sourceLine" id="cb7-56" title="56"><span class="co">## [[3]]$train.inds[[1]]</span></a>
<a class="sourceLine" id="cb7-57" title="57"><span class="co">##  [1] 122 121  51  80  65 133 106  17  10 148 107  40 119  79  96 141   9</span></a>
<a class="sourceLine" id="cb7-58" title="58"><span class="co">## [18] 108  82  46  70  89  85 125  87   3  27  66  48  24  63  95 109 147</span></a>
<a class="sourceLine" id="cb7-59" title="59"><span class="co">## [35] 136  73  22  83  21  19  90   4  16  88  71  56  77  11  14  84 104</span></a>
<a class="sourceLine" id="cb7-60" title="60"><span class="co">## [52]  52 139  99  36  92 144  15  94  61 138  91  18  75  76 116</span></a>
<a class="sourceLine" id="cb7-61" title="61"><span class="co">## </span></a>
<a class="sourceLine" id="cb7-62" title="62"><span class="co">## [[3]]$train.inds[[2]]</span></a>
<a class="sourceLine" id="cb7-63" title="63"><span class="co">##  [1] 147  49  65  79 146  77  56   2  32 104  27 116  11  14  61  12  84</span></a>
<a class="sourceLine" id="cb7-64" title="64"><span class="co">## [18]  36  23  16 141  89 142  47  76 122  29  66 118  31  15  63  33  26</span></a>
<a class="sourceLine" id="cb7-65" title="65"><span class="co">## [35]  43  21  83  48  90 138 112  85  75   5  46 144  64  70  51 106 145</span></a>
<a class="sourceLine" id="cb7-66" title="66"><span class="co">## [52]  71 119 139  40  52 115  24  45  73 133  87  42  82  95 110</span></a>
<a class="sourceLine" id="cb7-67" title="67"><span class="co">## </span></a>
<a class="sourceLine" id="cb7-68" title="68"><span class="co">## </span></a>
<a class="sourceLine" id="cb7-69" title="69"><span class="co">## [[3]]$test.inds</span></a>
<a class="sourceLine" id="cb7-70" title="70"><span class="co">## [[3]]$test.inds[[1]]</span></a>
<a class="sourceLine" id="cb7-71" title="71"><span class="co">##  [1]  43 111 142 134  12  39 131  49 110  32 145  81  33 115 102  64  23</span></a>
<a class="sourceLine" id="cb7-72" title="72"><span class="co">## [18]  45  47  37 118  26 112 146  31  93   5  29 132  55  42 103   2  13</span></a>
<a class="sourceLine" id="cb7-73" title="73"><span class="co">## </span></a>
<a class="sourceLine" id="cb7-74" title="74"><span class="co">## [[3]]$test.inds[[2]]</span></a>
<a class="sourceLine" id="cb7-75" title="75"><span class="co">##  [1]  96 148 111 134  39 131   3  17  91  81 102  80   9 109 108 136  10</span></a>
<a class="sourceLine" id="cb7-76" title="76"><span class="co">## [18]  18 107  88 125 121  22  37  94  93 132  99  19  92  55 103   4  13</span></a></code></pre></div>
</div>
</div>
<div id="feature-selection" class="section level1">
<h1 class="hasAnchor">
<a href="#feature-selection" class="anchor"></a>Feature selection</h1>
<p>As you might recall from the section about <a href="feature_selection.html" target="_blank">feature selection</a>, <code>mlr</code> supports the filter and the wrapper approach.</p>
<div id="wrapper-methods" class="section level2">
<h2 class="hasAnchor">
<a href="#wrapper-methods" class="anchor"></a>Wrapper methods</h2>
<p>Wrapper methods use the performance of a learning algorithm to assess the usefulness of a feature set. In order to select a feature subset a learner is trained repeatedly on different feature subsets and the subset which leads to the best learner performance is chosen.</p>
<p>For feature selection in the inner resampling loop, you need to choose a search strategy (function <code>makeFeatSelControl*</code> (<code><a href="../../reference/FeatSelControl.html">FeatSelControl()</a></code>)), a performance measure and the inner resampling strategy. Then use function <code><a href="../../reference/makeFeatSelWrapper.html">makeFeatSelWrapper()</a></code> to bind everything together.</p>
<p>Below we use sequential forward selection with linear regression on the <code>BostonHousing</code> (<code><a href="http://www.rdocumentation.org/packages/mlbench/topics/BostonHousing">mlbench::BostonHousing()</a></code> data set (<code><a href="../../reference/bh.task.html">bh.task()</a></code>).</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="co"># Feature selection in inner resampling loop</span></a>
<a class="sourceLine" id="cb8-2" title="2">inner =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"CV"</span>, <span class="dt">iters =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb8-3" title="3">lrn =<span class="st"> </span><span class="kw"><a href="../../reference/makeFeatSelWrapper.html">makeFeatSelWrapper</a></span>(<span class="st">"regr.lm"</span>, <span class="dt">resampling =</span> inner,</a>
<a class="sourceLine" id="cb8-4" title="4">  <span class="dt">control =</span> <span class="kw"><a href="../../reference/FeatSelControl.html">makeFeatSelControlSequential</a></span>(<span class="dt">method =</span> <span class="st">"sfs"</span>), <span class="dt">show.info =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb8-5" title="5"></a>
<a class="sourceLine" id="cb8-6" title="6"><span class="co"># Outer resampling loop</span></a>
<a class="sourceLine" id="cb8-7" title="7">outer =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"Subsample"</span>, <span class="dt">iters =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb8-8" title="8">r =<span class="st"> </span><span class="kw"><a href="../../reference/resample.html">resample</a></span>(<span class="dt">learner =</span> lrn, <span class="dt">task =</span> bh.task, <span class="dt">resampling =</span> outer, <span class="dt">extract =</span> getFeatSelResult,</a>
<a class="sourceLine" id="cb8-9" title="9">  <span class="dt">show.info =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb8-10" title="10"></a>
<a class="sourceLine" id="cb8-11" title="11">r</a>
<a class="sourceLine" id="cb8-12" title="12"><span class="co">## Resample Result</span></a>
<a class="sourceLine" id="cb8-13" title="13"><span class="co">## Task: BostonHousing-example</span></a>
<a class="sourceLine" id="cb8-14" title="14"><span class="co">## Learner: regr.lm.featsel</span></a>
<a class="sourceLine" id="cb8-15" title="15"><span class="co">## Aggr perf: mse.test.mean=24.8753005</span></a>
<a class="sourceLine" id="cb8-16" title="16"><span class="co">## Runtime: 7.01506</span></a>
<a class="sourceLine" id="cb8-17" title="17"></a>
<a class="sourceLine" id="cb8-18" title="18">r<span class="op">$</span>measures.test</a>
<a class="sourceLine" id="cb8-19" title="19"><span class="co">##   iter      mse</span></a>
<a class="sourceLine" id="cb8-20" title="20"><span class="co">## 1    1 22.28967</span></a>
<a class="sourceLine" id="cb8-21" title="21"><span class="co">## 2    2 27.46093</span></a></code></pre></div>
<div id="accessing-the-selected-features" class="section level3">
<h3 class="hasAnchor">
<a href="#accessing-the-selected-features" class="anchor"></a>Accessing the selected features</h3>
<p>The result of the feature selection can be extracted by function <code><a href="../../reference/getFeatSelResult.html">getFeatSelResult()</a></code>. It is also possible to keep whole models (<code><a href="../../reference/makeWrappedModel.html">makeWrappedModel()</a></code>) by setting <code>models = TRUE</code> when calling <code><a href="../../reference/resample.html">resample()</a></code>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">r<span class="op">$</span>extract</a>
<a class="sourceLine" id="cb9-2" title="2"><span class="co">## [[1]]</span></a>
<a class="sourceLine" id="cb9-3" title="3"><span class="co">## FeatSel result:</span></a>
<a class="sourceLine" id="cb9-4" title="4"><span class="co">## Features (8): crim, zn, chas, nox, rm, dis, ptratio, lstat</span></a>
<a class="sourceLine" id="cb9-5" title="5"><span class="co">## mse.test.mean=27.3901612</span></a>
<a class="sourceLine" id="cb9-6" title="6"><span class="co">## </span></a>
<a class="sourceLine" id="cb9-7" title="7"><span class="co">## [[2]]</span></a>
<a class="sourceLine" id="cb9-8" title="8"><span class="co">## FeatSel result:</span></a>
<a class="sourceLine" id="cb9-9" title="9"><span class="co">## Features (11): crim, zn, chas, nox, rm, dis, rad, tax, ptratio, b, lstat</span></a>
<a class="sourceLine" id="cb9-10" title="10"><span class="co">## mse.test.mean=22.2039008</span></a>
<a class="sourceLine" id="cb9-11" title="11"></a>
<a class="sourceLine" id="cb9-12" title="12"><span class="co"># Selected features in the first outer resampling iteration</span></a>
<a class="sourceLine" id="cb9-13" title="13">r<span class="op">$</span>extract[[<span class="dv">1</span>]]<span class="op">$</span>x</a>
<a class="sourceLine" id="cb9-14" title="14"><span class="co">## [1] "crim"    "zn"      "chas"    "nox"     "rm"      "dis"     "ptratio"</span></a>
<a class="sourceLine" id="cb9-15" title="15"><span class="co">## [8] "lstat"</span></a>
<a class="sourceLine" id="cb9-16" title="16"></a>
<a class="sourceLine" id="cb9-17" title="17"><span class="co"># Resampled performance of the selected feature subset on the first inner training set</span></a>
<a class="sourceLine" id="cb9-18" title="18">r<span class="op">$</span>extract[[<span class="dv">1</span>]]<span class="op">$</span>y</a>
<a class="sourceLine" id="cb9-19" title="19"><span class="co">## mse.test.mean </span></a>
<a class="sourceLine" id="cb9-20" title="20"><span class="co">##      27.39016</span></a></code></pre></div>
<p>As for tuning, you can extract the optimization paths. The resulting <code>data.frame</code>s contain, among others, binary columns for all features, indicating if they were included in the linear regression model, and the corresponding performances.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">opt.paths =<span class="st"> </span><span class="kw">lapply</span>(r<span class="op">$</span>extract, <span class="cf">function</span>(x) <span class="kw">as.data.frame</span>(x<span class="op">$</span>opt.path))</a>
<a class="sourceLine" id="cb10-2" title="2"><span class="kw">head</span>(opt.paths[[<span class="dv">1</span>]])</a>
<a class="sourceLine" id="cb10-3" title="3"><span class="co">##   crim zn indus chas nox rm age dis rad tax ptratio b lstat mse.test.mean</span></a>
<a class="sourceLine" id="cb10-4" title="4"><span class="co">## 1    0  0     0    0   0  0   0   0   0   0       0 0     0      84.52018</span></a>
<a class="sourceLine" id="cb10-5" title="5"><span class="co">## 2    1  0     0    0   0  0   0   0   0   0       0 0     0      95.46348</span></a>
<a class="sourceLine" id="cb10-6" title="6"><span class="co">## 3    0  1     0    0   0  0   0   0   0   0       0 0     0      74.97858</span></a>
<a class="sourceLine" id="cb10-7" title="7"><span class="co">## 4    0  0     1    0   0  0   0   0   0   0       0 0     0      66.35546</span></a>
<a class="sourceLine" id="cb10-8" title="8"><span class="co">## 5    0  0     0    1   0  0   0   0   0   0       0 0     0      81.49228</span></a>
<a class="sourceLine" id="cb10-9" title="9"><span class="co">## 6    0  0     0    0   1  0   0   0   0   0       0 0     0      67.72664</span></a>
<a class="sourceLine" id="cb10-10" title="10"><span class="co">##   dob eol error.message exec.time</span></a>
<a class="sourceLine" id="cb10-11" title="11"><span class="co">## 1   1   2          &lt;NA&gt;     0.031</span></a>
<a class="sourceLine" id="cb10-12" title="12"><span class="co">## 2   2   2          &lt;NA&gt;     0.037</span></a>
<a class="sourceLine" id="cb10-13" title="13"><span class="co">## 3   2   2          &lt;NA&gt;     0.027</span></a>
<a class="sourceLine" id="cb10-14" title="14"><span class="co">## 4   2   2          &lt;NA&gt;     0.030</span></a>
<a class="sourceLine" id="cb10-15" title="15"><span class="co">## 5   2   2          &lt;NA&gt;     0.032</span></a>
<a class="sourceLine" id="cb10-16" title="16"><span class="co">## 6   2   2          &lt;NA&gt;     0.031</span></a></code></pre></div>
<p>An easy-to-read version of the optimization path for sequential feature selection can be obtained with function <code><a href="../../reference/analyzeFeatSelResult.html">analyzeFeatSelResult()</a></code>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="kw"><a href="../../reference/analyzeFeatSelResult.html">analyzeFeatSelResult</a></span>(r<span class="op">$</span>extract[[<span class="dv">1</span>]])</a>
<a class="sourceLine" id="cb11-2" title="2"><span class="co">## Features         : 8</span></a>
<a class="sourceLine" id="cb11-3" title="3"><span class="co">## Performance      : mse.test.mean=27.3901612</span></a>
<a class="sourceLine" id="cb11-4" title="4"><span class="co">## crim, zn, chas, nox, rm, dis, ptratio, lstat</span></a>
<a class="sourceLine" id="cb11-5" title="5"><span class="co">## </span></a>
<a class="sourceLine" id="cb11-6" title="6"><span class="co">## Path to optimum:</span></a>
<a class="sourceLine" id="cb11-7" title="7"><span class="co">## - Features:    0  Init   :                       Perf = 84.52  Diff: NA  *</span></a>
<a class="sourceLine" id="cb11-8" title="8"><span class="co">## - Features:    1  Add    : lstat                 Perf = 38.657  Diff: 45.863  *</span></a>
<a class="sourceLine" id="cb11-9" title="9"><span class="co">## - Features:    2  Add    : rm                    Perf = 32.601  Diff: 6.0566  *</span></a>
<a class="sourceLine" id="cb11-10" title="10"><span class="co">## - Features:    3  Add    : ptratio               Perf = 29.702  Diff: 2.8991  *</span></a>
<a class="sourceLine" id="cb11-11" title="11"><span class="co">## - Features:    4  Add    : chas                  Perf = 29.283  Diff: 0.41805  *</span></a>
<a class="sourceLine" id="cb11-12" title="12"><span class="co">## - Features:    5  Add    : dis                   Perf = 29.059  Diff: 0.22416  *</span></a>
<a class="sourceLine" id="cb11-13" title="13"><span class="co">## - Features:    6  Add    : nox                   Perf = 27.685  Diff: 1.3747  *</span></a>
<a class="sourceLine" id="cb11-14" title="14"><span class="co">## - Features:    7  Add    : crim                  Perf = 27.42  Diff: 0.26425  *</span></a>
<a class="sourceLine" id="cb11-15" title="15"><span class="co">## - Features:    8  Add    : zn                    Perf = 27.39  Diff: 0.030206  *</span></a>
<a class="sourceLine" id="cb11-16" title="16"><span class="co">## </span></a>
<a class="sourceLine" id="cb11-17" title="17"><span class="co">## Stopped, because no improving feature was found.</span></a></code></pre></div>
</div>
</div>
<div id="filter-methods-with-tuning" class="section level2">
<h2 class="hasAnchor">
<a href="#filter-methods-with-tuning" class="anchor"></a>Filter methods with tuning</h2>
<p>Filter methods assign an importance value to each feature. Based on these values you can select a feature subset by either keeping all features with importance higher than a certain threshold or by keeping a fixed number or percentage of the highest ranking features. Often, neither the theshold nor the number or percentage of features is known in advance and thus tuning is necessary.</p>
<p>In the example below the threshold value (<code>fw.threshold</code>) is tuned in the inner resampling loop. For this purpose the base Learner (<code><a href="../../reference/makeLearner.html">makeLearner()</a></code>) <code>"regr.lm"</code> is wrapped two times. First, <code><a href="../../reference/makeFilterWrapper.html">makeFilterWrapper()</a></code> is used to fuse linear regression with a feature filtering preprocessing step. Then a tuning step is added by <code><a href="../../reference/makeTuneWrapper.html">makeTuneWrapper()</a></code>.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="co"># Tuning of the percentage of selected filters in the inner loop</span></a>
<a class="sourceLine" id="cb12-2" title="2">lrn =<span class="st"> </span><span class="kw"><a href="../../reference/makeFilterWrapper.html">makeFilterWrapper</a></span>(<span class="dt">learner =</span> <span class="st">"regr.lm"</span>, <span class="dt">fw.method =</span> <span class="st">"chi.squared"</span>)</a>
<a class="sourceLine" id="cb12-3" title="3">ps =<span class="st"> </span><span class="kw">makeParamSet</span>(<span class="kw">makeDiscreteParam</span>(<span class="st">"fw.threshold"</span>, <span class="dt">values =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.2</span>)))</a>
<a class="sourceLine" id="cb12-4" title="4">ctrl =<span class="st"> </span><span class="kw"><a href="../../reference/makeTuneControlGrid.html">makeTuneControlGrid</a></span>()</a>
<a class="sourceLine" id="cb12-5" title="5">inner =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"CV"</span>, <span class="dt">iters =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb12-6" title="6">lrn =<span class="st"> </span><span class="kw"><a href="../../reference/makeTuneWrapper.html">makeTuneWrapper</a></span>(lrn, <span class="dt">resampling =</span> inner, <span class="dt">par.set =</span> ps, <span class="dt">control =</span> ctrl, <span class="dt">show.info =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb12-7" title="7"></a>
<a class="sourceLine" id="cb12-8" title="8"><span class="co"># Outer resampling loop</span></a>
<a class="sourceLine" id="cb12-9" title="9">outer =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"CV"</span>, <span class="dt">iters =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb12-10" title="10">r =<span class="st"> </span><span class="kw"><a href="../../reference/resample.html">resample</a></span>(<span class="dt">learner =</span> lrn, <span class="dt">task =</span> bh.task, <span class="dt">resampling =</span> outer, <span class="dt">models =</span> <span class="ot">TRUE</span>, <span class="dt">show.info =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb12-11" title="11">r</a>
<a class="sourceLine" id="cb12-12" title="12"><span class="co">## Resample Result</span></a>
<a class="sourceLine" id="cb12-13" title="13"><span class="co">## Task: BostonHousing-example</span></a>
<a class="sourceLine" id="cb12-14" title="14"><span class="co">## Learner: regr.lm.filtered.tuned</span></a>
<a class="sourceLine" id="cb12-15" title="15"><span class="co">## Aggr perf: mse.test.mean=23.5449481</span></a>
<a class="sourceLine" id="cb12-16" title="16"><span class="co">## Runtime: 3.85235</span></a></code></pre></div>
<div id="accessing-the-selected-features-and-optimal-percentage" class="section level3">
<h3 class="hasAnchor">
<a href="#accessing-the-selected-features-and-optimal-percentage" class="anchor"></a>Accessing the selected features and optimal percentage</h3>
<p>In the above example we kept the complete model (<code><a href="../../reference/makeWrappedModel.html">makeWrappedModel()</a></code>)s.</p>
<p>Below are some examples that show how to extract information from the model (<code><a href="../../reference/makeWrappedModel.html">makeWrappedModel()</a></code>)s.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1">r<span class="op">$</span>models</a>
<a class="sourceLine" id="cb13-2" title="2"><span class="co">## [[1]]</span></a>
<a class="sourceLine" id="cb13-3" title="3"><span class="co">## Model for learner.id=regr.lm.filtered.tuned; learner.class=TuneWrapper</span></a>
<a class="sourceLine" id="cb13-4" title="4"><span class="co">## Trained on: task.id = BostonHousing-example; obs = 337; features = 13</span></a>
<a class="sourceLine" id="cb13-5" title="5"><span class="co">## Hyperparameters: fw.method=chi.squared</span></a>
<a class="sourceLine" id="cb13-6" title="6"><span class="co">## </span></a>
<a class="sourceLine" id="cb13-7" title="7"><span class="co">## [[2]]</span></a>
<a class="sourceLine" id="cb13-8" title="8"><span class="co">## Model for learner.id=regr.lm.filtered.tuned; learner.class=TuneWrapper</span></a>
<a class="sourceLine" id="cb13-9" title="9"><span class="co">## Trained on: task.id = BostonHousing-example; obs = 337; features = 13</span></a>
<a class="sourceLine" id="cb13-10" title="10"><span class="co">## Hyperparameters: fw.method=chi.squared</span></a>
<a class="sourceLine" id="cb13-11" title="11"><span class="co">## </span></a>
<a class="sourceLine" id="cb13-12" title="12"><span class="co">## [[3]]</span></a>
<a class="sourceLine" id="cb13-13" title="13"><span class="co">## Model for learner.id=regr.lm.filtered.tuned; learner.class=TuneWrapper</span></a>
<a class="sourceLine" id="cb13-14" title="14"><span class="co">## Trained on: task.id = BostonHousing-example; obs = 338; features = 13</span></a>
<a class="sourceLine" id="cb13-15" title="15"><span class="co">## Hyperparameters: fw.method=chi.squared</span></a></code></pre></div>
<p>The result of the feature selection can be extracted by function <code><a href="../../reference/getFilteredFeatures.html">getFilteredFeatures()</a></code>. Almost always all 13 features are selected.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="kw">lapply</span>(r<span class="op">$</span>models, <span class="cf">function</span>(x) <span class="kw"><a href="../../reference/getFilteredFeatures.html">getFilteredFeatures</a></span>(x<span class="op">$</span>learner.model<span class="op">$</span>next.model))</a>
<a class="sourceLine" id="cb14-2" title="2"><span class="co">## [[1]]</span></a>
<a class="sourceLine" id="cb14-3" title="3"><span class="co">##  [1] "crim"    "zn"      "indus"   "nox"     "rm"      "age"     "dis"    </span></a>
<a class="sourceLine" id="cb14-4" title="4"><span class="co">##  [8] "rad"     "tax"     "ptratio" "b"       "lstat"  </span></a>
<a class="sourceLine" id="cb14-5" title="5"><span class="co">## </span></a>
<a class="sourceLine" id="cb14-6" title="6"><span class="co">## [[2]]</span></a>
<a class="sourceLine" id="cb14-7" title="7"><span class="co">##  [1] "crim"    "zn"      "indus"   "chas"    "nox"     "rm"      "age"    </span></a>
<a class="sourceLine" id="cb14-8" title="8"><span class="co">##  [8] "dis"     "rad"     "tax"     "ptratio" "b"       "lstat"  </span></a>
<a class="sourceLine" id="cb14-9" title="9"><span class="co">## </span></a>
<a class="sourceLine" id="cb14-10" title="10"><span class="co">## [[3]]</span></a>
<a class="sourceLine" id="cb14-11" title="11"><span class="co">##  [1] "crim"    "zn"      "indus"   "chas"    "nox"     "rm"      "age"    </span></a>
<a class="sourceLine" id="cb14-12" title="12"><span class="co">##  [8] "dis"     "rad"     "tax"     "ptratio" "b"       "lstat"</span></a></code></pre></div>
<p>Below the tune results (<code><a href="../../reference/TuneResult.html">TuneResult()</a></code>) and optimization paths (<code><a href="http://www.rdocumentation.org/packages/ParamHelpers/topics/OptPath">ParamHelpers::OptPath()</a></code>) are accessed.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1">res =<span class="st"> </span><span class="kw">lapply</span>(r<span class="op">$</span>models, getTuneResult)</a>
<a class="sourceLine" id="cb15-2" title="2">res</a>
<a class="sourceLine" id="cb15-3" title="3"><span class="co">## [[1]]</span></a>
<a class="sourceLine" id="cb15-4" title="4"><span class="co">## Tune result:</span></a>
<a class="sourceLine" id="cb15-5" title="5"><span class="co">## Op. pars: fw.threshold=0.2</span></a>
<a class="sourceLine" id="cb15-6" title="6"><span class="co">## mse.test.mean=26.6251586</span></a>
<a class="sourceLine" id="cb15-7" title="7"><span class="co">## </span></a>
<a class="sourceLine" id="cb15-8" title="8"><span class="co">## [[2]]</span></a>
<a class="sourceLine" id="cb15-9" title="9"><span class="co">## Tune result:</span></a>
<a class="sourceLine" id="cb15-10" title="10"><span class="co">## Op. pars: fw.threshold=0</span></a>
<a class="sourceLine" id="cb15-11" title="11"><span class="co">## mse.test.mean=25.8640017</span></a>
<a class="sourceLine" id="cb15-12" title="12"><span class="co">## </span></a>
<a class="sourceLine" id="cb15-13" title="13"><span class="co">## [[3]]</span></a>
<a class="sourceLine" id="cb15-14" title="14"><span class="co">## Tune result:</span></a>
<a class="sourceLine" id="cb15-15" title="15"><span class="co">## Op. pars: fw.threshold=0</span></a>
<a class="sourceLine" id="cb15-16" title="16"><span class="co">## mse.test.mean=23.0710555</span></a>
<a class="sourceLine" id="cb15-17" title="17"></a>
<a class="sourceLine" id="cb15-18" title="18">opt.paths =<span class="st"> </span><span class="kw">lapply</span>(res, <span class="cf">function</span>(x) <span class="kw">as.data.frame</span>(x<span class="op">$</span>opt.path))</a>
<a class="sourceLine" id="cb15-19" title="19">opt.paths[[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb15-20" title="20"><span class="co">##   fw.threshold mse.test.mean dob eol error.message exec.time</span></a>
<a class="sourceLine" id="cb15-21" title="21"><span class="co">## 1            0      26.72002   1  NA          &lt;NA&gt;     0.494</span></a>
<a class="sourceLine" id="cb15-22" title="22"><span class="co">## 2          0.2      26.62516   2  NA          &lt;NA&gt;     0.089</span></a>
<a class="sourceLine" id="cb15-23" title="23"><span class="co">## 3          0.4      26.62516   3  NA          &lt;NA&gt;     0.096</span></a>
<a class="sourceLine" id="cb15-24" title="24"><span class="co">## 4          0.6      31.52931   4  NA          &lt;NA&gt;     0.105</span></a>
<a class="sourceLine" id="cb15-25" title="25"><span class="co">## 5          0.8      88.06252   5  NA          &lt;NA&gt;     0.078</span></a>
<a class="sourceLine" id="cb15-26" title="26"><span class="co">## 6            1      88.06252   6  NA          &lt;NA&gt;     0.074</span></a></code></pre></div>
</div>
</div>
</div>
<div id="benchmark-experiments" class="section level1">
<h1 class="hasAnchor">
<a href="#benchmark-experiments" class="anchor"></a>Benchmark experiments</h1>
<p>In a benchmark experiment multiple learners are compared on one or several tasks (see also the section about <a href="benchmark_experiments.html" target="_blank">benchmarking</a>. Nested resampling in benchmark experiments is achieved the same way as in resampling:</p>
<ul>
<li>First, use <code><a href="../../reference/makeTuneWrapper.html">makeTuneWrapper()</a></code> or <code><a href="../../reference/makeFeatSelWrapper.html">makeFeatSelWrapper()</a></code> to generate wrapped Learner (<code><a href="../../reference/makeLearner.html">makeLearner()</a></code>)s with the inner resampling strategies of your choice.</li>
<li>Second, call <code><a href="../../reference/benchmark.html">benchmark()</a></code> and specify the outer resampling strategies for all tasks.</li>
</ul>
<p>The inner resampling strategies should be resample descriptions (<code><a href="../../reference/makeResampleDesc.html">makeResampleDesc()</a></code>). You can use different inner resampling strategies for different wrapped learners. For example it might be practical to do fewer subsampling or bootstrap iterations for slower learners.</p>
<p>If you have larger benchmark experiments you might want to have a look at the section about <a href="parallelization.html" target="_blank">parallelization</a>.</p>
<p>As mentioned in the section about <a href="benchmark_experiments.html" target="_blank">benchmark experiments</a> you can also use different resampling strategies for different learning tasks by passing a <code>list</code> of resampling descriptions or instances to <code><a href="../../reference/benchmark.html">benchmark()</a></code>.</p>
<p>We will see three examples to show different benchmark settings:</p>
<ol style="list-style-type: decimal">
<li>Two data sets + two classification algorithms + tuning</li>
<li>One data set + two regression algorithms + feature selection</li>
<li>One data set + two regression algorithms + feature filtering + tuning</li>
</ol>
<div id="example-1-two-tasks-two-learners-tuning" class="section level2">
<h2 class="hasAnchor">
<a href="#example-1-two-tasks-two-learners-tuning" class="anchor"></a>Example 1: Two tasks, two learners, tuning</h2>
<p>Below is a benchmark experiment with two data sets, <code><a href="http://www.rdocumentation.org/packages/datasets/topics/iris">datasets::iris()</a></code> and <code>mlbench::sonar()</code>, and two Learner (<code><a href="../../reference/makeLearner.html">makeLearner()</a></code>)s, <code><a href="http://www.rdocumentation.org/packages/kernlab/topics/ksvm">kernlab::ksvm()</a></code> and <code><a href="http://www.rdocumentation.org/packages/kknn/topics/kknn">kknn::kknn()</a></code>, that are both tuned.</p>
<p>As inner resampling strategies we use holdout for <code><a href="http://www.rdocumentation.org/packages/kernlab/topics/ksvm">kernlab::ksvm()</a></code> and subsampling with 3 iterations for <code><a href="http://www.rdocumentation.org/packages/kknn/topics/kknn">kknn::kknn()</a></code>. As outer resampling strategies we take holdout for the <code><a href="http://www.rdocumentation.org/packages/datasets/topics/iris">datasets::iris()</a></code> and bootstrap with 2 iterations for the <code>mlbench::sonar()</code> data (<code><a href="../../reference/sonar.task.html">sonar.task()</a></code>). We consider the accuracy (<a href="measures.html" target="_blank">acc</a>), which is used as tuning criterion, and also calculate the balanced error rate (<a href="measures.html" target="_blank">ber</a>).</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="co"># List of learning tasks</span></a>
<a class="sourceLine" id="cb16-2" title="2">tasks =<span class="st"> </span><span class="kw">list</span>(iris.task, sonar.task)</a>
<a class="sourceLine" id="cb16-3" title="3"></a>
<a class="sourceLine" id="cb16-4" title="4"><span class="co"># Tune svm in the inner resampling loop</span></a>
<a class="sourceLine" id="cb16-5" title="5">ps =<span class="st"> </span><span class="kw">makeParamSet</span>(</a>
<a class="sourceLine" id="cb16-6" title="6">  <span class="kw">makeDiscreteParam</span>(<span class="st">"C"</span>, <span class="dv">2</span><span class="op">^</span>(<span class="op">-</span><span class="dv">1</span><span class="op">:</span><span class="dv">1</span>)),</a>
<a class="sourceLine" id="cb16-7" title="7">  <span class="kw">makeDiscreteParam</span>(<span class="st">"sigma"</span>, <span class="dv">2</span><span class="op">^</span>(<span class="op">-</span><span class="dv">1</span><span class="op">:</span><span class="dv">1</span>)))</a>
<a class="sourceLine" id="cb16-8" title="8">ctrl =<span class="st"> </span><span class="kw"><a href="../../reference/makeTuneControlGrid.html">makeTuneControlGrid</a></span>()</a>
<a class="sourceLine" id="cb16-9" title="9">inner =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"Holdout"</span>)</a>
<a class="sourceLine" id="cb16-10" title="10">lrn1 =<span class="st"> </span><span class="kw"><a href="../../reference/makeTuneWrapper.html">makeTuneWrapper</a></span>(<span class="st">"classif.ksvm"</span>, <span class="dt">resampling =</span> inner, <span class="dt">par.set =</span> ps, <span class="dt">control =</span> ctrl,</a>
<a class="sourceLine" id="cb16-11" title="11">  <span class="dt">show.info =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb16-12" title="12"></a>
<a class="sourceLine" id="cb16-13" title="13"><span class="co"># Tune k-nearest neighbor in inner resampling loop</span></a>
<a class="sourceLine" id="cb16-14" title="14">ps =<span class="st"> </span><span class="kw">makeParamSet</span>(<span class="kw">makeDiscreteParam</span>(<span class="st">"k"</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">5</span>))</a>
<a class="sourceLine" id="cb16-15" title="15">ctrl =<span class="st"> </span><span class="kw"><a href="../../reference/makeTuneControlGrid.html">makeTuneControlGrid</a></span>()</a>
<a class="sourceLine" id="cb16-16" title="16">inner =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"Subsample"</span>, <span class="dt">iters =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb16-17" title="17">lrn2 =<span class="st"> </span><span class="kw"><a href="../../reference/makeTuneWrapper.html">makeTuneWrapper</a></span>(<span class="st">"classif.kknn"</span>, <span class="dt">resampling =</span> inner, <span class="dt">par.set =</span> ps, <span class="dt">control =</span> ctrl,</a>
<a class="sourceLine" id="cb16-18" title="18">  <span class="dt">show.info =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb16-19" title="19"><span class="co">## Loading required package: kknn</span></a>
<a class="sourceLine" id="cb16-20" title="20"></a>
<a class="sourceLine" id="cb16-21" title="21"><span class="co"># Learners</span></a>
<a class="sourceLine" id="cb16-22" title="22">lrns =<span class="st"> </span><span class="kw">list</span>(lrn1, lrn2)</a>
<a class="sourceLine" id="cb16-23" title="23"></a>
<a class="sourceLine" id="cb16-24" title="24"><span class="co"># Outer resampling loop</span></a>
<a class="sourceLine" id="cb16-25" title="25">outer =<span class="st"> </span><span class="kw">list</span>(<span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"Holdout"</span>), <span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"Bootstrap"</span>, <span class="dt">iters =</span> <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb16-26" title="26">res =<span class="st"> </span><span class="kw"><a href="../../reference/benchmark.html">benchmark</a></span>(lrns, tasks, outer, <span class="dt">measures =</span> <span class="kw">list</span>(acc, ber), <span class="dt">show.info =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb16-27" title="27">res</a>
<a class="sourceLine" id="cb16-28" title="28"><span class="co">##         task.id         learner.id acc.test.mean ber.test.mean</span></a>
<a class="sourceLine" id="cb16-29" title="29"><span class="co">## 1  iris-example classif.ksvm.tuned     0.9400000    0.05738706</span></a>
<a class="sourceLine" id="cb16-30" title="30"><span class="co">## 2  iris-example classif.kknn.tuned     0.9200000    0.07326007</span></a>
<a class="sourceLine" id="cb16-31" title="31"><span class="co">## 3 Sonar-example classif.ksvm.tuned     0.5421924    0.50000000</span></a>
<a class="sourceLine" id="cb16-32" title="32"><span class="co">## 4 Sonar-example classif.kknn.tuned     0.8613485    0.14610720</span></a></code></pre></div>
<p>The <code>print</code> method for the <code><a href="../../reference/BenchmarkResult.html">BenchmarkResult()</a></code> shows the aggregated performances from the outer resampling loop.</p>
<p>As you might recall, <code>mlr</code> offers several accessor function to extract information from the benchmark result. These are listed on the help page of <code><a href="../../reference/BenchmarkResult.html">BenchmarkResult()</a></code> and many examples are shown on the tutorial page about <a href="benchmark_experiments.html" target="_blank">benchmark experiments</a>.</p>
<p>The performance values in individual outer resampling runs can be obtained by <code><a href="../../reference/getBMRPerformances.html">getBMRPerformances()</a></code>. Note that, since we used different outer resampling strategies for the two tasks, the number of rows per task differ.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="kw"><a href="../../reference/getBMRPerformances.html">getBMRPerformances</a></span>(res, <span class="dt">as.df =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb17-2" title="2"><span class="co">##         task.id         learner.id iter       acc        ber</span></a>
<a class="sourceLine" id="cb17-3" title="3"><span class="co">## 1  iris-example classif.ksvm.tuned    1 0.9400000 0.05738706</span></a>
<a class="sourceLine" id="cb17-4" title="4"><span class="co">## 2  iris-example classif.kknn.tuned    1 0.9200000 0.07326007</span></a>
<a class="sourceLine" id="cb17-5" title="5"><span class="co">## 3 Sonar-example classif.ksvm.tuned    1 0.5164835 0.50000000</span></a>
<a class="sourceLine" id="cb17-6" title="6"><span class="co">## 4 Sonar-example classif.ksvm.tuned    2 0.5679012 0.50000000</span></a>
<a class="sourceLine" id="cb17-7" title="7"><span class="co">## 5 Sonar-example classif.kknn.tuned    1 0.8461538 0.15618956</span></a>
<a class="sourceLine" id="cb17-8" title="8"><span class="co">## 6 Sonar-example classif.kknn.tuned    2 0.8765432 0.13602484</span></a></code></pre></div>
<p>The results from the parameter tuning can be obtained through function <code><a href="../../reference/getBMRTuneResults.html">getBMRTuneResults()</a></code>.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1"><span class="kw"><a href="../../reference/getBMRTuneResults.html">getBMRTuneResults</a></span>(res)</a>
<a class="sourceLine" id="cb18-2" title="2"><span class="co">## $`iris-example`</span></a>
<a class="sourceLine" id="cb18-3" title="3"><span class="co">## $`iris-example`$classif.ksvm.tuned</span></a>
<a class="sourceLine" id="cb18-4" title="4"><span class="co">## $`iris-example`$classif.ksvm.tuned[[1]]</span></a>
<a class="sourceLine" id="cb18-5" title="5"><span class="co">## Tune result:</span></a>
<a class="sourceLine" id="cb18-6" title="6"><span class="co">## Op. pars: C=2; sigma=0.5</span></a>
<a class="sourceLine" id="cb18-7" title="7"><span class="co">## mmce.test.mean=0.0882353</span></a>
<a class="sourceLine" id="cb18-8" title="8"><span class="co">## </span></a>
<a class="sourceLine" id="cb18-9" title="9"><span class="co">## </span></a>
<a class="sourceLine" id="cb18-10" title="10"><span class="co">## $`iris-example`$classif.kknn.tuned</span></a>
<a class="sourceLine" id="cb18-11" title="11"><span class="co">## $`iris-example`$classif.kknn.tuned[[1]]</span></a>
<a class="sourceLine" id="cb18-12" title="12"><span class="co">## Tune result:</span></a>
<a class="sourceLine" id="cb18-13" title="13"><span class="co">## Op. pars: k=5</span></a>
<a class="sourceLine" id="cb18-14" title="14"><span class="co">## mmce.test.mean=0.0686275</span></a>
<a class="sourceLine" id="cb18-15" title="15"><span class="co">## </span></a>
<a class="sourceLine" id="cb18-16" title="16"><span class="co">## </span></a>
<a class="sourceLine" id="cb18-17" title="17"><span class="co">## </span></a>
<a class="sourceLine" id="cb18-18" title="18"><span class="co">## $`Sonar-example`</span></a>
<a class="sourceLine" id="cb18-19" title="19"><span class="co">## $`Sonar-example`$classif.ksvm.tuned</span></a>
<a class="sourceLine" id="cb18-20" title="20"><span class="co">## $`Sonar-example`$classif.ksvm.tuned[[1]]</span></a>
<a class="sourceLine" id="cb18-21" title="21"><span class="co">## Tune result:</span></a>
<a class="sourceLine" id="cb18-22" title="22"><span class="co">## Op. pars: C=1; sigma=0.5</span></a>
<a class="sourceLine" id="cb18-23" title="23"><span class="co">## mmce.test.mean=0.2714286</span></a>
<a class="sourceLine" id="cb18-24" title="24"><span class="co">## </span></a>
<a class="sourceLine" id="cb18-25" title="25"><span class="co">## $`Sonar-example`$classif.ksvm.tuned[[2]]</span></a>
<a class="sourceLine" id="cb18-26" title="26"><span class="co">## Tune result:</span></a>
<a class="sourceLine" id="cb18-27" title="27"><span class="co">## Op. pars: C=0.5; sigma=0.5</span></a>
<a class="sourceLine" id="cb18-28" title="28"><span class="co">## mmce.test.mean=0.2714286</span></a>
<a class="sourceLine" id="cb18-29" title="29"><span class="co">## </span></a>
<a class="sourceLine" id="cb18-30" title="30"><span class="co">## </span></a>
<a class="sourceLine" id="cb18-31" title="31"><span class="co">## $`Sonar-example`$classif.kknn.tuned</span></a>
<a class="sourceLine" id="cb18-32" title="32"><span class="co">## $`Sonar-example`$classif.kknn.tuned[[1]]</span></a>
<a class="sourceLine" id="cb18-33" title="33"><span class="co">## Tune result:</span></a>
<a class="sourceLine" id="cb18-34" title="34"><span class="co">## Op. pars: k=5</span></a>
<a class="sourceLine" id="cb18-35" title="35"><span class="co">## mmce.test.mean=0.0952381</span></a>
<a class="sourceLine" id="cb18-36" title="36"><span class="co">## </span></a>
<a class="sourceLine" id="cb18-37" title="37"><span class="co">## $`Sonar-example`$classif.kknn.tuned[[2]]</span></a>
<a class="sourceLine" id="cb18-38" title="38"><span class="co">## Tune result:</span></a>
<a class="sourceLine" id="cb18-39" title="39"><span class="co">## Op. pars: k=3</span></a>
<a class="sourceLine" id="cb18-40" title="40"><span class="co">## mmce.test.mean=0.1333333</span></a></code></pre></div>
<p>As for several other accessor functions a clearer representation as <code>data.frame</code> can be achieved by setting <code>as.df = TRUE</code>.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"><span class="kw"><a href="../../reference/getBMRTuneResults.html">getBMRTuneResults</a></span>(res, <span class="dt">as.df =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb19-2" title="2"><span class="co">##         task.id         learner.id iter   C sigma mmce.test.mean  k</span></a>
<a class="sourceLine" id="cb19-3" title="3"><span class="co">## 1  iris-example classif.ksvm.tuned    1 2.0   0.5     0.08823529 NA</span></a>
<a class="sourceLine" id="cb19-4" title="4"><span class="co">## 2  iris-example classif.kknn.tuned    1  NA    NA     0.06862745  5</span></a>
<a class="sourceLine" id="cb19-5" title="5"><span class="co">## 3 Sonar-example classif.ksvm.tuned    1 1.0   0.5     0.27142857 NA</span></a>
<a class="sourceLine" id="cb19-6" title="6"><span class="co">## 4 Sonar-example classif.ksvm.tuned    2 0.5   0.5     0.27142857 NA</span></a>
<a class="sourceLine" id="cb19-7" title="7"><span class="co">## 5 Sonar-example classif.kknn.tuned    1  NA    NA     0.09523810  5</span></a>
<a class="sourceLine" id="cb19-8" title="8"><span class="co">## 6 Sonar-example classif.kknn.tuned    2  NA    NA     0.13333333  3</span></a></code></pre></div>
<p>It is also possible to extract the tuning results for individual tasks and learners and, as shown in earlier examples, inspect the optimization path (<code><a href="http://www.rdocumentation.org/packages/ParamHelpers/topics/OptPath">ParamHelpers::OptPath()</a></code>).</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1">tune.res =<span class="st"> </span><span class="kw"><a href="../../reference/getBMRTuneResults.html">getBMRTuneResults</a></span>(res, <span class="dt">task.ids =</span> <span class="st">"Sonar-example"</span>, <span class="dt">learner.ids =</span> <span class="st">"classif.ksvm.tuned"</span>,</a>
<a class="sourceLine" id="cb20-2" title="2">  <span class="dt">as.df =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb20-3" title="3">tune.res</a>
<a class="sourceLine" id="cb20-4" title="4"><span class="co">##         task.id         learner.id iter   C sigma mmce.test.mean</span></a>
<a class="sourceLine" id="cb20-5" title="5"><span class="co">## 1 Sonar-example classif.ksvm.tuned    1 1.0   0.5      0.2714286</span></a>
<a class="sourceLine" id="cb20-6" title="6"><span class="co">## 2 Sonar-example classif.ksvm.tuned    2 0.5   0.5      0.2714286</span></a>
<a class="sourceLine" id="cb20-7" title="7"></a>
<a class="sourceLine" id="cb20-8" title="8"><span class="kw"><a href="../../reference/getNestedTuneResultsOptPathDf.html">getNestedTuneResultsOptPathDf</a></span>(res<span class="op">$</span>results[[<span class="st">"Sonar-example"</span>]][[<span class="st">"classif.ksvm.tuned"</span>]])</a></code></pre></div>
</div>
<div id="example-2-one-task-two-learners-feature-selection" class="section level2">
<h2 class="hasAnchor">
<a href="#example-2-one-task-two-learners-feature-selection" class="anchor"></a>Example 2: One task, two learners, feature selection</h2>
<p>Letâ€™s see how we can do <a href="feature_selection.html" target="_blank">feature selection</a> in a benchmark experiment:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="co"># Feature selection in inner resampling loop</span></a>
<a class="sourceLine" id="cb21-2" title="2">ctrl =<span class="st"> </span><span class="kw"><a href="../../reference/FeatSelControl.html">makeFeatSelControlSequential</a></span>(<span class="dt">method =</span> <span class="st">"sfs"</span>)</a>
<a class="sourceLine" id="cb21-3" title="3">inner =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"Subsample"</span>, <span class="dt">iters =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb21-4" title="4">lrn =<span class="st"> </span><span class="kw"><a href="../../reference/makeFeatSelWrapper.html">makeFeatSelWrapper</a></span>(<span class="st">"regr.lm"</span>, <span class="dt">resampling =</span> inner, <span class="dt">control =</span> ctrl, <span class="dt">show.info =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb21-5" title="5"></a>
<a class="sourceLine" id="cb21-6" title="6"><span class="co"># Learners</span></a>
<a class="sourceLine" id="cb21-7" title="7">lrns =<span class="st"> </span><span class="kw">list</span>(<span class="st">"regr.rpart"</span>, lrn)</a>
<a class="sourceLine" id="cb21-8" title="8"></a>
<a class="sourceLine" id="cb21-9" title="9"><span class="co"># Outer resampling loop</span></a>
<a class="sourceLine" id="cb21-10" title="10">outer =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"Subsample"</span>, <span class="dt">iters =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb21-11" title="11">res =<span class="st"> </span><span class="kw"><a href="../../reference/benchmark.html">benchmark</a></span>(<span class="dt">tasks =</span> bh.task, <span class="dt">learners =</span> lrns, <span class="dt">resampling =</span> outer, <span class="dt">show.info =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb21-12" title="12"></a>
<a class="sourceLine" id="cb21-13" title="13">res</a>
<a class="sourceLine" id="cb21-14" title="14"><span class="co">##                 task.id      learner.id mse.test.mean</span></a>
<a class="sourceLine" id="cb21-15" title="15"><span class="co">## 1 BostonHousing-example      regr.rpart      32.71228</span></a>
<a class="sourceLine" id="cb21-16" title="16"><span class="co">## 2 BostonHousing-example regr.lm.featsel      33.25482</span></a></code></pre></div>
<p>The selected features can be extracted by function <code><a href="../../reference/getBMRFeatSelResults.html">getBMRFeatSelResults()</a></code>. By default, a nested <code>list</code>, with the first level indicating the task and the second level indicating the learner, is returned. If only a single learner or, as in our case, a single task is considered, setting <code>drop = TRUE</code> simplifies the result to a flat <code>list</code>.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1"><span class="kw"><a href="../../reference/getBMRFeatSelResults.html">getBMRFeatSelResults</a></span>(res)</a>
<a class="sourceLine" id="cb22-2" title="2"><span class="co">## $`BostonHousing-example`</span></a>
<a class="sourceLine" id="cb22-3" title="3"><span class="co">## $`BostonHousing-example`$regr.rpart</span></a>
<a class="sourceLine" id="cb22-4" title="4"><span class="co">## NULL</span></a>
<a class="sourceLine" id="cb22-5" title="5"><span class="co">## </span></a>
<a class="sourceLine" id="cb22-6" title="6"><span class="co">## $`BostonHousing-example`$regr.lm.featsel</span></a>
<a class="sourceLine" id="cb22-7" title="7"><span class="co">## $`BostonHousing-example`$regr.lm.featsel[[1]]</span></a>
<a class="sourceLine" id="cb22-8" title="8"><span class="co">## FeatSel result:</span></a>
<a class="sourceLine" id="cb22-9" title="9"><span class="co">## Features (8): zn, chas, nox, rm, dis, ptratio, b, lstat</span></a>
<a class="sourceLine" id="cb22-10" title="10"><span class="co">## mse.test.mean=22.6204843</span></a>
<a class="sourceLine" id="cb22-11" title="11"><span class="co">## </span></a>
<a class="sourceLine" id="cb22-12" title="12"><span class="co">## $`BostonHousing-example`$regr.lm.featsel[[2]]</span></a>
<a class="sourceLine" id="cb22-13" title="13"><span class="co">## FeatSel result:</span></a>
<a class="sourceLine" id="cb22-14" title="14"><span class="co">## Features (8): zn, chas, nox, rm, dis, ptratio, b, lstat</span></a>
<a class="sourceLine" id="cb22-15" title="15"><span class="co">## mse.test.mean=20.6232429</span></a>
<a class="sourceLine" id="cb22-16" title="16"><span class="kw"><a href="../../reference/getBMRFeatSelResults.html">getBMRFeatSelResults</a></span>(res, <span class="dt">drop =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb22-17" title="17"><span class="co">## $regr.rpart</span></a>
<a class="sourceLine" id="cb22-18" title="18"><span class="co">## NULL</span></a>
<a class="sourceLine" id="cb22-19" title="19"><span class="co">## </span></a>
<a class="sourceLine" id="cb22-20" title="20"><span class="co">## $regr.lm.featsel</span></a>
<a class="sourceLine" id="cb22-21" title="21"><span class="co">## $regr.lm.featsel[[1]]</span></a>
<a class="sourceLine" id="cb22-22" title="22"><span class="co">## FeatSel result:</span></a>
<a class="sourceLine" id="cb22-23" title="23"><span class="co">## Features (8): zn, chas, nox, rm, dis, ptratio, b, lstat</span></a>
<a class="sourceLine" id="cb22-24" title="24"><span class="co">## mse.test.mean=22.6204843</span></a>
<a class="sourceLine" id="cb22-25" title="25"><span class="co">## </span></a>
<a class="sourceLine" id="cb22-26" title="26"><span class="co">## $regr.lm.featsel[[2]]</span></a>
<a class="sourceLine" id="cb22-27" title="27"><span class="co">## FeatSel result:</span></a>
<a class="sourceLine" id="cb22-28" title="28"><span class="co">## Features (8): zn, chas, nox, rm, dis, ptratio, b, lstat</span></a>
<a class="sourceLine" id="cb22-29" title="29"><span class="co">## mse.test.mean=20.6232429</span></a></code></pre></div>
<p>You can access results for individual learners and tasks and inspect them further.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1">feats =<span class="st"> </span><span class="kw"><a href="../../reference/getBMRFeatSelResults.html">getBMRFeatSelResults</a></span>(res, <span class="dt">learner.id =</span> <span class="st">"regr.lm.featsel"</span>, <span class="dt">drop =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb23-2" title="2"></a>
<a class="sourceLine" id="cb23-3" title="3"><span class="co"># Selected features in the first outer resampling iteration</span></a>
<a class="sourceLine" id="cb23-4" title="4">feats[[<span class="dv">1</span>]]<span class="op">$</span>x</a>
<a class="sourceLine" id="cb23-5" title="5"><span class="co">## [1] "zn"      "chas"    "nox"     "rm"      "dis"     "ptratio" "b"      </span></a>
<a class="sourceLine" id="cb23-6" title="6"><span class="co">## [8] "lstat"</span></a>
<a class="sourceLine" id="cb23-7" title="7"></a>
<a class="sourceLine" id="cb23-8" title="8"><span class="co"># Resampled performance of the selected feature subset on the first inner training set</span></a>
<a class="sourceLine" id="cb23-9" title="9">feats[[<span class="dv">1</span>]]<span class="op">$</span>y</a>
<a class="sourceLine" id="cb23-10" title="10"><span class="co">## mse.test.mean </span></a>
<a class="sourceLine" id="cb23-11" title="11"><span class="co">##      22.62048</span></a></code></pre></div>
<p>As for tuning, you can extract the optimization paths. The resulting <code>data.frame</code>s contain, among others, binary columns for all features, indicating if they were included in the linear regression model, and the corresponding performances. <code><a href="../../reference/analyzeFeatSelResult.html">analyzeFeatSelResult()</a></code> gives a clearer overview.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1">opt.paths =<span class="st"> </span><span class="kw">lapply</span>(feats, <span class="cf">function</span>(x) <span class="kw">as.data.frame</span>(x<span class="op">$</span>opt.path))</a>
<a class="sourceLine" id="cb24-2" title="2"><span class="kw">head</span>(opt.paths[[<span class="dv">1</span>]])</a>
<a class="sourceLine" id="cb24-3" title="3"><span class="co">##   crim zn indus chas nox rm age dis rad tax ptratio b lstat mse.test.mean</span></a>
<a class="sourceLine" id="cb24-4" title="4"><span class="co">## 1    0  0     0    0   0  0   0   0   0   0       0 0     0      72.70815</span></a>
<a class="sourceLine" id="cb24-5" title="5"><span class="co">## 2    1  0     0    0   0  0   0   0   0   0       0 0     0      83.88758</span></a>
<a class="sourceLine" id="cb24-6" title="6"><span class="co">## 3    0  1     0    0   0  0   0   0   0   0       0 0     0      59.49710</span></a>
<a class="sourceLine" id="cb24-7" title="7"><span class="co">## 4    0  0     1    0   0  0   0   0   0   0       0 0     0      49.81809</span></a>
<a class="sourceLine" id="cb24-8" title="8"><span class="co">## 5    0  0     0    1   0  0   0   0   0   0       0 0     0      75.29873</span></a>
<a class="sourceLine" id="cb24-9" title="9"><span class="co">## 6    0  0     0    0   1  0   0   0   0   0       0 0     0      53.07877</span></a>
<a class="sourceLine" id="cb24-10" title="10"><span class="co">##   dob eol error.message exec.time</span></a>
<a class="sourceLine" id="cb24-11" title="11"><span class="co">## 1   1   2          &lt;NA&gt;     0.016</span></a>
<a class="sourceLine" id="cb24-12" title="12"><span class="co">## 2   2   2          &lt;NA&gt;     0.022</span></a>
<a class="sourceLine" id="cb24-13" title="13"><span class="co">## 3   2   2          &lt;NA&gt;     0.022</span></a>
<a class="sourceLine" id="cb24-14" title="14"><span class="co">## 4   2   2          &lt;NA&gt;     0.036</span></a>
<a class="sourceLine" id="cb24-15" title="15"><span class="co">## 5   2   2          &lt;NA&gt;     0.028</span></a>
<a class="sourceLine" id="cb24-16" title="16"><span class="co">## 6   2   2          &lt;NA&gt;     0.019</span></a>
<a class="sourceLine" id="cb24-17" title="17"></a>
<a class="sourceLine" id="cb24-18" title="18"><span class="kw"><a href="../../reference/analyzeFeatSelResult.html">analyzeFeatSelResult</a></span>(feats[[<span class="dv">1</span>]])</a>
<a class="sourceLine" id="cb24-19" title="19"><span class="co">## Features         : 8</span></a>
<a class="sourceLine" id="cb24-20" title="20"><span class="co">## Performance      : mse.test.mean=22.6204843</span></a>
<a class="sourceLine" id="cb24-21" title="21"><span class="co">## zn, chas, nox, rm, dis, ptratio, b, lstat</span></a>
<a class="sourceLine" id="cb24-22" title="22"><span class="co">## </span></a>
<a class="sourceLine" id="cb24-23" title="23"><span class="co">## Path to optimum:</span></a>
<a class="sourceLine" id="cb24-24" title="24"><span class="co">## - Features:    0  Init   :                       Perf = 72.708  Diff: NA  *</span></a>
<a class="sourceLine" id="cb24-25" title="25"><span class="co">## - Features:    1  Add    : lstat                 Perf = 30.02  Diff: 42.688  *</span></a>
<a class="sourceLine" id="cb24-26" title="26"><span class="co">## - Features:    2  Add    : ptratio               Perf = 26.119  Diff: 3.9018  *</span></a>
<a class="sourceLine" id="cb24-27" title="27"><span class="co">## - Features:    3  Add    : rm                    Perf = 25.297  Diff: 0.82161  *</span></a>
<a class="sourceLine" id="cb24-28" title="28"><span class="co">## - Features:    4  Add    : b                     Perf = 24.23  Diff: 1.0667  *</span></a>
<a class="sourceLine" id="cb24-29" title="29"><span class="co">## - Features:    5  Add    : dis                   Perf = 23.997  Diff: 0.23374  *</span></a>
<a class="sourceLine" id="cb24-30" title="30"><span class="co">## - Features:    6  Add    : nox                   Perf = 22.958  Diff: 1.039  *</span></a>
<a class="sourceLine" id="cb24-31" title="31"><span class="co">## - Features:    7  Add    : chas                  Perf = 22.767  Diff: 0.19044  *</span></a>
<a class="sourceLine" id="cb24-32" title="32"><span class="co">## - Features:    8  Add    : zn                    Perf = 22.62  Diff: 0.14665  *</span></a>
<a class="sourceLine" id="cb24-33" title="33"><span class="co">## </span></a>
<a class="sourceLine" id="cb24-34" title="34"><span class="co">## Stopped, because no improving feature was found.</span></a></code></pre></div>
</div>
<div id="example-3-one-task-two-learners-feature-filtering-with-tuning" class="section level2">
<h2 class="hasAnchor">
<a href="#example-3-one-task-two-learners-feature-filtering-with-tuning" class="anchor"></a>Example 3: One task, two learners, feature filtering with tuning</h2>
<p>Here is a minimal example for feature filtering with tuning of the feature subset size.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"><span class="co"># Feature filtering with tuning in the inner resampling loop</span></a>
<a class="sourceLine" id="cb25-2" title="2">lrn =<span class="st"> </span><span class="kw"><a href="../../reference/makeFilterWrapper.html">makeFilterWrapper</a></span>(<span class="dt">learner =</span> <span class="st">"regr.lm"</span>, <span class="dt">fw.method =</span> <span class="st">"chi.squared"</span>)</a>
<a class="sourceLine" id="cb25-3" title="3">ps =<span class="st"> </span><span class="kw">makeParamSet</span>(<span class="kw">makeDiscreteParam</span>(<span class="st">"fw.abs"</span>, <span class="dt">values =</span> <span class="kw">seq_len</span>(<span class="kw"><a href="../../reference/getTaskNFeats.html">getTaskNFeats</a></span>(bh.task))))</a>
<a class="sourceLine" id="cb25-4" title="4">ctrl =<span class="st"> </span><span class="kw"><a href="../../reference/makeTuneControlGrid.html">makeTuneControlGrid</a></span>()</a>
<a class="sourceLine" id="cb25-5" title="5">inner =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"CV"</span>, <span class="dt">iter =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb25-6" title="6">lrn =<span class="st"> </span><span class="kw"><a href="../../reference/makeTuneWrapper.html">makeTuneWrapper</a></span>(lrn, <span class="dt">resampling =</span> inner, <span class="dt">par.set =</span> ps, <span class="dt">control =</span> ctrl,</a>
<a class="sourceLine" id="cb25-7" title="7">  <span class="dt">show.info =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb25-8" title="8"></a>
<a class="sourceLine" id="cb25-9" title="9"><span class="co"># Learners</span></a>
<a class="sourceLine" id="cb25-10" title="10">lrns =<span class="st"> </span><span class="kw">list</span>(<span class="st">"regr.rpart"</span>, lrn)</a>
<a class="sourceLine" id="cb25-11" title="11"></a>
<a class="sourceLine" id="cb25-12" title="12"><span class="co"># Outer resampling loop</span></a>
<a class="sourceLine" id="cb25-13" title="13">outer =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"Subsample"</span>, <span class="dt">iter =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb25-14" title="14">res =<span class="st"> </span><span class="kw"><a href="../../reference/benchmark.html">benchmark</a></span>(<span class="dt">tasks =</span> bh.task, <span class="dt">learners =</span> lrns, <span class="dt">resampling =</span> outer, <span class="dt">show.info =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb25-15" title="15"></a>
<a class="sourceLine" id="cb25-16" title="16">res</a>
<a class="sourceLine" id="cb25-17" title="17"><span class="co">##                 task.id             learner.id mse.test.mean</span></a>
<a class="sourceLine" id="cb25-18" title="18"><span class="co">## 1 BostonHousing-example             regr.rpart      20.31199</span></a>
<a class="sourceLine" id="cb25-19" title="19"><span class="co">## 2 BostonHousing-example regr.lm.filtered.tuned      24.55055</span></a></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1"><span class="co"># Performances on individual outer test data sets</span></a>
<a class="sourceLine" id="cb26-2" title="2"><span class="kw"><a href="../../reference/getBMRPerformances.html">getBMRPerformances</a></span>(res, <span class="dt">as.df =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb26-3" title="3"><span class="co">##                 task.id             learner.id iter      mse</span></a>
<a class="sourceLine" id="cb26-4" title="4"><span class="co">## 1 BostonHousing-example             regr.rpart    1 20.20148</span></a>
<a class="sourceLine" id="cb26-5" title="5"><span class="co">## 2 BostonHousing-example             regr.rpart    2 19.54692</span></a>
<a class="sourceLine" id="cb26-6" title="6"><span class="co">## 3 BostonHousing-example             regr.rpart    3 21.18758</span></a>
<a class="sourceLine" id="cb26-7" title="7"><span class="co">## 4 BostonHousing-example regr.lm.filtered.tuned    1 22.46666</span></a>
<a class="sourceLine" id="cb26-8" title="8"><span class="co">## 5 BostonHousing-example regr.lm.filtered.tuned    2 26.48045</span></a>
<a class="sourceLine" id="cb26-9" title="9"><span class="co">## 6 BostonHousing-example regr.lm.filtered.tuned    3 24.70455</span></a></code></pre></div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#tuning">Tuning</a><ul class="nav nav-pills nav-stacked">
<li><a href="#accessing-the-tuning-result">Accessing the tuning result</a></li>
      </ul>
</li>
      <li>
<a href="#feature-selection">Feature selection</a><ul class="nav nav-pills nav-stacked">
<li><a href="#wrapper-methods">Wrapper methods</a></li>
      <li><a href="#filter-methods-with-tuning">Filter methods with tuning</a></li>
      </ul>
</li>
      <li>
<a href="#benchmark-experiments">Benchmark experiments</a><ul class="nav nav-pills nav-stacked">
<li><a href="#example-1-two-tasks-two-learners-tuning">Example 1: Two tasks, two learners, tuning</a></li>
      <li><a href="#example-2-one-task-two-learners-feature-selection">Example 2: One task, two learners, feature selection</a></li>
      <li><a href="#example-3-one-task-two-learners-feature-filtering-with-tuning">Example 3: One task, two learners, feature filtering with tuning</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><!--<div class="copyright">
  <p>Developed by Bernd Bischl, Michel Lang, Lars Kotthoff, Julia Schiffner, Jakob Richter, Zachary Jones, Giuseppe Casalicchio, Mason Gallo, Patrick Schratz.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>
--></footer>
</div>

   
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script><script type="text/javascript"> docsearch({
â€ƒapiKey: 'e300ecafdf04fe1199e3339c825ce7d0',
â€ƒindexName: 'mlr',
â€ƒinputSelector: 'input#search-input.form-control',
â€ƒdebug: false // Set debug to true if you want to inspect the dropdown
});
</script>
</body>
</html>
