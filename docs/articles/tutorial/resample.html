<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- Google Site Verification --><meta name="google-site-verification" content="BrjL5fpoyHZu1rR8rwnnM2MBO3u3iIFB8NsmSuOsY84">
<title>Resampling • mlr</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../jquery.sticky-kit.min.js"></script><script src="../../pkgdown.js"></script><link href="../../extra.css" rel="stylesheet">
<script src="../../extra.js"></script><meta property="og:title" content="Resampling">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css">
<link rel="icon" type="image/png" href="https://mlr-org.github.io/mlr/favicon.ico">
<link rel="apple-touch-icon" type="image/png" href="https://mlr-org.github.io/mlr/favicon.ico">
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a class="navbar-brand" href="../../index.html"></a>
      </div>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Basics
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/tutorial/task.html">Tasks</a>
    </li>
    <li>
      <a href="../../articles/tutorial/learner.html">Learners</a>
    </li>
    <li>
      <a href="../../articles/tutorial/train.html">Train</a>
    </li>
    <li>
      <a href="../../articles/tutorial/predict.html">Predict</a>
    </li>
    <li>
      <a href="../../articles/tutorial/preproc.html">Preprocessing</a>
    </li>
    <li>
      <a href="../../articles/tutorial/performance.html">Performance</a>
    </li>
    <li>
      <a href="../../articles/tutorial/resample.html">Resampling</a>
    </li>
    <li>
      <a href="../../articles/tutorial/tune.html">Tuning</a>
    </li>
    <li>
      <a href="../../articles/tutorial/benchmark_experiments.html">Benchmark Experiments</a>
    </li>
    <li>
      <a href="../../articles/tutorial/parallelization.html">Parallelization</a>
    </li>
    <li>
      <a href="../../articles/tutorial/visualization.html">Visualization</a>
    </li>
    <li>
      <a href="../../articles/tutorial/usecase_regression.html">Use case - Regression</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Advanced
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/tutorial/configureMlr.html">Configuration</a>
    </li>
    <li>
      <a href="../../articles/tutorial/wrapper.html">Wrapped Learners</a>
    </li>
    <li>
      <a href="../../articles/tutorial/impute.html">Imputation</a>
    </li>
    <li>
      <a href="../../articles/tutorial/bagging.html">Generic Bagging</a>
    </li>
    <li>
      <a href="../../articles/tutorial/advanced_tune.html">Advanced Tuning</a>
    </li>
    <li>
      <a href="../../articles/tutorial/feature_selection.html">Feature Selection/Filtering</a>
    </li>
    <li>
      <a href="../../articles/tutorial/nested_resampling.html">Nested Resampling</a>
    </li>
    <li>
      <a href="../../articles/tutorial/cost_sensitive_classif.html">Cost-Sensitive Classification</a>
    </li>
    <li>
      <a href="../../articles/tutorial/over_and_undersampling.html">Imbalanced Classification Problems</a>
    </li>
    <li>
      <a href="../../articles/tutorial/roc_analysis.html">ROC Analysis and Performance Curves</a>
    </li>
    <li>
      <a href="../../articles/tutorial/multilabel.html">Multilabel Classification</a>
    </li>
    <li>
      <a href="../../articles/tutorial/learning_curve.html">Learning Curve Analysis</a>
    </li>
    <li>
      <a href="../../articles/tutorial/partial_dependence.html">Partial Dependence Plots</a>
    </li>
    <li>
      <a href="../../articles/tutorial/classifier_calibration.html">Classifier Calibration</a>
    </li>
    <li>
      <a href="../../articles/tutorial/hyperpar_tuning_effects.html">Hyperparameter Tuning Effects</a>
    </li>
    <li>
      <a href="../../articles/tutorial/out_of_bag_predictions.html">Out-of-Bag Predictions</a>
    </li>
    <li>
      <a href="../../articles/tutorial/handling_of_spatial_data.html">Handling of Spatial Data</a>
    </li>
    <li>
      <a href="../../articles/tutorial/functional_data.html">Functional Data</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Extending
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/tutorial/create_learner.html">Create Custom Learners</a>
    </li>
    <li>
      <a href="../../articles/tutorial/create_measure.html">Create Custom Measures</a>
    </li>
    <li>
      <a href="../../articles/tutorial/create_imputation.html">Create Imputation Methods</a>
    </li>
    <li>
      <a href="../../articles/tutorial/create_filter.html">Create Custom Filters</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Appendix
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../reference/index.html">Function Reference</a>
    </li>
    <li>
      <a href="../../news/index.html">News</a>
    </li>
    <li>
      <a href="../../articles/tutorial/example_tasks.html">Example Tasks</a>
    </li>
    <li>
      <a href="../../articles/tutorial/integrated_learners.html">Integrated Learners</a>
    </li>
    <li>
      <a href="../../articles/tutorial/measures.html">Implemented Measures</a>
    </li>
    <li>
      <a href="../../articles/tutorial/filter_methods.html">Integrated Filter Methods</a>
    </li>
    <li>
      <a href="../../articles/tutorial/mlr_publications.html">mlr Publications</a>
    </li>
    <li>
      <a href="../../articles/tutorial/talks_videos_workshops.html">Talks, Videos and Workshops</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    mlr-org Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="https://github.com/mlr-org/mlrMBO">mlrMBO</a>
    </li>
    <li>
      <a href="https://github.com/mlr-org/mlrCPO">mlrCPO</a>
    </li>
    <li>
      <a href="https://jakob-r.de/mlrHyperopt/index.html">mlrHyperopt</a>
    </li>
    <li>
      <a href="https://openml.github.io/openml-r/vignettes/OpenML.html">OpenML</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mlr-org/mlr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://mlr-org.slack.com">
    <span class="fa fa-slack"></span>
     
  </a>
</li>
<li>
  <a href="https://stackoverflow.com/questions/tagged/mlr">
    <span class="fa fa-stack-overflow"></span>
     
  </a>
</li>
<li>
  <a href="https://mlr-blog.netlify.com/">
    <span class="fa fa-rss"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="search" class="form-control" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Resampling</h1>
            
      
      <!--The 'toc' block was inserted manually by @pat-s. It triggeres the inline ToC in the vignettes.-->
            <div id="toc">
      <h3 class="hasAnchor">
<a href="#toc" class="anchor"></a>Table of Contents</h3>
      <ul>
<li><a href="#defining-the-resampling-strategy">Defining the resampling strategy</a></li>
      <li><a href="#performing-the-resampling">Performing the resampling</a></li>
      <li><a href="#accessing-resample-results">Accessing resample results</a></li>
      <li><a href="#stratification-blocking-and-grouping">Stratification, Blocking and Grouping</a></li>
      <li><a href="#resample-descriptions-and-resample-instances">Resample descriptions and resample instances</a></li>
      <li><a href="#aggregating-performance-values">Aggregating performance values</a></li>
      <li><a href="#convenience-functions">Convenience functions</a></li>
      </ul>
</div>
      
      <small>Source: <a href="https://github.com/mlr-org/mlr/blob/master/vignettes/tutorial/resample.Rmd"><code>vignettes/tutorial/resample.Rmd</code></a></small>

    </div>

    
    
<div class="contents">
<p>Resampling strategies are usually used to assess the performance of a learning algorithm: The entire data set is (repeatedly) split into training sets <span class="math inline">\(D^{*b}\)</span> and test sets <span class="math inline">\(D \setminus D^{*b}\)</span>, <span class="math inline">\(b = 1,\ldots,B\)</span>. The learner is trained on each training set, predictions are made on the corresponding test set (sometimes on the training set as well) and the performance measure <span class="math inline">\(S(D^{*b}, D \setminus D^{*b})\)</span> is calculated. Then the <span class="math inline">\(B\)</span> individual performance values are aggregated, most often by calculating the mean. There exist various different resampling strategies, for example cross-validation and bootstrap, to mention just two popular approaches.</p>
<div class="figure" style="text-align: center">
<img src="https://raw.githubusercontent.com/pat-s/mlr/master/vignettes/tutorial/devel/pdf/img/resampling.png" alt="Resampling Figure" width="600px"><p class="caption">
Resampling Figure
</p>
</div>
<p>If you want to read up on further details, the paper <a href="http://link.springer.com/chapter/10.1007%2F978-0-387-47509-7_8">Resampling Strategies for Model Assessment and Selection</a> by Simon is probably not a bad choice. Bernd has also published a paper <a href="http://www.mitpressjournals.org/doi/pdf/10.1162/EVCO_a_00069">Resampling methods for meta-model validation with recommendations for evolutionary computation</a> which contains detailed descriptions and lots of statistical background information on resampling methods.</p>
<div id="defining-the-resampling-strategy" class="section level2">
<h2 class="hasAnchor">
<a href="#defining-the-resampling-strategy" class="anchor"></a>Defining the resampling strategy</h2>
<p>In <code>mlr</code> the resampling strategy can be defined via function <code><a href="../../reference/makeResampleDesc.html">makeResampleDesc()</a></code>. It requires a string that specifies the resampling method and, depending on the selected strategy, further information like the number of iterations. The supported resampling strategies are:</p>
<ul>
<li>Cross-validation (<code>"CV"</code>),</li>
<li>Leave-one-out cross-validation (<code>"LOO"</code>),</li>
<li>Repeated cross-validation (<code>"RepCV"</code>),</li>
<li>Out-of-bag bootstrap and other variants like <em>b632</em> (<code>"Bootstrap"</code>),</li>
<li>Subsampling, also called Monte-Carlo cross-validation (<code>"Subsample"</code>),</li>
<li>Holdout (training/test) (<code>"Holdout"</code>).</li>
</ul>
<p>For example if you want to use 3-fold cross-validation type:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># 3-fold cross-validation</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2">rdesc =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"CV"</span>, <span class="dt">iters =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3">rdesc</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="co">## Resample description: cross-validation with 3 iterations.</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="co">## Predict: test</span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="co">## Stratification: FALSE</span></a></code></pre></div>
<p>For holdout estimation use:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co"># Holdout estimation</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2">rdesc =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"Holdout"</span>)</a>
<a class="sourceLine" id="cb2-3" data-line-number="3">rdesc</a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="co">## Resample description: holdout with 0.67 split rate.</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="co">## Predict: test</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="co">## Stratification: FALSE</span></a></code></pre></div>
<p>In order to save you some typing <code>mlr</code> contains some pre-defined resample descriptions for very common strategies like holdout (<code>hout</code> (<code><a href="../../reference/makeResampleDesc.html">makeResampleDesc()</a></code>)) as well as cross-validation with different numbers of folds (e.g., <code>cv5</code> (<code><a href="../../reference/makeResampleDesc.html">makeResampleDesc()</a></code>) or <code>cv10</code> (<code><a href="../../reference/makeResampleDesc.html">makeResampleDesc()</a></code>)).</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">hout</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="co">## Resample description: holdout with 0.67 split rate.</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="co">## Predict: test</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="co">## Stratification: FALSE</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"></a>
<a class="sourceLine" id="cb3-6" data-line-number="6">cv3</a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="co">## Resample description: cross-validation with 3 iterations.</span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="co">## Predict: test</span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9"><span class="co">## Stratification: FALSE</span></a></code></pre></div>
</div>
<div id="performing-the-resampling" class="section level2">
<h2 class="hasAnchor">
<a href="#performing-the-resampling" class="anchor"></a>Performing the resampling</h2>
<p>Function <code><a href="../../reference/resample.html">resample()</a></code> evaluates a Learner (<code><a href="../../reference/makeLearner.html">makeLearner()</a></code>) on a given machine learning <code><a href="../../reference/Task.html">Task()</a></code> using the selected resampling strategy (<code><a href="../../reference/makeResampleDesc.html">makeResampleDesc()</a></code>).</p>
<p>As a first example, the performance of linear regression (<code><a href="http://www.rdocumentation.org/packages/stats/topics/lm">stats::lm()</a></code>) on the <code>BostonHousing</code> (<code><a href="http://www.rdocumentation.org/packages/mlbench/topics/BostonHousing">mlbench::BostonHousing()</a></code>) data set is calculated using <em>3-fold cross-validation</em>.</p>
<p>Generally, for <em><span class="math inline">\(K\)</span>-fold cross-validation</em> the data set <span class="math inline">\(D\)</span> is partitioned into <span class="math inline">\(K\)</span> subsets of (approximately) equal size. In the <span class="math inline">\(b\)</span>-th of the <span class="math inline">\(K\)</span> iterations, the <span class="math inline">\(b\)</span>-th subset is used for testing, while the union of the remaining parts forms the training set.</p>
<p>As usual, you can either pass a Learner (<code><a href="../../reference/makeLearner.html">makeLearner()</a></code>) object to <code><a href="../../reference/resample.html">resample()</a></code> or, as done here, provide the class name <code>"regr.lm"</code> of the learner. Since no performance measure is specified the default for regression learners (mean squared error, <a href="measures.html" target="_blank">mse</a>) is calculated.</p>
<pre><code>## Resampling: cross-validation
## Measures:             mse
## [Resample] iter 1:    25.1371739
## [Resample] iter 2:    23.1279497
## [Resample] iter 3:    21.9152672
## 
## Aggregated Result: mse.test.mean=23.3934636
## </code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="co"># Specify the resampling strategy (3-fold cross-validation)</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2">rdesc =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"CV"</span>, <span class="dt">iters =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb5-3" data-line-number="3"></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="co"># Calculate the performance</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5">r =<span class="st"> </span><span class="kw"><a href="../../reference/resample.html">resample</a></span>(<span class="st">"regr.lm"</span>, bh.task, rdesc)</a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co">## Resampling: cross-validation</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co">## Measures:             mse</span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="co">## [Resample] iter 1:    25.1371739</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="co">## [Resample] iter 2:    23.1279497</span></a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="co">## [Resample] iter 3:    21.9152672</span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11"><span class="co">## </span></a>
<a class="sourceLine" id="cb5-12" data-line-number="12"><span class="co">## Aggregated Result: mse.test.mean=23.3934636</span></a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="co">## </span></a>
<a class="sourceLine" id="cb5-14" data-line-number="14"></a>
<a class="sourceLine" id="cb5-15" data-line-number="15">r</a>
<a class="sourceLine" id="cb5-16" data-line-number="16"><span class="co">## Resample Result</span></a>
<a class="sourceLine" id="cb5-17" data-line-number="17"><span class="co">## Task: BostonHousing-example</span></a>
<a class="sourceLine" id="cb5-18" data-line-number="18"><span class="co">## Learner: regr.lm</span></a>
<a class="sourceLine" id="cb5-19" data-line-number="19"><span class="co">## Aggr perf: mse.test.mean=23.3934636</span></a>
<a class="sourceLine" id="cb5-20" data-line-number="20"><span class="co">## Runtime: 0.0375051</span></a></code></pre></div>
<p>The result <code>r</code> is an object of class <code><a href="../../reference/resample.html">resample()</a></code> result. It contains performance results for the learner and some additional information like the runtime, predicted values, and optionally the models fitted in single resampling iterations.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="co"># Peak into r</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="kw">names</span>(r)</a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="co">##  [1] "learner.id"     "task.id"        "task.desc"      "measures.train"</span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="co">##  [5] "measures.test"  "aggr"           "pred"           "models"        </span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="co">##  [9] "err.msgs"       "err.dumps"      "extract"        "runtime"</span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"></a>
<a class="sourceLine" id="cb6-7" data-line-number="7">r<span class="op">$</span>aggr</a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="co">## mse.test.mean </span></a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="co">##      23.39346</span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10"></a>
<a class="sourceLine" id="cb6-11" data-line-number="11">r<span class="op">$</span>measures.test</a>
<a class="sourceLine" id="cb6-12" data-line-number="12"><span class="co">##   iter      mse</span></a>
<a class="sourceLine" id="cb6-13" data-line-number="13"><span class="co">## 1    1 25.13717</span></a>
<a class="sourceLine" id="cb6-14" data-line-number="14"><span class="co">## 2    2 23.12795</span></a>
<a class="sourceLine" id="cb6-15" data-line-number="15"><span class="co">## 3    3 21.91527</span></a></code></pre></div>
<p><code>r$measures.test</code> gives the performance on each of the 3 test data sets. <code>r$aggr</code> shows the aggregated performance value. Its name <code>"mse.test.mean"</code> indicates the performance measure, <a href="measures.html" target="_blank">mse</a>, and the method, <code>test.mean</code> (<code><a href="../../reference/aggregations.html">aggregations()</a></code>), used to aggregate the 3 individual performances. <code>test.mean</code> (<code><a href="../../reference/aggregations.html">aggregations()</a></code>) is the default aggregation scheme for most performance measures and, as the name implies, takes the mean over the performances on the test data sets.</p>
<p>Resampling in <code>mlr</code> works the same way for all types of learning problems and learners. Below is a classification example where a classification tree (rpart) (<code><a href="http://www.rdocumentation.org/packages/rpart/topics/rpart">rpart::rpart()</a></code>) is evaluated on the <code>Sonar</code> (<code>mlbench::sonar()</code>) data set by subsampling with 5 iterations.</p>
<p>In each subsampling iteration the data set <span class="math inline">\(D\)</span> is randomly partitioned into a training and a test set according to a given percentage, e.g., 2/3 training and 1/3 test set. If there is just one iteration, the strategy is commonly called <em>holdout</em> or <em>test sample estimation</em>.</p>
<p>You can calculate several measures at once by passing a <code>list</code> of Measures (<code><a href="../../reference/makeMeasure.html">makeMeasure()</a></code>)s to <code><a href="../../reference/resample.html">resample()</a></code>. Below, the error rate (<a href="measures.html" target="_blank">mmce</a>), false positive and false negative rates (<a href="measures.html" target="_blank">fpr</a>, <a href="measures.html" target="_blank">fnr</a>), and the time it takes to train the learner (<a href="measures.html" target="_blank">timetrain</a>) are estimated by <em>subsampling</em> with 5 iterations.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="co"># Subsampling with 5 iterations and default split ratio 2/3</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2">rdesc =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"Subsample"</span>, <span class="dt">iters =</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb7-3" data-line-number="3"></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="co"># Subsampling with 5 iterations and 4/5 training data</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5">rdesc =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"Subsample"</span>, <span class="dt">iters =</span> <span class="dv">5</span>, <span class="dt">split =</span> <span class="dv">4</span><span class="op">/</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb7-6" data-line-number="6"></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="co"># Classification tree with information splitting criterion</span></a>
<a class="sourceLine" id="cb7-8" data-line-number="8">lrn =<span class="st"> </span><span class="kw"><a href="../../reference/makeLearner.html">makeLearner</a></span>(<span class="st">"classif.rpart"</span>, <span class="dt">parms =</span> <span class="kw">list</span>(<span class="dt">split =</span> <span class="st">"information"</span>))</a>
<a class="sourceLine" id="cb7-9" data-line-number="9"></a>
<a class="sourceLine" id="cb7-10" data-line-number="10"><span class="co"># Calculate the performance measures</span></a>
<a class="sourceLine" id="cb7-11" data-line-number="11">r =<span class="st"> </span><span class="kw"><a href="../../reference/resample.html">resample</a></span>(lrn, sonar.task, rdesc, <span class="dt">measures =</span> <span class="kw">list</span>(mmce, fpr, fnr, timetrain))</a>
<a class="sourceLine" id="cb7-12" data-line-number="12"><span class="co">## Resampling: subsampling</span></a>
<a class="sourceLine" id="cb7-13" data-line-number="13"><span class="co">## Measures:             mmce        fpr         fnr         timetrain</span></a>
<a class="sourceLine" id="cb7-14" data-line-number="14"><span class="co">## [Resample] iter 1:    0.4047619   0.5416667   0.2222222   0.0110000</span></a>
<a class="sourceLine" id="cb7-15" data-line-number="15"><span class="co">## [Resample] iter 2:    0.1666667   0.1200000   0.2352941   0.0070000</span></a>
<a class="sourceLine" id="cb7-16" data-line-number="16"><span class="co">## [Resample] iter 3:    0.3333333   0.1333333   0.4444444   0.0100000</span></a>
<a class="sourceLine" id="cb7-17" data-line-number="17"><span class="co">## [Resample] iter 4:    0.2380952   0.3913043   0.0526316   0.0280000</span></a>
<a class="sourceLine" id="cb7-18" data-line-number="18"><span class="co">## [Resample] iter 5:    0.3095238   0.2800000   0.3529412   0.0080000</span></a>
<a class="sourceLine" id="cb7-19" data-line-number="19"><span class="co">## </span></a>
<a class="sourceLine" id="cb7-20" data-line-number="20"><span class="co">## Aggregated Result: mmce.test.mean=0.2904762,fpr.test.mean=0.2932609,fnr.test.mean=0.2615067,timetrain.test.mean=0.0128000</span></a>
<a class="sourceLine" id="cb7-21" data-line-number="21"><span class="co">## </span></a>
<a class="sourceLine" id="cb7-22" data-line-number="22"></a>
<a class="sourceLine" id="cb7-23" data-line-number="23">r</a>
<a class="sourceLine" id="cb7-24" data-line-number="24"><span class="co">## Resample Result</span></a>
<a class="sourceLine" id="cb7-25" data-line-number="25"><span class="co">## Task: Sonar-example</span></a>
<a class="sourceLine" id="cb7-26" data-line-number="26"><span class="co">## Learner: classif.rpart</span></a>
<a class="sourceLine" id="cb7-27" data-line-number="27"><span class="co">## Aggr perf: mmce.test.mean=0.2904762,fpr.test.mean=0.2932609,fnr.test.mean=0.2615067,timetrain.test.mean=0.0128000</span></a>
<a class="sourceLine" id="cb7-28" data-line-number="28"><span class="co">## Runtime: 0.10692</span></a></code></pre></div>
<p>If you want to add further measures afterwards, use <code><a href="../../reference/addRRMeasure.html">addRRMeasure()</a></code>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="co"># Add balanced error rate (ber) and time used to predict</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="kw"><a href="../../reference/addRRMeasure.html">addRRMeasure</a></span>(r, <span class="kw">list</span>(ber, timepredict))</a>
<a class="sourceLine" id="cb8-3" data-line-number="3"></a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="co">## Resample Result</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="co">## Task: Sonar-example</span></a>
<a class="sourceLine" id="cb8-6" data-line-number="6"><span class="co">## Learner: classif.rpart</span></a>
<a class="sourceLine" id="cb8-7" data-line-number="7"><span class="co">## Aggr perf: mmce.test.mean=0.2904762,fpr.test.mean=0.2932609,fnr.test.mean=0.2615067,timetrain.test.mean=0.0128000,ber.test.mean=0.2773838,timepredict.test.mean=0.0032000</span></a>
<a class="sourceLine" id="cb8-8" data-line-number="8"><span class="co">## Runtime: 0.10692</span></a></code></pre></div>
<p>By default, <code><a href="../../reference/resample.html">resample()</a></code> prints progress messages and intermediate results. You can turn this off by setting <code>show.info = FALSE</code>, as done in the code chunk below. (If you are interested in suppressing these messages permanently have a look at the tutorial page about <a href="configureMlr.html" target="_blank">configuring mlr</a>.)</p>
<p>In the above example, the Learner (<code><a href="../../reference/makeLearner.html">makeLearner()</a></code>) was explicitly constructed. For convenience you can also specify the learner as a string and pass any learner parameters via the <code>...</code> argument of <code><a href="../../reference/resample.html">resample()</a></code>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">r =<span class="st"> </span><span class="kw"><a href="../../reference/resample.html">resample</a></span>(<span class="st">"classif.rpart"</span>, <span class="dt">parms =</span> <span class="kw">list</span>(<span class="dt">split =</span> <span class="st">"information"</span>), sonar.task, rdesc,</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">  <span class="dt">measures =</span> <span class="kw">list</span>(mmce, fpr, fnr, timetrain), <span class="dt">show.info =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb9-3" data-line-number="3"></a>
<a class="sourceLine" id="cb9-4" data-line-number="4">r</a>
<a class="sourceLine" id="cb9-5" data-line-number="5"></a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="co">## Resample Result</span></a>
<a class="sourceLine" id="cb9-7" data-line-number="7"><span class="co">## Task: Sonar-example</span></a>
<a class="sourceLine" id="cb9-8" data-line-number="8"><span class="co">## Learner: classif.rpart</span></a>
<a class="sourceLine" id="cb9-9" data-line-number="9"><span class="co">## Aggr perf: mmce.test.mean=0.2428571,fpr.test.mean=0.2968173,fnr.test.mean=0.1970195,timetrain.test.mean=0.0084000</span></a>
<a class="sourceLine" id="cb9-10" data-line-number="10"><span class="co">## Runtime: 0.0791025</span></a></code></pre></div>
</div>
<div id="accessing-resample-results" class="section level2">
<h2 class="hasAnchor">
<a href="#accessing-resample-results" class="anchor"></a>Accessing resample results</h2>
<p>Apart from the learner performance you can extract further information from the resample results, for example predicted values or the models fitted in individual resample iterations.</p>
<div id="predictions" class="section level3">
<h3 class="hasAnchor">
<a href="#predictions" class="anchor"></a>Predictions</h3>
<p>Per default, the <code><a href="../../reference/resample.html">resample()</a></code> result contains the predictions made during the resampling. If you do not want to keep them, e.g., in order to conserve memory, set <code>keep.pred = FALSE</code> when calling <code><a href="../../reference/resample.html">resample()</a></code>.</p>
<p>The predictions are stored in slot <code>$pred</code> of the resampling result, which can also be accessed by function <code><a href="../../reference/getRRPredictions.html">getRRPredictions()</a></code>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">r<span class="op">$</span>pred</a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="co">## Resampled Prediction for:</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="co">## Resample description: subsampling with 5 iterations and 0.80 split rate.</span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="co">## Predict: test</span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="co">## Stratification: FALSE</span></a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="co">## predict.type: response</span></a>
<a class="sourceLine" id="cb10-7" data-line-number="7"><span class="co">## threshold: </span></a>
<a class="sourceLine" id="cb10-8" data-line-number="8"><span class="co">## time (mean): 0.00</span></a>
<a class="sourceLine" id="cb10-9" data-line-number="9"><span class="co">##    id truth response iter  set</span></a>
<a class="sourceLine" id="cb10-10" data-line-number="10"><span class="co">## 1  18     R        M    1 test</span></a>
<a class="sourceLine" id="cb10-11" data-line-number="11"><span class="co">## 2 189     M        M    1 test</span></a>
<a class="sourceLine" id="cb10-12" data-line-number="12"><span class="co">## 3  88     R        R    1 test</span></a>
<a class="sourceLine" id="cb10-13" data-line-number="13"><span class="co">## 4 121     M        R    1 test</span></a>
<a class="sourceLine" id="cb10-14" data-line-number="14"><span class="co">## 5 165     M        R    1 test</span></a>
<a class="sourceLine" id="cb10-15" data-line-number="15"><span class="co">## 6 111     M        M    1 test</span></a>
<a class="sourceLine" id="cb10-16" data-line-number="16"><span class="co">## ... (#rows: 210, #cols: 5)</span></a>
<a class="sourceLine" id="cb10-17" data-line-number="17"></a>
<a class="sourceLine" id="cb10-18" data-line-number="18">pred =<span class="st"> </span><span class="kw"><a href="../../reference/getRRPredictions.html">getRRPredictions</a></span>(r)</a>
<a class="sourceLine" id="cb10-19" data-line-number="19">pred</a>
<a class="sourceLine" id="cb10-20" data-line-number="20"><span class="co">## Resampled Prediction for:</span></a>
<a class="sourceLine" id="cb10-21" data-line-number="21"><span class="co">## Resample description: subsampling with 5 iterations and 0.80 split rate.</span></a>
<a class="sourceLine" id="cb10-22" data-line-number="22"><span class="co">## Predict: test</span></a>
<a class="sourceLine" id="cb10-23" data-line-number="23"><span class="co">## Stratification: FALSE</span></a>
<a class="sourceLine" id="cb10-24" data-line-number="24"><span class="co">## predict.type: response</span></a>
<a class="sourceLine" id="cb10-25" data-line-number="25"><span class="co">## threshold: </span></a>
<a class="sourceLine" id="cb10-26" data-line-number="26"><span class="co">## time (mean): 0.00</span></a>
<a class="sourceLine" id="cb10-27" data-line-number="27"><span class="co">##    id truth response iter  set</span></a>
<a class="sourceLine" id="cb10-28" data-line-number="28"><span class="co">## 1  18     R        M    1 test</span></a>
<a class="sourceLine" id="cb10-29" data-line-number="29"><span class="co">## 2 189     M        M    1 test</span></a>
<a class="sourceLine" id="cb10-30" data-line-number="30"><span class="co">## 3  88     R        R    1 test</span></a>
<a class="sourceLine" id="cb10-31" data-line-number="31"><span class="co">## 4 121     M        R    1 test</span></a>
<a class="sourceLine" id="cb10-32" data-line-number="32"><span class="co">## 5 165     M        R    1 test</span></a>
<a class="sourceLine" id="cb10-33" data-line-number="33"><span class="co">## 6 111     M        M    1 test</span></a>
<a class="sourceLine" id="cb10-34" data-line-number="34"><span class="co">## ... (#rows: 210, #cols: 5)</span></a></code></pre></div>
<p><code>pred</code> is an object of class <code><a href="../../reference/resample.html">resample()</a></code> Prediction. Just as a <code><a href="../../reference/Prediction.html">Prediction()</a></code> object (see the tutorial page on making <a href="predict.html" target="_blank">predictions</a> it has an element <code>$data</code> which is a <code>data.frame</code> that contains the predictions and in the case of a supervised learning problem the true values of the target variable(s). You can use <code>as.data.frame</code> (<code><a href="../../reference/Prediction.html">Prediction()</a></code> to directly access the <code>$data</code> slot. Moreover, all getter functions for <code><a href="../../reference/Prediction.html">Prediction()</a></code> objects like <code><a href="../../reference/getPredictionResponse.html">getPredictionResponse()</a></code> or <code><a href="../../reference/getPredictionProbabilities.html">getPredictionProbabilities()</a></code> are applicable.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw">head</span>(<span class="kw">as.data.frame</span>(pred))</a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="co">##    id truth response iter  set</span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="co">## 1 207     M        M    1 test</span></a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="co">## 2 127     M        M    1 test</span></a>
<a class="sourceLine" id="cb11-5" data-line-number="5"><span class="co">## 3 182     M        M    1 test</span></a>
<a class="sourceLine" id="cb11-6" data-line-number="6"><span class="co">## 4 166     M        M    1 test</span></a>
<a class="sourceLine" id="cb11-7" data-line-number="7"><span class="co">## 5 119     M        M    1 test</span></a>
<a class="sourceLine" id="cb11-8" data-line-number="8"><span class="co">## 6 114     M        R    1 test</span></a>
<a class="sourceLine" id="cb11-9" data-line-number="9"></a>
<a class="sourceLine" id="cb11-10" data-line-number="10"><span class="kw">head</span>(<span class="kw"><a href="../../reference/getPredictionResponse.html">getPredictionTruth</a></span>(pred))</a>
<a class="sourceLine" id="cb11-11" data-line-number="11"><span class="co">## [1] M M M M M M</span></a>
<a class="sourceLine" id="cb11-12" data-line-number="12"><span class="co">## Levels: M R</span></a>
<a class="sourceLine" id="cb11-13" data-line-number="13"></a>
<a class="sourceLine" id="cb11-14" data-line-number="14"><span class="kw">head</span>(<span class="kw"><a href="../../reference/getPredictionResponse.html">getPredictionResponse</a></span>(pred))</a>
<a class="sourceLine" id="cb11-15" data-line-number="15"><span class="co">## [1] M M M M M R</span></a>
<a class="sourceLine" id="cb11-16" data-line-number="16"><span class="co">## Levels: M R</span></a></code></pre></div>
<p>The columns <code>iter</code> and <code>set</code> in the <code>data.frame</code> indicate the resampling iteration and the data set (<code>train</code> or <code>test</code>) for which the prediction was made.</p>
<p>By default, predictions are made for the test sets only. If predictions for the training set are required, set <code>predict = "train"</code> (for predictions on the train set only) or <code>predict = "both"</code> (for predictions on both train and test sets) in <code><a href="../../reference/makeResampleDesc.html">makeResampleDesc()</a></code>. In any case, this is necessary for some bootstrap methods (<em>b632</em> and <em>b632+</em>) and some examples are shown later on.</p>
<p>Below, we use simple Holdout, i.e., split the data once into a training and test set, as resampling strategy and make predictions on both sets.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="co"># Make predictions on both training and test sets</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2">rdesc =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"Holdout"</span>, <span class="dt">predict =</span> <span class="st">"both"</span>)</a>
<a class="sourceLine" id="cb12-3" data-line-number="3"></a>
<a class="sourceLine" id="cb12-4" data-line-number="4">r =<span class="st"> </span><span class="kw"><a href="../../reference/resample.html">resample</a></span>(<span class="st">"classif.lda"</span>, iris.task, rdesc, <span class="dt">show.info =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb12-5" data-line-number="5">r</a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="co">## Resample Result</span></a>
<a class="sourceLine" id="cb12-7" data-line-number="7"><span class="co">## Task: iris-example</span></a>
<a class="sourceLine" id="cb12-8" data-line-number="8"><span class="co">## Learner: classif.lda</span></a>
<a class="sourceLine" id="cb12-9" data-line-number="9"><span class="co">## Aggr perf: mmce.test.mean=0.0200000</span></a>
<a class="sourceLine" id="cb12-10" data-line-number="10"><span class="co">## Runtime: 0.00993848</span></a>
<a class="sourceLine" id="cb12-11" data-line-number="11"></a>
<a class="sourceLine" id="cb12-12" data-line-number="12">r<span class="op">$</span>measures.train</a>
<a class="sourceLine" id="cb12-13" data-line-number="13"><span class="co">##   iter mmce</span></a>
<a class="sourceLine" id="cb12-14" data-line-number="14"><span class="co">## 1    1 0.02</span></a></code></pre></div>
<p>(Please note that nonetheless the misclassification rate <code>r$aggr</code> is estimated on the test data only. How to calculate performance measures on the training sets is shown below.)</p>
<p>A second function to extract predictions from resample results is <code><a href="../../reference/getRRPredictionList.html">getRRPredictionList()</a></code> which returns a <code>list</code> of predictions split by data set (train/test) and resampling iteration.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">predList =<span class="st"> </span><span class="kw"><a href="../../reference/getRRPredictionList.html">getRRPredictionList</a></span>(r)</a>
<a class="sourceLine" id="cb13-2" data-line-number="2">predList</a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="co">## $train</span></a>
<a class="sourceLine" id="cb13-4" data-line-number="4"><span class="co">## $train$`1`</span></a>
<a class="sourceLine" id="cb13-5" data-line-number="5"><span class="co">## Prediction: 100 observations</span></a>
<a class="sourceLine" id="cb13-6" data-line-number="6"><span class="co">## predict.type: response</span></a>
<a class="sourceLine" id="cb13-7" data-line-number="7"><span class="co">## threshold: </span></a>
<a class="sourceLine" id="cb13-8" data-line-number="8"><span class="co">## time: 0.00</span></a>
<a class="sourceLine" id="cb13-9" data-line-number="9"><span class="co">##      id      truth   response</span></a>
<a class="sourceLine" id="cb13-10" data-line-number="10"><span class="co">## 96   96 versicolor versicolor</span></a>
<a class="sourceLine" id="cb13-11" data-line-number="11"><span class="co">## 130 130  virginica  virginica</span></a>
<a class="sourceLine" id="cb13-12" data-line-number="12"><span class="co">## 120 120  virginica  virginica</span></a>
<a class="sourceLine" id="cb13-13" data-line-number="13"><span class="co">## 77   77 versicolor versicolor</span></a>
<a class="sourceLine" id="cb13-14" data-line-number="14"><span class="co">## 23   23     setosa     setosa</span></a>
<a class="sourceLine" id="cb13-15" data-line-number="15"><span class="co">## 59   59 versicolor versicolor</span></a>
<a class="sourceLine" id="cb13-16" data-line-number="16"><span class="co">## ... (#rows: 100, #cols: 3)</span></a>
<a class="sourceLine" id="cb13-17" data-line-number="17"><span class="co">## </span></a>
<a class="sourceLine" id="cb13-18" data-line-number="18"><span class="co">## </span></a>
<a class="sourceLine" id="cb13-19" data-line-number="19"><span class="co">## $test</span></a>
<a class="sourceLine" id="cb13-20" data-line-number="20"><span class="co">## $test$`1`</span></a>
<a class="sourceLine" id="cb13-21" data-line-number="21"><span class="co">## Prediction: 50 observations</span></a>
<a class="sourceLine" id="cb13-22" data-line-number="22"><span class="co">## predict.type: response</span></a>
<a class="sourceLine" id="cb13-23" data-line-number="23"><span class="co">## threshold: </span></a>
<a class="sourceLine" id="cb13-24" data-line-number="24"><span class="co">## time: 0.00</span></a>
<a class="sourceLine" id="cb13-25" data-line-number="25"><span class="co">##      id      truth   response</span></a>
<a class="sourceLine" id="cb13-26" data-line-number="26"><span class="co">## 92   92 versicolor versicolor</span></a>
<a class="sourceLine" id="cb13-27" data-line-number="27"><span class="co">## 58   58 versicolor versicolor</span></a>
<a class="sourceLine" id="cb13-28" data-line-number="28"><span class="co">## 48   48     setosa     setosa</span></a>
<a class="sourceLine" id="cb13-29" data-line-number="29"><span class="co">## 103 103  virginica  virginica</span></a>
<a class="sourceLine" id="cb13-30" data-line-number="30"><span class="co">## 70   70 versicolor versicolor</span></a>
<a class="sourceLine" id="cb13-31" data-line-number="31"><span class="co">## 82   82 versicolor versicolor</span></a>
<a class="sourceLine" id="cb13-32" data-line-number="32"><span class="co">## ... (#rows: 50, #cols: 3)</span></a></code></pre></div>
</div>
<div id="learner-models" class="section level3">
<h3 class="hasAnchor">
<a href="#learner-models" class="anchor"></a>Learner models</h3>
<p>In each resampling iteration a Learner (<code><a href="../../reference/makeLearner.html">makeLearner()</a></code>) is fitted on the respective training set. By default, the resulting <code>WrappedModel</code> (<code><a href="../../reference/makeWrappedModel.html">makeWrappedModel()</a></code>)s are not included in the <code><a href="../../reference/resample.html">resample()</a></code> result and slot <code>$models</code> is empty. In order to keep them, set <code>models = TRUE</code> when calling <code><a href="../../reference/resample.html">resample()</a></code>, as in the following survival analysis example.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="co"># 3-fold cross-validation</span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2">rdesc =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"CV"</span>, <span class="dt">iters =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb14-3" data-line-number="3"></a>
<a class="sourceLine" id="cb14-4" data-line-number="4">r =<span class="st"> </span><span class="kw"><a href="../../reference/resample.html">resample</a></span>(<span class="st">"surv.coxph"</span>, lung.task, rdesc, <span class="dt">show.info =</span> <span class="ot">FALSE</span>, <span class="dt">models =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb14-5" data-line-number="5">r<span class="op">$</span>models</a>
<a class="sourceLine" id="cb14-6" data-line-number="6"><span class="co">## [[1]]</span></a>
<a class="sourceLine" id="cb14-7" data-line-number="7"><span class="co">## Model for learner.id=surv.coxph; learner.class=surv.coxph</span></a>
<a class="sourceLine" id="cb14-8" data-line-number="8"><span class="co">## Trained on: task.id = lung-example; obs = 111; features = 8</span></a>
<a class="sourceLine" id="cb14-9" data-line-number="9"><span class="co">## Hyperparameters: </span></a>
<a class="sourceLine" id="cb14-10" data-line-number="10"><span class="co">## </span></a>
<a class="sourceLine" id="cb14-11" data-line-number="11"><span class="co">## [[2]]</span></a>
<a class="sourceLine" id="cb14-12" data-line-number="12"><span class="co">## Model for learner.id=surv.coxph; learner.class=surv.coxph</span></a>
<a class="sourceLine" id="cb14-13" data-line-number="13"><span class="co">## Trained on: task.id = lung-example; obs = 111; features = 8</span></a>
<a class="sourceLine" id="cb14-14" data-line-number="14"><span class="co">## Hyperparameters: </span></a>
<a class="sourceLine" id="cb14-15" data-line-number="15"><span class="co">## </span></a>
<a class="sourceLine" id="cb14-16" data-line-number="16"><span class="co">## [[3]]</span></a>
<a class="sourceLine" id="cb14-17" data-line-number="17"><span class="co">## Model for learner.id=surv.coxph; learner.class=surv.coxph</span></a>
<a class="sourceLine" id="cb14-18" data-line-number="18"><span class="co">## Trained on: task.id = lung-example; obs = 112; features = 8</span></a>
<a class="sourceLine" id="cb14-19" data-line-number="19"><span class="co">## Hyperparameters:</span></a></code></pre></div>
</div>
<div id="the-extract-option" class="section level3">
<h3 class="hasAnchor">
<a href="#the-extract-option" class="anchor"></a>The extract option</h3>
<p>Keeping complete fitted models can be memory-intensive if these objects are large or the number of resampling iterations is high. Alternatively, you can use the <code>extract</code> argument of <code><a href="../../reference/resample.html">resample()</a></code> to retain only the information you need. To this end you need to pass a function to <code>extract</code> which is applied to each <code>WrappedModel</code> (<code><a href="../../reference/makeWrappedModel.html">makeWrappedModel()</a></code>) object fitted in each resampling iteration.</p>
<p>Below, we cluster the <code><a href="http://www.rdocumentation.org/packages/datasets/topics/mtcars">datasets::mtcars()</a></code> data using the <span class="math inline">\(k\)</span>-means algorithm with <span class="math inline">\(k = 3\)</span> and keep only the cluster centers.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="co"># 3-fold cross-validation</span></a>
<a class="sourceLine" id="cb15-2" data-line-number="2">rdesc =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"CV"</span>, <span class="dt">iters =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb15-3" data-line-number="3"></a>
<a class="sourceLine" id="cb15-4" data-line-number="4"><span class="co"># Extract the compute cluster centers</span></a>
<a class="sourceLine" id="cb15-5" data-line-number="5">r =<span class="st"> </span><span class="kw"><a href="../../reference/resample.html">resample</a></span>(<span class="st">"cluster.kmeans"</span>, mtcars.task, rdesc, <span class="dt">show.info =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb15-6" data-line-number="6">  <span class="dt">centers =</span> <span class="dv">3</span>, <span class="dt">extract =</span> <span class="cf">function</span>(x) <span class="kw"><a href="../../reference/getLearnerModel.html">getLearnerModel</a></span>(x)<span class="op">$</span>centers)</a>
<a class="sourceLine" id="cb15-7" data-line-number="7"><span class="co">## Warning in rgl.init(initValue, onlyNULL): RGL: unable to open X11 display</span></a>
<a class="sourceLine" id="cb15-8" data-line-number="8"><span class="co">## Warning: 'rgl_init' failed, running with rgl.useNULL = TRUE</span></a>
<a class="sourceLine" id="cb15-9" data-line-number="9">r<span class="op">$</span>extract</a>
<a class="sourceLine" id="cb15-10" data-line-number="10"><span class="co">## [[1]]</span></a>
<a class="sourceLine" id="cb15-11" data-line-number="11"><span class="co">##        mpg      cyl      disp    hp     drat       wt     qsec        vs</span></a>
<a class="sourceLine" id="cb15-12" data-line-number="12"><span class="co">## 1 26.96667 4.000000  99.08333  89.5 4.076667 2.087167 18.26833 0.8333333</span></a>
<a class="sourceLine" id="cb15-13" data-line-number="13"><span class="co">## 2 20.61429 5.428571 166.81429 104.0 3.715714 3.167857 19.11429 0.7142857</span></a>
<a class="sourceLine" id="cb15-14" data-line-number="14"><span class="co">## 3 15.26667 8.000000 356.64444 216.0 3.251111 3.956556 16.55556 0.0000000</span></a>
<a class="sourceLine" id="cb15-15" data-line-number="15"><span class="co">##          am     gear     carb</span></a>
<a class="sourceLine" id="cb15-16" data-line-number="16"><span class="co">## 1 1.0000000 4.333333 1.500000</span></a>
<a class="sourceLine" id="cb15-17" data-line-number="17"><span class="co">## 2 0.2857143 3.857143 3.000000</span></a>
<a class="sourceLine" id="cb15-18" data-line-number="18"><span class="co">## 3 0.2222222 3.444444 3.666667</span></a>
<a class="sourceLine" id="cb15-19" data-line-number="19"><span class="co">## </span></a>
<a class="sourceLine" id="cb15-20" data-line-number="20"><span class="co">## [[2]]</span></a>
<a class="sourceLine" id="cb15-21" data-line-number="21"><span class="co">##        mpg      cyl     disp       hp   drat       wt     qsec        vs</span></a>
<a class="sourceLine" id="cb15-22" data-line-number="22"><span class="co">## 1 15.03750 8.000000 351.1750 205.0000 3.1825 4.128125 17.08375 0.0000000</span></a>
<a class="sourceLine" id="cb15-23" data-line-number="23"><span class="co">## 2 21.22222 5.111111 157.6889 110.1111 3.7600 2.945000 18.75889 0.6666667</span></a>
<a class="sourceLine" id="cb15-24" data-line-number="24"><span class="co">## 3 31.00000 4.000000  76.1250  62.2500 4.3275 1.896250 19.19750 1.0000000</span></a>
<a class="sourceLine" id="cb15-25" data-line-number="25"><span class="co">##          am     gear     carb</span></a>
<a class="sourceLine" id="cb15-26" data-line-number="26"><span class="co">## 1 0.0000000 3.000000 3.375000</span></a>
<a class="sourceLine" id="cb15-27" data-line-number="27"><span class="co">## 2 0.4444444 3.888889 2.888889</span></a>
<a class="sourceLine" id="cb15-28" data-line-number="28"><span class="co">## 3 1.0000000 4.000000 1.250000</span></a>
<a class="sourceLine" id="cb15-29" data-line-number="29"><span class="co">## </span></a>
<a class="sourceLine" id="cb15-30" data-line-number="30"><span class="co">## [[3]]</span></a>
<a class="sourceLine" id="cb15-31" data-line-number="31"><span class="co">##        mpg      cyl     disp       hp     drat       wt     qsec        vs</span></a>
<a class="sourceLine" id="cb15-32" data-line-number="32"><span class="co">## 1 14.68571 8.000000 384.8571 230.5714 3.378571 4.077000 16.34000 0.0000000</span></a>
<a class="sourceLine" id="cb15-33" data-line-number="33"><span class="co">## 2 25.30000 4.500000 113.8125 101.2500 4.037500 2.307875 18.00125 0.7500000</span></a>
<a class="sourceLine" id="cb15-34" data-line-number="34"><span class="co">## 3 16.96667 7.333333 276.1000 145.8333 2.981667 3.580000 18.20500 0.3333333</span></a>
<a class="sourceLine" id="cb15-35" data-line-number="35"><span class="co">##          am     gear  carb</span></a>
<a class="sourceLine" id="cb15-36" data-line-number="36"><span class="co">## 1 0.2857143 3.571429 4.000</span></a>
<a class="sourceLine" id="cb15-37" data-line-number="37"><span class="co">## 2 0.7500000 4.250000 2.375</span></a>
<a class="sourceLine" id="cb15-38" data-line-number="38"><span class="co">## 3 0.0000000 3.000000 2.000</span></a></code></pre></div>
<p>As a second example, we extract the variable importances from fitted regression trees using function <code><a href="../../reference/getFeatureImportance.html">getFeatureImportance()</a></code>. (For more detailed information on this topic see the <a href="feature_selection.html" target="_blank">feature selection</a> page.)</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="co"># Extract the variable importance in a regression tree</span></a>
<a class="sourceLine" id="cb16-2" data-line-number="2">r =<span class="st"> </span><span class="kw"><a href="../../reference/resample.html">resample</a></span>(<span class="st">"regr.rpart"</span>, bh.task, rdesc, <span class="dt">show.info =</span> <span class="ot">FALSE</span>, <span class="dt">extract =</span> getFeatureImportance)</a>
<a class="sourceLine" id="cb16-3" data-line-number="3">r<span class="op">$</span>extract</a>
<a class="sourceLine" id="cb16-4" data-line-number="4"><span class="co">## [[1]]</span></a>
<a class="sourceLine" id="cb16-5" data-line-number="5"><span class="co">## FeatureImportance:</span></a>
<a class="sourceLine" id="cb16-6" data-line-number="6"><span class="co">## Task: BostonHousing-example</span></a>
<a class="sourceLine" id="cb16-7" data-line-number="7"><span class="co">## </span></a>
<a class="sourceLine" id="cb16-8" data-line-number="8"><span class="co">## Learner: regr.rpart</span></a>
<a class="sourceLine" id="cb16-9" data-line-number="9"><span class="co">## Measure: NA</span></a>
<a class="sourceLine" id="cb16-10" data-line-number="10"><span class="co">## Contrast: NA</span></a>
<a class="sourceLine" id="cb16-11" data-line-number="11"><span class="co">## Aggregation: function (x)  x</span></a>
<a class="sourceLine" id="cb16-12" data-line-number="12"><span class="co">## Replace: NA</span></a>
<a class="sourceLine" id="cb16-13" data-line-number="13"><span class="co">## Number of Monte-Carlo iterations: NA</span></a>
<a class="sourceLine" id="cb16-14" data-line-number="14"><span class="co">## Local: FALSE</span></a>
<a class="sourceLine" id="cb16-15" data-line-number="15"><span class="co">##      crim       zn    indus chas      nox       rm      age      dis rad</span></a>
<a class="sourceLine" id="cb16-16" data-line-number="16"><span class="co">## 1 2689.63 867.4877 3719.711    0 2103.622 16096.32 2574.183 3647.211   0</span></a>
<a class="sourceLine" id="cb16-17" data-line-number="17"><span class="co">##        tax  ptratio       b    lstat</span></a>
<a class="sourceLine" id="cb16-18" data-line-number="18"><span class="co">## 1 1972.207 3712.621 395.486 8608.757</span></a>
<a class="sourceLine" id="cb16-19" data-line-number="19"><span class="co">## </span></a>
<a class="sourceLine" id="cb16-20" data-line-number="20"><span class="co">## [[2]]</span></a>
<a class="sourceLine" id="cb16-21" data-line-number="21"><span class="co">## FeatureImportance:</span></a>
<a class="sourceLine" id="cb16-22" data-line-number="22"><span class="co">## Task: BostonHousing-example</span></a>
<a class="sourceLine" id="cb16-23" data-line-number="23"><span class="co">## </span></a>
<a class="sourceLine" id="cb16-24" data-line-number="24"><span class="co">## Learner: regr.rpart</span></a>
<a class="sourceLine" id="cb16-25" data-line-number="25"><span class="co">## Measure: NA</span></a>
<a class="sourceLine" id="cb16-26" data-line-number="26"><span class="co">## Contrast: NA</span></a>
<a class="sourceLine" id="cb16-27" data-line-number="27"><span class="co">## Aggregation: function (x)  x</span></a>
<a class="sourceLine" id="cb16-28" data-line-number="28"><span class="co">## Replace: NA</span></a>
<a class="sourceLine" id="cb16-29" data-line-number="29"><span class="co">## Number of Monte-Carlo iterations: NA</span></a>
<a class="sourceLine" id="cb16-30" data-line-number="30"><span class="co">## Local: FALSE</span></a>
<a class="sourceLine" id="cb16-31" data-line-number="31"><span class="co">##       crim       zn  indus chas      nox       rm      age     dis</span></a>
<a class="sourceLine" id="cb16-32" data-line-number="32"><span class="co">## 1 7491.707 5423.593 7295.2    0 7348.742 14014.78 1391.373 2309.92</span></a>
<a class="sourceLine" id="cb16-33" data-line-number="33"><span class="co">##        rad      tax  ptratio b    lstat</span></a>
<a class="sourceLine" id="cb16-34" data-line-number="34"><span class="co">## 1 340.3975 1871.451 938.0743 0 17618.49</span></a>
<a class="sourceLine" id="cb16-35" data-line-number="35"><span class="co">## </span></a>
<a class="sourceLine" id="cb16-36" data-line-number="36"><span class="co">## [[3]]</span></a>
<a class="sourceLine" id="cb16-37" data-line-number="37"><span class="co">## FeatureImportance:</span></a>
<a class="sourceLine" id="cb16-38" data-line-number="38"><span class="co">## Task: BostonHousing-example</span></a>
<a class="sourceLine" id="cb16-39" data-line-number="39"><span class="co">## </span></a>
<a class="sourceLine" id="cb16-40" data-line-number="40"><span class="co">## Learner: regr.rpart</span></a>
<a class="sourceLine" id="cb16-41" data-line-number="41"><span class="co">## Measure: NA</span></a>
<a class="sourceLine" id="cb16-42" data-line-number="42"><span class="co">## Contrast: NA</span></a>
<a class="sourceLine" id="cb16-43" data-line-number="43"><span class="co">## Aggregation: function (x)  x</span></a>
<a class="sourceLine" id="cb16-44" data-line-number="44"><span class="co">## Replace: NA</span></a>
<a class="sourceLine" id="cb16-45" data-line-number="45"><span class="co">## Number of Monte-Carlo iterations: NA</span></a>
<a class="sourceLine" id="cb16-46" data-line-number="46"><span class="co">## Local: FALSE</span></a>
<a class="sourceLine" id="cb16-47" data-line-number="47"><span class="co">##       crim       zn    indus chas     nox       rm     age      dis</span></a>
<a class="sourceLine" id="cb16-48" data-line-number="48"><span class="co">## 1 2532.084 4637.312 6150.854    0 6015.01 11330.75 6843.29 2049.772</span></a>
<a class="sourceLine" id="cb16-49" data-line-number="49"><span class="co">##        rad      tax  ptratio        b    lstat</span></a>
<a class="sourceLine" id="cb16-50" data-line-number="50"><span class="co">## 1 525.3815 747.8954 1925.899 62.58285 17336.77</span></a></code></pre></div>
<p>There is also an convenience function <code><a href="../../reference/getResamplingIndices.html">getResamplingIndices()</a></code> to extract the resampling indices from the <code>ResampleResult</code> object:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="kw"><a href="../../reference/getResamplingIndices.html">getResamplingIndices</a></span>(r)</a>
<a class="sourceLine" id="cb17-2" data-line-number="2"><span class="co">## $train.inds</span></a>
<a class="sourceLine" id="cb17-3" data-line-number="3"><span class="co">## $train.inds[[1]]</span></a>
<a class="sourceLine" id="cb17-4" data-line-number="4"><span class="co">##   [1] 476 219 259  73  29 324  13 411 363 357 299 303 275 247 125 139  92</span></a>
<a class="sourceLine" id="cb17-5" data-line-number="5"><span class="co">##  [18] 487   6  70 243 328 473 448 449 322 346 472  97 315  46 232 351 479</span></a>
<a class="sourceLine" id="cb17-6" data-line-number="6"><span class="co">##  [35]  74  51 369 289 114 320 258  65 176 262 138 160 412 501 260 111 283</span></a>
<a class="sourceLine" id="cb17-7" data-line-number="7"><span class="co">##  [52] 444 209  12 166 108 475 492 124 132 187 185 257 424 361 141 280 374</span></a>
<a class="sourceLine" id="cb17-8" data-line-number="8"><span class="co">##  [69] 350 495 425 504 352 427  19 106  80 474 338 333   8 250 296 144 122</span></a>
<a class="sourceLine" id="cb17-9" data-line-number="9"><span class="co">##  [86] 142 210 226 268 364 477  31 214 309 286 215 370 372 120  64 445 199</span></a>
<a class="sourceLine" id="cb17-10" data-line-number="10"><span class="co">## [103] 503 330 113 271  75 103 323 193 249 230 385 344 336 127 392 441  54</span></a>
<a class="sourceLine" id="cb17-11" data-line-number="11"><span class="co">## [120]  39 242 151 310 263 238 137 112  62 183 191 368 386 229 130 397  49</span></a>
<a class="sourceLine" id="cb17-12" data-line-number="12"><span class="co">## [137] 184  69  14 269 255 505 365 213 102 150 126 483 399  82  60  66 152</span></a>
<a class="sourceLine" id="cb17-13" data-line-number="13"><span class="co">## [154]  76 162 465 192 462 307 329 288  45 197 439  17 327 499  22 377 434</span></a>
<a class="sourceLine" id="cb17-14" data-line-number="14"><span class="co">## [171]  15 360  48 451 332 221  55 356  36 494 165 486 458 387 409 101 295</span></a>
<a class="sourceLine" id="cb17-15" data-line-number="15"><span class="co">## [188] 456 196  43 484 198 491  77 235 316 395 135  91 353   2 371 394 140</span></a>
<a class="sourceLine" id="cb17-16" data-line-number="16"><span class="co">## [205] 452 282 153  56 415 313 147 146 500 467 182 181 349 294 100 159 342</span></a>
<a class="sourceLine" id="cb17-17" data-line-number="17"><span class="co">## [222]  18 317  71 291  94 239 410 461 432 123  37 240 256 149 373 225  59</span></a>
<a class="sourceLine" id="cb17-18" data-line-number="18"><span class="co">## [239] 231 482 388 382 402 442  20 121 164 105 455 281 211 318   3  86 480</span></a>
<a class="sourceLine" id="cb17-19" data-line-number="19"><span class="co">## [256] 218 265 115 228 206 212 208 345 116 180 190 202 155 148 297 339 252</span></a>
<a class="sourceLine" id="cb17-20" data-line-number="20"><span class="co">## [273] 416 293 391  26 274  28 279 378 433 403  33 207 319 117 419 145 358</span></a>
<a class="sourceLine" id="cb17-21" data-line-number="21"><span class="co">## [290] 335 340 331  47 366 334 220  25 128 408  95 178 285 261  79 251 237</span></a>
<a class="sourceLine" id="cb17-22" data-line-number="22"><span class="co">## [307] 362 167  84 308 478 421  27 367 236  50 201 406  16 471  72 312 389</span></a>
<a class="sourceLine" id="cb17-23" data-line-number="23"><span class="co">## [324]  57 179 203 305 423 341 267 246 453 354 485 438 321 173</span></a>
<a class="sourceLine" id="cb17-24" data-line-number="24"><span class="co">## </span></a>
<a class="sourceLine" id="cb17-25" data-line-number="25"><span class="co">## $train.inds[[2]]</span></a>
<a class="sourceLine" id="cb17-26" data-line-number="26"><span class="co">##   [1]   4 219 420 241  29 324 186  13  38 363  24 357   7 109 303 247 125</span></a>
<a class="sourceLine" id="cb17-27" data-line-number="27"><span class="co">##  [18] 174 139 222 248 328 346 472  97 315  46 232 351 369 172 289 348 114</span></a>
<a class="sourceLine" id="cb17-28" data-line-number="28"><span class="co">##  [35] 170 154 258  65 134 234 160 171 204  78 209 404  12 108 475  30 278</span></a>
<a class="sourceLine" id="cb17-29" data-line-number="29"><span class="co">##  [52] 492 187 418 257 424 361 141 280 374 504 156 469 436 325  19 106 474</span></a>
<a class="sourceLine" id="cb17-30" data-line-number="30"><span class="co">##  [69] 338 333 430 296 200 417 254 157 343 364 161 477  68 214 309 286 370</span></a>
<a class="sourceLine" id="cb17-31" data-line-number="31"><span class="co">##  [86]  64 489 503 264  93 113  75 103  61  52 446 193 355 249 230  99 344</span></a>
<a class="sourceLine" id="cb17-32" data-line-number="32"><span class="co">## [103] 336  10 502 127 490 441  54  39 242 151   9 310 263 390  44 272 238</span></a>
<a class="sourceLine" id="cb17-33" data-line-number="33"><span class="co">## [120]  58 506 112 481 368 386  89 229 194  53 397  49 184  14 284 188 505</span></a>
<a class="sourceLine" id="cb17-34" data-line-number="34"><span class="co">## [137] 244 365 213 102 150 233  90 399  82  66 152 463 169 398 465 401 307</span></a>
<a class="sourceLine" id="cb17-35" data-line-number="35"><span class="co">## [154] 327 110 443 454  22 359 384 377 434 407 216  40 277 360  34 437 129</span></a>
<a class="sourceLine" id="cb17-36" data-line-number="36"><span class="co">## [171] 221 314 498  55  36 494 175 387 253 409 104 337 413 431 298 493 196</span></a>
<a class="sourceLine" id="cb17-37" data-line-number="37"><span class="co">## [188] 301  43 484 198 276 383 143 135  32 304  83 496   2 422 394 468 452</span></a>
<a class="sourceLine" id="cb17-38" data-line-number="38"><span class="co">## [205] 153 415 133  23 466 467 181 349 294 100 470 159 292  35 376 302 410</span></a>
<a class="sourceLine" id="cb17-39" data-line-number="39"><span class="co">## [222]  41  88 440 123  37 375 393 118 373 225  81 306 388 266 382 402 442</span></a>
<a class="sourceLine" id="cb17-40" data-line-number="40"><span class="co">## [239] 131 287 164 396 119 273 281 195  98 211   3 426 223 447 400 405 265</span></a>
<a class="sourceLine" id="cb17-41" data-line-number="41"><span class="co">## [256] 115 459 228 163 206 290 345 116 180 202 155 297 379  67 460  63  11</span></a>
<a class="sourceLine" id="cb17-42" data-line-number="42"><span class="co">## [273] 252 416 227  26 274   1 450 177  87 245 435 428 347  33 207 429 117</span></a>
<a class="sourceLine" id="cb17-43" data-line-number="43"><span class="co">## [290]  42 335 340 217 326 488  21 408 300 224 285 251 362 457  84 478 421</span></a>
<a class="sourceLine" id="cb17-44" data-line-number="44"><span class="co">## [307] 136 311  27 236 406  96 270 471  72 389 414  57 179 205 168 305 341</span></a>
<a class="sourceLine" id="cb17-45" data-line-number="45"><span class="co">## [324] 464 267 246 381 453 380 189 485  85 107 497 438 173   5 158</span></a>
<a class="sourceLine" id="cb17-46" data-line-number="46"><span class="co">## </span></a>
<a class="sourceLine" id="cb17-47" data-line-number="47"><span class="co">## $train.inds[[3]]</span></a>
<a class="sourceLine" id="cb17-48" data-line-number="48"><span class="co">##   [1]   4 476 420 259 241  73 186  38 411  24   7 299 109 275 174  92 487</span></a>
<a class="sourceLine" id="cb17-49" data-line-number="49"><span class="co">##  [18]   6  70 243 222 248 473 448 449 322 479  74  51 172 348 170 154 320</span></a>
<a class="sourceLine" id="cb17-50" data-line-number="50"><span class="co">##  [35] 134 176 234 262 138 412 501 260 111 171 283 444 204  78 404 166  30</span></a>
<a class="sourceLine" id="cb17-51" data-line-number="51"><span class="co">##  [52] 278 124 132 185 418 350 495 425 156 469 352 427 436 325  80 430   8</span></a>
<a class="sourceLine" id="cb17-52" data-line-number="52"><span class="co">##  [69] 250 200 144 122 417 142 210 254 157 226 268 343 161  68  31 215 372</span></a>
<a class="sourceLine" id="cb17-53" data-line-number="53"><span class="co">##  [86] 120 445 199 489 330 264  93 271 323  61  52 446 355 385  99  10 502</span></a>
<a class="sourceLine" id="cb17-54" data-line-number="54"><span class="co">## [103] 392 490   9 390  44 272 137  58 506  62 183 191 481  89 194 130  53</span></a>
<a class="sourceLine" id="cb17-55" data-line-number="55"><span class="co">## [120]  69 284 269 255 188 244 233 126 483  90  60 463 169  76 398 162 192</span></a>
<a class="sourceLine" id="cb17-56" data-line-number="56"><span class="co">## [137] 462 401 329 288  45 197 439  17 499 110 443 454 359 384 407 216  15</span></a>
<a class="sourceLine" id="cb17-57" data-line-number="57"><span class="co">## [154]  40 277  48  34 451 437 129 332 314 498 356 165 486 175 458 253 104</span></a>
<a class="sourceLine" id="cb17-58" data-line-number="58"><span class="co">## [171] 337 413 431 298 101 295 493 456 301 491  77 235 316 276 383 395 143</span></a>
<a class="sourceLine" id="cb17-59" data-line-number="59"><span class="co">## [188]  91  32 353 304  83 496 422 371 140 468 282  56 313 147 133 146  23</span></a>
<a class="sourceLine" id="cb17-60" data-line-number="60"><span class="co">## [205] 466 500 182 470 342  18 317 292  71  35 376 291  94 239 302 461  41</span></a>
<a class="sourceLine" id="cb17-61" data-line-number="61"><span class="co">## [222]  88 432 440 375 393 240 256 118 149  59 231 482  81 306 266 131  20</span></a>
<a class="sourceLine" id="cb17-62" data-line-number="62"><span class="co">## [239] 121 287 105 396 455 119 273 195  98 318  86 480 426 223 447 218 400</span></a>
<a class="sourceLine" id="cb17-63" data-line-number="63"><span class="co">## [256] 405 459 163 290 212 208 190 148 379  67 460 339  63  11 227 293 391</span></a>
<a class="sourceLine" id="cb17-64" data-line-number="64"><span class="co">## [273]   1  28 450 177  87 245 435 279 428 378 347 433 403 319 429  42 419</span></a>
<a class="sourceLine" id="cb17-65" data-line-number="65"><span class="co">## [290] 145 358 217 331  47 366 326 334 220 488  21  25 128 300  95 178 224</span></a>
<a class="sourceLine" id="cb17-66" data-line-number="66"><span class="co">## [307] 261  79 237 457 167 308 136 311 367  50 201  16  96 270 312 414 205</span></a>
<a class="sourceLine" id="cb17-67" data-line-number="67"><span class="co">## [324] 168 203 423 464 381 354 380 189  85 107 497 321   5 158</span></a>
<a class="sourceLine" id="cb17-68" data-line-number="68"><span class="co">## </span></a>
<a class="sourceLine" id="cb17-69" data-line-number="69"><span class="co">## </span></a>
<a class="sourceLine" id="cb17-70" data-line-number="70"><span class="co">## $test.inds</span></a>
<a class="sourceLine" id="cb17-71" data-line-number="71"><span class="co">## $test.inds[[1]]</span></a>
<a class="sourceLine" id="cb17-72" data-line-number="72"><span class="co">##   [1]   1   4   5   7   9  10  11  21  23  24  30  32  34  35  38  40  41</span></a>
<a class="sourceLine" id="cb17-73" data-line-number="73"><span class="co">##  [18]  42  44  52  53  58  61  63  67  68  78  81  83  85  87  88  89  90</span></a>
<a class="sourceLine" id="cb17-74" data-line-number="74"><span class="co">##  [35]  93  96  98  99 104 107 109 110 118 119 129 131 133 134 136 143 154</span></a>
<a class="sourceLine" id="cb17-75" data-line-number="75"><span class="co">##  [52] 156 157 158 161 163 168 169 170 171 172 174 175 177 186 188 189 194</span></a>
<a class="sourceLine" id="cb17-76" data-line-number="76"><span class="co">##  [69] 195 200 204 205 216 217 222 223 224 227 233 234 241 244 245 248 253</span></a>
<a class="sourceLine" id="cb17-77" data-line-number="77"><span class="co">##  [86] 254 264 266 270 272 273 276 277 278 284 287 290 292 298 300 301 302</span></a>
<a class="sourceLine" id="cb17-78" data-line-number="78"><span class="co">## [103] 304 306 311 314 325 326 337 343 347 348 355 359 375 376 379 380 381</span></a>
<a class="sourceLine" id="cb17-79" data-line-number="79"><span class="co">## [120] 383 384 390 393 396 398 400 401 404 405 407 413 414 417 418 420 422</span></a>
<a class="sourceLine" id="cb17-80" data-line-number="80"><span class="co">## [137] 426 428 429 430 431 435 436 437 440 443 446 447 450 454 457 459 460</span></a>
<a class="sourceLine" id="cb17-81" data-line-number="81"><span class="co">## [154] 463 464 466 468 469 470 481 488 489 490 493 496 497 498 502 506</span></a>
<a class="sourceLine" id="cb17-82" data-line-number="82"><span class="co">## </span></a>
<a class="sourceLine" id="cb17-83" data-line-number="83"><span class="co">## $test.inds[[2]]</span></a>
<a class="sourceLine" id="cb17-84" data-line-number="84"><span class="co">##   [1]   6   8  15  16  17  18  20  25  28  31  45  47  48  50  51  56  59</span></a>
<a class="sourceLine" id="cb17-85" data-line-number="85"><span class="co">##  [18]  60  62  69  70  71  73  74  76  77  79  80  86  91  92  94  95 101</span></a>
<a class="sourceLine" id="cb17-86" data-line-number="86"><span class="co">##  [35] 105 111 120 121 122 124 126 128 130 132 137 138 140 142 144 145 146</span></a>
<a class="sourceLine" id="cb17-87" data-line-number="87"><span class="co">##  [52] 147 148 149 162 165 166 167 176 178 182 183 185 190 191 192 197 199</span></a>
<a class="sourceLine" id="cb17-88" data-line-number="88"><span class="co">##  [69] 201 203 208 210 212 215 218 220 226 231 235 237 239 240 243 250 255</span></a>
<a class="sourceLine" id="cb17-89" data-line-number="89"><span class="co">##  [86] 256 259 260 261 262 268 269 271 275 279 282 283 288 291 293 295 299</span></a>
<a class="sourceLine" id="cb17-90" data-line-number="90"><span class="co">## [103] 308 312 313 316 317 318 319 320 321 322 323 329 330 331 332 334 339</span></a>
<a class="sourceLine" id="cb17-91" data-line-number="91"><span class="co">## [120] 342 350 352 353 354 356 358 366 367 371 372 378 385 391 392 395 403</span></a>
<a class="sourceLine" id="cb17-92" data-line-number="92"><span class="co">## [137] 411 412 419 423 425 427 432 433 439 444 445 448 449 451 455 456 458</span></a>
<a class="sourceLine" id="cb17-93" data-line-number="93"><span class="co">## [154] 461 462 473 476 479 480 482 483 486 487 491 495 499 500 501</span></a>
<a class="sourceLine" id="cb17-94" data-line-number="94"><span class="co">## </span></a>
<a class="sourceLine" id="cb17-95" data-line-number="95"><span class="co">## $test.inds[[3]]</span></a>
<a class="sourceLine" id="cb17-96" data-line-number="96"><span class="co">##   [1]   2   3  12  13  14  19  22  26  27  29  33  36  37  39  43  46  49</span></a>
<a class="sourceLine" id="cb17-97" data-line-number="97"><span class="co">##  [18]  54  55  57  64  65  66  72  75  82  84  97 100 102 103 106 108 112</span></a>
<a class="sourceLine" id="cb17-98" data-line-number="98"><span class="co">##  [35] 113 114 115 116 117 123 125 127 135 139 141 150 151 152 153 155 159</span></a>
<a class="sourceLine" id="cb17-99" data-line-number="99"><span class="co">##  [52] 160 164 173 179 180 181 184 187 193 196 198 202 206 207 209 211 213</span></a>
<a class="sourceLine" id="cb17-100" data-line-number="100"><span class="co">##  [69] 214 219 221 225 228 229 230 232 236 238 242 246 247 249 251 252 257</span></a>
<a class="sourceLine" id="cb17-101" data-line-number="101"><span class="co">##  [86] 258 263 265 267 274 280 281 285 286 289 294 296 297 303 305 307 309</span></a>
<a class="sourceLine" id="cb17-102" data-line-number="102"><span class="co">## [103] 310 315 324 327 328 333 335 336 338 340 341 344 345 346 349 351 357</span></a>
<a class="sourceLine" id="cb17-103" data-line-number="103"><span class="co">## [120] 360 361 362 363 364 365 368 369 370 373 374 377 382 386 387 388 389</span></a>
<a class="sourceLine" id="cb17-104" data-line-number="104"><span class="co">## [137] 394 397 399 402 406 408 409 410 415 416 421 424 434 438 441 442 452</span></a>
<a class="sourceLine" id="cb17-105" data-line-number="105"><span class="co">## [154] 453 465 467 471 472 474 475 477 478 484 485 492 494 503 504 505</span></a></code></pre></div>
</div>
</div>
<div id="stratification-blocking-and-grouping" class="section level2">
<h2 class="hasAnchor">
<a href="#stratification-blocking-and-grouping" class="anchor"></a>Stratification, Blocking and Grouping</h2>
<ul>
<li><p><em>Stratification</em> with respect to a categorical variable makes sure that all its values are present in each training and test set in approximately the same proportion as in the original data set. Stratification is possible with regard to categorical target variables (and thus for supervised classification and survival analysis) or categorical explanatory variables.</p></li>
<li><p><em>Blocking</em> refers to the situation that subsets of observations belong together and must not be separated during resampling. Hence, for one train/test set pair the entire block is either in the training set or in the test set.</p></li>
<li><p><em>Grouping</em> means that the folds are composed out of a factor vector given by the user. In this setting no repetitions are possible as all folds are predefined. The approach can also be used in a nested resampling setting. Note the subtle but important difference to “Blocking”: In “Blocking” factor levels are respected when splitting into train and test (e.g. the test set could be composed out of two given factor levels) whereas in “Grouping” the folds will strictly follow the factor level grouping (meaning that the test set will always only consist of one factor level).</p></li>
</ul>
<div id="stratification-with-respect-to-the-target-variables" class="section level3">
<h3 class="hasAnchor">
<a href="#stratification-with-respect-to-the-target-variables" class="anchor"></a>Stratification with respect to the target variable(s)</h3>
<p>For classification, it is usually desirable to have the same proportion of the classes in all of the partitions of the original data set. This is particularly useful in the case of imbalanced classes and small data sets. Otherwise, it may happen that observations of less frequent classes are missing in some of the training sets which can decrease the performance of the learner, or lead to model crashes. In order to conduct stratified resampling, set <code>stratify = TRUE</code> in <code><a href="../../reference/makeResampleDesc.html">makeResampleDesc()</a></code>.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="co"># 3-fold cross-validation</span></a>
<a class="sourceLine" id="cb18-2" data-line-number="2">rdesc =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"CV"</span>, <span class="dt">iters =</span> <span class="dv">3</span>, <span class="dt">stratify =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb18-3" data-line-number="3"></a>
<a class="sourceLine" id="cb18-4" data-line-number="4">r =<span class="st"> </span><span class="kw"><a href="../../reference/resample.html">resample</a></span>(<span class="st">"classif.lda"</span>, iris.task, rdesc, <span class="dt">show.info =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb18-5" data-line-number="5">r</a>
<a class="sourceLine" id="cb18-6" data-line-number="6"><span class="co">## Resample Result</span></a>
<a class="sourceLine" id="cb18-7" data-line-number="7"><span class="co">## Task: iris-example</span></a>
<a class="sourceLine" id="cb18-8" data-line-number="8"><span class="co">## Learner: classif.lda</span></a>
<a class="sourceLine" id="cb18-9" data-line-number="9"><span class="co">## Aggr perf: mmce.test.mean=0.0200000</span></a>
<a class="sourceLine" id="cb18-10" data-line-number="10"><span class="co">## Runtime: 0.0176296</span></a></code></pre></div>
<p>Stratification is also available for survival tasks. Here the stratification balances the censoring rate.</p>
</div>
<div id="stratification-with-respect-to-explanatory-variables" class="section level3">
<h3 class="hasAnchor">
<a href="#stratification-with-respect-to-explanatory-variables" class="anchor"></a>Stratification with respect to explanatory variables</h3>
<p>Sometimes it is required to also stratify on the input data, e.g., to ensure that all subgroups are represented in all training and test sets. To stratify on the input columns, specify <code>factor</code> columns of your task data via <code>stratify.cols</code>.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1">rdesc =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"CV"</span>, <span class="dt">iters =</span> <span class="dv">3</span>, <span class="dt">stratify.cols =</span> <span class="st">"chas"</span>)</a>
<a class="sourceLine" id="cb19-2" data-line-number="2"></a>
<a class="sourceLine" id="cb19-3" data-line-number="3">r =<span class="st"> </span><span class="kw"><a href="../../reference/resample.html">resample</a></span>(<span class="st">"regr.rpart"</span>, bh.task, rdesc, <span class="dt">show.info =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb19-4" data-line-number="4">r</a>
<a class="sourceLine" id="cb19-5" data-line-number="5"><span class="co">## Resample Result</span></a>
<a class="sourceLine" id="cb19-6" data-line-number="6"><span class="co">## Task: BostonHousing-example</span></a>
<a class="sourceLine" id="cb19-7" data-line-number="7"><span class="co">## Learner: regr.rpart</span></a>
<a class="sourceLine" id="cb19-8" data-line-number="8"><span class="co">## Aggr perf: mse.test.mean=23.8843587</span></a>
<a class="sourceLine" id="cb19-9" data-line-number="9"><span class="co">## Runtime: 0.0268815</span></a></code></pre></div>
</div>
<div id="blocking-cv-with-flexible-predefined-indices" class="section level3">
<h3 class="hasAnchor">
<a href="#blocking-cv-with-flexible-predefined-indices" class="anchor"></a>Blocking: CV with flexible predefined indices</h3>
<p>If some observations “belong together” and must not be separated when splitting the data into training and test sets for resampling, you can supply this information via a <code>blocking</code> factor when creating the <a href="task.html" target="_blank">task</a>.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="co"># 5 blocks containing 30 observations each</span></a>
<a class="sourceLine" id="cb20-2" data-line-number="2">task =<span class="st"> </span><span class="kw"><a href="../../reference/Task.html">makeClassifTask</a></span>(<span class="dt">data =</span> iris, <span class="dt">target =</span> <span class="st">"Species"</span>, <span class="dt">blocking =</span> <span class="kw">factor</span>(<span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dt">each =</span> <span class="dv">30</span>)))</a>
<a class="sourceLine" id="cb20-3" data-line-number="3">task</a>
<a class="sourceLine" id="cb20-4" data-line-number="4"><span class="co">## Supervised task: iris</span></a>
<a class="sourceLine" id="cb20-5" data-line-number="5"><span class="co">## Type: classif</span></a>
<a class="sourceLine" id="cb20-6" data-line-number="6"><span class="co">## Target: Species</span></a>
<a class="sourceLine" id="cb20-7" data-line-number="7"><span class="co">## Observations: 150</span></a>
<a class="sourceLine" id="cb20-8" data-line-number="8"><span class="co">## Features:</span></a>
<a class="sourceLine" id="cb20-9" data-line-number="9"><span class="co">##    numerics     factors     ordered functionals </span></a>
<a class="sourceLine" id="cb20-10" data-line-number="10"><span class="co">##           4           0           0           0 </span></a>
<a class="sourceLine" id="cb20-11" data-line-number="11"><span class="co">## Missings: FALSE</span></a>
<a class="sourceLine" id="cb20-12" data-line-number="12"><span class="co">## Has weights: FALSE</span></a>
<a class="sourceLine" id="cb20-13" data-line-number="13"><span class="co">## Has blocking: TRUE</span></a>
<a class="sourceLine" id="cb20-14" data-line-number="14"><span class="co">## Has coordinates: FALSE</span></a>
<a class="sourceLine" id="cb20-15" data-line-number="15"><span class="co">## Classes: 3</span></a>
<a class="sourceLine" id="cb20-16" data-line-number="16"><span class="co">##     setosa versicolor  virginica </span></a>
<a class="sourceLine" id="cb20-17" data-line-number="17"><span class="co">##         50         50         50 </span></a>
<a class="sourceLine" id="cb20-18" data-line-number="18"><span class="co">## Positive class: NA</span></a></code></pre></div>
<p>When performing a simple “CV” resampling and inspecting the result, we see that the training indices in fold 1 correspond to the specified grouping set in <code>blocking</code> in the task. To initiate this method, we need to set <code>blocking.cv = TRUE</code> when creating the resample description object.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1">rdesc =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"CV"</span>, <span class="dt">iters =</span> <span class="dv">3</span>, <span class="dt">blocking.cv =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb21-2" data-line-number="2">p =<span class="st"> </span><span class="kw"><a href="../../reference/resample.html">resample</a></span>(<span class="st">"classif.lda"</span>, task, rdesc)</a>
<a class="sourceLine" id="cb21-3" data-line-number="3"><span class="co">## Resampling: cross-validation</span></a>
<a class="sourceLine" id="cb21-4" data-line-number="4"><span class="co">## Measures:             mmce</span></a>
<a class="sourceLine" id="cb21-5" data-line-number="5"><span class="co">## [Resample] iter 1:    0.0500000</span></a>
<a class="sourceLine" id="cb21-6" data-line-number="6"><span class="co">## [Resample] iter 2:    0.0500000</span></a>
<a class="sourceLine" id="cb21-7" data-line-number="7"><span class="co">## [Resample] iter 3:    0.0000000</span></a>
<a class="sourceLine" id="cb21-8" data-line-number="8"><span class="co">## </span></a>
<a class="sourceLine" id="cb21-9" data-line-number="9"><span class="co">## Aggregated Result: mmce.test.mean=0.0333333</span></a>
<a class="sourceLine" id="cb21-10" data-line-number="10"><span class="co">## </span></a>
<a class="sourceLine" id="cb21-11" data-line-number="11"></a>
<a class="sourceLine" id="cb21-12" data-line-number="12"><span class="kw">sort</span>(p<span class="op">$</span>pred<span class="op">$</span>instance<span class="op">$</span>train.inds[[<span class="dv">1</span>]])</a>
<a class="sourceLine" id="cb21-13" data-line-number="13"><span class="co">##  [1]   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17</span></a>
<a class="sourceLine" id="cb21-14" data-line-number="14"><span class="co">## [18]  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34</span></a>
<a class="sourceLine" id="cb21-15" data-line-number="15"><span class="co">## [35]  35  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51</span></a>
<a class="sourceLine" id="cb21-16" data-line-number="16"><span class="co">## [52]  52  53  54  55  56  57  58  59  60 121 122 123 124 125 126 127 128</span></a>
<a class="sourceLine" id="cb21-17" data-line-number="17"><span class="co">## [69] 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145</span></a>
<a class="sourceLine" id="cb21-18" data-line-number="18"><span class="co">## [86] 146 147 148 149 150</span></a></code></pre></div>
<p>However, please note the effects of this method: The created folds will not have the same size! Here, Fold 1 has a 120/30 split while the other two folds have a 90/60 split.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="kw">lapply</span>(p<span class="op">$</span>pred<span class="op">$</span>instance<span class="op">$</span>train.inds, <span class="cf">function</span>(x) <span class="kw">length</span>(x))</a>
<a class="sourceLine" id="cb22-2" data-line-number="2"><span class="co">## [[1]]</span></a>
<a class="sourceLine" id="cb22-3" data-line-number="3"><span class="co">## [1] 90</span></a>
<a class="sourceLine" id="cb22-4" data-line-number="4"><span class="co">## </span></a>
<a class="sourceLine" id="cb22-5" data-line-number="5"><span class="co">## [[2]]</span></a>
<a class="sourceLine" id="cb22-6" data-line-number="6"><span class="co">## [1] 90</span></a>
<a class="sourceLine" id="cb22-7" data-line-number="7"><span class="co">## </span></a>
<a class="sourceLine" id="cb22-8" data-line-number="8"><span class="co">## [[3]]</span></a>
<a class="sourceLine" id="cb22-9" data-line-number="9"><span class="co">## [1] 120</span></a></code></pre></div>
<p>This is caused by the fact that we supplied five groups that must belong together but only used a three fold resampling strategy here.</p>
</div>
<div id="grouping-cv-with-fixed-predefined-indices" class="section level3">
<h3 class="hasAnchor">
<a href="#grouping-cv-with-fixed-predefined-indices" class="anchor"></a>Grouping: CV with fixed predefined indices</h3>
<p>There is a second way of using predefined indices in resampling in <code>mlr</code>: Constructing the folds based on the supplied indices in <code>blocking</code>. We refer to this method here as “grouping” to distinguish it from “blocking”. This method is more restrictive in the way that it will always use the number of levels supplied via <code>blocking</code> as the number of folds. To use this method, we need to set <code>fixed = TRUE</code> instead of <code>blocking.cv</code> when creating the resampling description object.</p>
<p>We can leave out the <code>iters</code> argument, as it will be set internally to the number of supplied factor levels.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1">rdesc =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"CV"</span>, <span class="dt">fixed =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb23-2" data-line-number="2">p =<span class="st"> </span><span class="kw"><a href="../../reference/resample.html">resample</a></span>(<span class="st">"classif.lda"</span>, task, rdesc)</a>
<a class="sourceLine" id="cb23-3" data-line-number="3"><span class="co">## Warning in instantiateResampleInstance.CVDesc(desc, size, task): Adjusting</span></a>
<a class="sourceLine" id="cb23-4" data-line-number="4"><span class="co">## levels to match number of blocking levels.</span></a>
<a class="sourceLine" id="cb23-5" data-line-number="5"><span class="co">## Resampling: cross-validation</span></a>
<a class="sourceLine" id="cb23-6" data-line-number="6"><span class="co">## Measures:             mmce</span></a>
<a class="sourceLine" id="cb23-7" data-line-number="7"><span class="co">## [Resample] iter 1:    0.1000000</span></a>
<a class="sourceLine" id="cb23-8" data-line-number="8"><span class="co">## [Resample] iter 2:    0.0000000</span></a>
<a class="sourceLine" id="cb23-9" data-line-number="9"><span class="co">## [Resample] iter 3:    0.0000000</span></a>
<a class="sourceLine" id="cb23-10" data-line-number="10"><span class="co">## [Resample] iter 4:    0.0000000</span></a>
<a class="sourceLine" id="cb23-11" data-line-number="11"><span class="co">## [Resample] iter 5:    0.1000000</span></a>
<a class="sourceLine" id="cb23-12" data-line-number="12"><span class="co">## </span></a>
<a class="sourceLine" id="cb23-13" data-line-number="13"><span class="co">## Aggregated Result: mmce.test.mean=0.0400000</span></a>
<a class="sourceLine" id="cb23-14" data-line-number="14"><span class="co">## </span></a>
<a class="sourceLine" id="cb23-15" data-line-number="15"><span class="kw">sort</span>(p<span class="op">$</span>pred<span class="op">$</span>instance<span class="op">$</span>train.inds[[<span class="dv">1</span>]])</a>
<a class="sourceLine" id="cb23-16" data-line-number="16"><span class="co">##   [1]   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17</span></a>
<a class="sourceLine" id="cb23-17" data-line-number="17"><span class="co">##  [18]  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34</span></a>
<a class="sourceLine" id="cb23-18" data-line-number="18"><span class="co">##  [35]  35  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51</span></a>
<a class="sourceLine" id="cb23-19" data-line-number="19"><span class="co">##  [52]  52  53  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68</span></a>
<a class="sourceLine" id="cb23-20" data-line-number="20"><span class="co">##  [69]  69  70  71  72  73  74  75  76  77  78  79  80  81  82  83  84  85</span></a>
<a class="sourceLine" id="cb23-21" data-line-number="21"><span class="co">##  [86]  86  87  88  89  90  91  92  93  94  95  96  97  98  99 100 101 102</span></a>
<a class="sourceLine" id="cb23-22" data-line-number="22"><span class="co">## [103] 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119</span></a>
<a class="sourceLine" id="cb23-23" data-line-number="23"><span class="co">## [120] 120</span></a></code></pre></div>
<p>You can see that we automatically created five folds in which the test set always corresponds to one factor level.</p>
<p>Doing it this way also means that we cannot do repeated CV because there is no way to create multiple shuffled folds of this fixed arrangement.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="kw">lapply</span>(p<span class="op">$</span>pred<span class="op">$</span>instance<span class="op">$</span>train.inds, <span class="cf">function</span>(x) <span class="kw">length</span>(x))</a>
<a class="sourceLine" id="cb24-2" data-line-number="2"><span class="co">## [[1]]</span></a>
<a class="sourceLine" id="cb24-3" data-line-number="3"><span class="co">## [1] 120</span></a>
<a class="sourceLine" id="cb24-4" data-line-number="4"><span class="co">## </span></a>
<a class="sourceLine" id="cb24-5" data-line-number="5"><span class="co">## [[2]]</span></a>
<a class="sourceLine" id="cb24-6" data-line-number="6"><span class="co">## [1] 120</span></a>
<a class="sourceLine" id="cb24-7" data-line-number="7"><span class="co">## </span></a>
<a class="sourceLine" id="cb24-8" data-line-number="8"><span class="co">## [[3]]</span></a>
<a class="sourceLine" id="cb24-9" data-line-number="9"><span class="co">## [1] 120</span></a>
<a class="sourceLine" id="cb24-10" data-line-number="10"><span class="co">## </span></a>
<a class="sourceLine" id="cb24-11" data-line-number="11"><span class="co">## [[4]]</span></a>
<a class="sourceLine" id="cb24-12" data-line-number="12"><span class="co">## [1] 120</span></a>
<a class="sourceLine" id="cb24-13" data-line-number="13"><span class="co">## </span></a>
<a class="sourceLine" id="cb24-14" data-line-number="14"><span class="co">## [[5]]</span></a>
<a class="sourceLine" id="cb24-15" data-line-number="15"><span class="co">## [1] 120</span></a></code></pre></div>
<p>However, this method can also be used in nested resampling settings (e.g. in hyperparameter tuning). In the inner level, the factor levels are honored and the function simply creates one fold less than in the outer level.</p>
<p>Please note that the <code>iters</code> argument has no effect in <code><a href="../../reference/makeResampleDesc.html">makeResampleDesc()</a></code> if <code>fixed = TRUE</code>. The number of folds will be automatically set based on the supplied number of factor levels via <code>blocking</code>. In the inner level, the number of folds will simply be one less than in the outer level.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1"><span class="co"># test fixed in nested resampling</span></a>
<a class="sourceLine" id="cb25-2" data-line-number="2">lrn =<span class="st"> </span><span class="kw"><a href="../../reference/makeLearner.html">makeLearner</a></span>(<span class="st">"classif.lda"</span>)</a>
<a class="sourceLine" id="cb25-3" data-line-number="3">ctrl &lt;-<span class="st"> </span><span class="kw"><a href="../../reference/makeTuneControlRandom.html">makeTuneControlRandom</a></span>(<span class="dt">maxit =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb25-4" data-line-number="4">ps &lt;-<span class="st"> </span><span class="kw">makeParamSet</span>(<span class="kw">makeNumericParam</span>(<span class="st">"nu"</span>, <span class="dt">lower =</span> <span class="dv">2</span>, <span class="dt">upper =</span> <span class="dv">20</span>))</a>
<a class="sourceLine" id="cb25-5" data-line-number="5">inner =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"CV"</span>, <span class="dt">fixed =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb25-6" data-line-number="6">outer =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"CV"</span>, <span class="dt">fixed =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb25-7" data-line-number="7">tune_wrapper =<span class="st"> </span><span class="kw"><a href="../../reference/makeTuneWrapper.html">makeTuneWrapper</a></span>(lrn, <span class="dt">resampling =</span> inner, <span class="dt">par.set =</span> ps,</a>
<a class="sourceLine" id="cb25-8" data-line-number="8">  <span class="dt">control =</span> ctrl, <span class="dt">show.info =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb25-9" data-line-number="9"></a>
<a class="sourceLine" id="cb25-10" data-line-number="10">p =<span class="st"> </span><span class="kw"><a href="../../reference/resample.html">resample</a></span>(tune_wrapper, task, outer, <span class="dt">show.info =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb25-11" data-line-number="11">  <span class="dt">extract =</span> getTuneResult)</a></code></pre></div>
<p>To check on the inner resampling indices, you can call <code><a href="../../reference/getResamplingIndices.html">getResamplingIndices(inner = TRUE)</a></code>. You can see that for every outer fold (List of 5), four inner folds were created that respect the grouping supplied via the <code>blocking</code> argument.</p>
<p>Of course you can also use a normal random sampling “CV” description in the inner level by just setting <code>fixed = FALSE</code>.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1"><span class="kw">str</span>(<span class="kw"><a href="../../reference/getResamplingIndices.html">getResamplingIndices</a></span>(p, <span class="dt">inner =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb26-2" data-line-number="2"><span class="co">## List of 5</span></a>
<a class="sourceLine" id="cb26-3" data-line-number="3"><span class="co">##  $ :List of 2</span></a>
<a class="sourceLine" id="cb26-4" data-line-number="4"><span class="co">##   ..$ train.inds:List of 4</span></a>
<a class="sourceLine" id="cb26-5" data-line-number="5"><span class="co">##   .. ..$ : int [1:90] 3 150 120 97 133 124 116 29 93 22 ...</span></a>
<a class="sourceLine" id="cb26-6" data-line-number="6"><span class="co">##   .. ..$ : int [1:90] 3 150 67 68 65 133 124 29 22 84 ...</span></a>
<a class="sourceLine" id="cb26-7" data-line-number="7"><span class="co">##   .. ..$ : int [1:90] 150 120 97 67 68 65 133 124 116 93 ...</span></a>
<a class="sourceLine" id="cb26-8" data-line-number="8"><span class="co">##   .. ..$ : int [1:90] 3 120 97 67 68 65 116 29 93 22 ...</span></a>
<a class="sourceLine" id="cb26-9" data-line-number="9"><span class="co">##   ..$ test.inds :List of 4</span></a>
<a class="sourceLine" id="cb26-10" data-line-number="10"><span class="co">##   .. ..$ : int [1:30] 70 79 61 63 64 80 68 62 69 81 ...</span></a>
<a class="sourceLine" id="cb26-11" data-line-number="11"><span class="co">##   .. ..$ : int [1:30] 91 115 105 116 110 102 94 101 98 99 ...</span></a>
<a class="sourceLine" id="cb26-12" data-line-number="12"><span class="co">##   .. ..$ : int [1:30] 10 29 21 9 1 12 30 3 22 2 ...</span></a>
<a class="sourceLine" id="cb26-13" data-line-number="13"><span class="co">##   .. ..$ : int [1:30] 138 144 134 129 136 121 131 146 128 139 ...</span></a>
<a class="sourceLine" id="cb26-14" data-line-number="14"><span class="co">##  $ :List of 2</span></a>
<a class="sourceLine" id="cb26-15" data-line-number="15"><span class="co">##   ..$ train.inds:List of 4</span></a>
<a class="sourceLine" id="cb26-16" data-line-number="16"><span class="co">##   .. ..$ : int [1:90] 130 104 144 88 100 125 92 84 111 135 ...</span></a>
<a class="sourceLine" id="cb26-17" data-line-number="17"><span class="co">##   .. ..$ : int [1:90] 130 52 55 144 39 88 42 32 125 84 ...</span></a>
<a class="sourceLine" id="cb26-18" data-line-number="18"><span class="co">##   .. ..$ : int [1:90] 130 104 52 55 144 39 42 100 32 125 ...</span></a>
<a class="sourceLine" id="cb26-19" data-line-number="19"><span class="co">##   .. ..$ : int [1:90] 104 52 55 39 88 42 100 32 92 84 ...</span></a>
<a class="sourceLine" id="cb26-20" data-line-number="20"><span class="co">##   ..$ test.inds :List of 4</span></a>
<a class="sourceLine" id="cb26-21" data-line-number="21"><span class="co">##   .. ..$ : int [1:30] 55 50 60 54 39 45 38 35 32 47 ...</span></a>
<a class="sourceLine" id="cb26-22" data-line-number="22"><span class="co">##   .. ..$ : int [1:30] 91 115 105 116 110 102 94 101 98 99 ...</span></a>
<a class="sourceLine" id="cb26-23" data-line-number="23"><span class="co">##   .. ..$ : int [1:30] 70 79 61 63 64 80 68 62 69 81 ...</span></a>
<a class="sourceLine" id="cb26-24" data-line-number="24"><span class="co">##   .. ..$ : int [1:30] 138 144 134 129 136 121 131 146 128 139 ...</span></a>
<a class="sourceLine" id="cb26-25" data-line-number="25"><span class="co">##  $ :List of 2</span></a>
<a class="sourceLine" id="cb26-26" data-line-number="26"><span class="co">##   ..$ train.inds:List of 4</span></a>
<a class="sourceLine" id="cb26-27" data-line-number="27"><span class="co">##   .. ..$ : int [1:90] 75 49 148 70 50 124 31 76 39 130 ...</span></a>
<a class="sourceLine" id="cb26-28" data-line-number="28"><span class="co">##   .. ..$ : int [1:90] 75 49 15 8 22 28 70 50 14 31 ...</span></a>
<a class="sourceLine" id="cb26-29" data-line-number="29"><span class="co">##   .. ..$ : int [1:90] 75 15 8 22 28 148 70 124 14 76 ...</span></a>
<a class="sourceLine" id="cb26-30" data-line-number="30"><span class="co">##   .. ..$ : int [1:90] 49 15 8 22 28 148 50 124 14 31 ...</span></a>
<a class="sourceLine" id="cb26-31" data-line-number="31"><span class="co">##   ..$ test.inds :List of 4</span></a>
<a class="sourceLine" id="cb26-32" data-line-number="32"><span class="co">##   .. ..$ : int [1:30] 10 29 21 9 1 12 30 3 22 2 ...</span></a>
<a class="sourceLine" id="cb26-33" data-line-number="33"><span class="co">##   .. ..$ : int [1:30] 138 144 134 129 136 121 131 146 128 139 ...</span></a>
<a class="sourceLine" id="cb26-34" data-line-number="34"><span class="co">##   .. ..$ : int [1:30] 55 50 60 54 39 45 38 35 32 47 ...</span></a>
<a class="sourceLine" id="cb26-35" data-line-number="35"><span class="co">##   .. ..$ : int [1:30] 70 79 61 63 64 80 68 62 69 81 ...</span></a>
<a class="sourceLine" id="cb26-36" data-line-number="36"><span class="co">##  $ :List of 2</span></a>
<a class="sourceLine" id="cb26-37" data-line-number="37"><span class="co">##   ..$ train.inds:List of 4</span></a>
<a class="sourceLine" id="cb26-38" data-line-number="38"><span class="co">##   .. ..$ : int [1:90] 123 107 34 33 103 124 120 112 101 109 ...</span></a>
<a class="sourceLine" id="cb26-39" data-line-number="39"><span class="co">##   .. ..$ : int [1:90] 123 107 103 124 120 112 18 101 109 19 ...</span></a>
<a class="sourceLine" id="cb26-40" data-line-number="40"><span class="co">##   .. ..$ : int [1:90] 123 34 33 124 18 19 8 137 51 141 ...</span></a>
<a class="sourceLine" id="cb26-41" data-line-number="41"><span class="co">##   .. ..$ : int [1:90] 107 34 33 103 120 112 18 101 109 19 ...</span></a>
<a class="sourceLine" id="cb26-42" data-line-number="42"><span class="co">##   ..$ test.inds :List of 4</span></a>
<a class="sourceLine" id="cb26-43" data-line-number="43"><span class="co">##   .. ..$ : int [1:30] 10 29 21 9 1 12 30 3 22 2 ...</span></a>
<a class="sourceLine" id="cb26-44" data-line-number="44"><span class="co">##   .. ..$ : int [1:30] 55 50 60 54 39 45 38 35 32 47 ...</span></a>
<a class="sourceLine" id="cb26-45" data-line-number="45"><span class="co">##   .. ..$ : int [1:30] 91 115 105 116 110 102 94 101 98 99 ...</span></a>
<a class="sourceLine" id="cb26-46" data-line-number="46"><span class="co">##   .. ..$ : int [1:30] 138 144 134 129 136 121 131 146 128 139 ...</span></a>
<a class="sourceLine" id="cb26-47" data-line-number="47"><span class="co">##  $ :List of 2</span></a>
<a class="sourceLine" id="cb26-48" data-line-number="48"><span class="co">##   ..$ train.inds:List of 4</span></a>
<a class="sourceLine" id="cb26-49" data-line-number="49"><span class="co">##   .. ..$ : int [1:90] 17 19 35 27 18 29 85 5 2 10 ...</span></a>
<a class="sourceLine" id="cb26-50" data-line-number="50"><span class="co">##   .. ..$ : int [1:90] 116 35 109 111 120 85 49 105 61 106 ...</span></a>
<a class="sourceLine" id="cb26-51" data-line-number="51"><span class="co">##   .. ..$ : int [1:90] 17 116 19 27 109 111 120 18 29 85 ...</span></a>
<a class="sourceLine" id="cb26-52" data-line-number="52"><span class="co">##   .. ..$ : int [1:90] 17 116 19 35 27 109 111 120 18 29 ...</span></a>
<a class="sourceLine" id="cb26-53" data-line-number="53"><span class="co">##   ..$ test.inds :List of 4</span></a>
<a class="sourceLine" id="cb26-54" data-line-number="54"><span class="co">##   .. ..$ : int [1:30] 91 115 105 116 110 102 94 101 98 99 ...</span></a>
<a class="sourceLine" id="cb26-55" data-line-number="55"><span class="co">##   .. ..$ : int [1:30] 10 29 21 9 1 12 30 3 22 2 ...</span></a>
<a class="sourceLine" id="cb26-56" data-line-number="56"><span class="co">##   .. ..$ : int [1:30] 55 50 60 54 39 45 38 35 32 47 ...</span></a>
<a class="sourceLine" id="cb26-57" data-line-number="57"><span class="co">##   .. ..$ : int [1:30] 70 79 61 63 64 80 68 62 69 81 ...</span></a></code></pre></div>
</div>
</div>
<div id="resample-descriptions-and-resample-instances" class="section level2">
<h2 class="hasAnchor">
<a href="#resample-descriptions-and-resample-instances" class="anchor"></a>Resample descriptions and resample instances</h2>
<p>As already mentioned, you can specify a resampling strategy using function <code><a href="../../reference/makeResampleDesc.html">makeResampleDesc()</a></code>.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1">rdesc =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"CV"</span>, <span class="dt">iters =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb27-2" data-line-number="2">rdesc</a>
<a class="sourceLine" id="cb27-3" data-line-number="3"><span class="co">## Resample description: cross-validation with 3 iterations.</span></a>
<a class="sourceLine" id="cb27-4" data-line-number="4"><span class="co">## Predict: test</span></a>
<a class="sourceLine" id="cb27-5" data-line-number="5"><span class="co">## Stratification: FALSE</span></a>
<a class="sourceLine" id="cb27-6" data-line-number="6"></a>
<a class="sourceLine" id="cb27-7" data-line-number="7"><span class="kw">str</span>(rdesc)</a>
<a class="sourceLine" id="cb27-8" data-line-number="8"><span class="co">## List of 6</span></a>
<a class="sourceLine" id="cb27-9" data-line-number="9"><span class="co">##  $ fixed      : logi FALSE</span></a>
<a class="sourceLine" id="cb27-10" data-line-number="10"><span class="co">##  $ blocking.cv: logi FALSE</span></a>
<a class="sourceLine" id="cb27-11" data-line-number="11"><span class="co">##  $ id         : chr "cross-validation"</span></a>
<a class="sourceLine" id="cb27-12" data-line-number="12"><span class="co">##  $ iters      : int 3</span></a>
<a class="sourceLine" id="cb27-13" data-line-number="13"><span class="co">##  $ predict    : chr "test"</span></a>
<a class="sourceLine" id="cb27-14" data-line-number="14"><span class="co">##  $ stratify   : logi FALSE</span></a>
<a class="sourceLine" id="cb27-15" data-line-number="15"><span class="co">##  - attr(*, "class")= chr [1:2] "CVDesc" "ResampleDesc"</span></a>
<a class="sourceLine" id="cb27-16" data-line-number="16"></a>
<a class="sourceLine" id="cb27-17" data-line-number="17"><span class="kw">str</span>(<span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"Subsample"</span>, <span class="dt">stratify.cols =</span> <span class="st">"chas"</span>))</a>
<a class="sourceLine" id="cb27-18" data-line-number="18"><span class="co">## List of 8</span></a>
<a class="sourceLine" id="cb27-19" data-line-number="19"><span class="co">##  $ split        : num 0.667</span></a>
<a class="sourceLine" id="cb27-20" data-line-number="20"><span class="co">##  $ id           : chr "subsampling"</span></a>
<a class="sourceLine" id="cb27-21" data-line-number="21"><span class="co">##  $ iters        : int 30</span></a>
<a class="sourceLine" id="cb27-22" data-line-number="22"><span class="co">##  $ predict      : chr "test"</span></a>
<a class="sourceLine" id="cb27-23" data-line-number="23"><span class="co">##  $ stratify     : logi FALSE</span></a>
<a class="sourceLine" id="cb27-24" data-line-number="24"><span class="co">##  $ stratify.cols: chr "chas"</span></a>
<a class="sourceLine" id="cb27-25" data-line-number="25"><span class="co">##  $ fixed        : logi FALSE</span></a>
<a class="sourceLine" id="cb27-26" data-line-number="26"><span class="co">##  $ blocking.cv  : logi FALSE</span></a>
<a class="sourceLine" id="cb27-27" data-line-number="27"><span class="co">##  - attr(*, "class")= chr [1:2] "SubsampleDesc" "ResampleDesc"</span></a></code></pre></div>
<p>The result <code>rdesc</code> inherits from class <code>ResampleDesc</code> (<code><a href="../../reference/makeResampleDesc.html">makeResampleDesc()</a></code>) (short for resample description) and, in principle, contains all necessary information about the resampling strategy including the number of iterations, the proportion of training and test sets, stratification variables, etc.</p>
<p>Given either the size of the data set at hand or the <code><a href="../../reference/Task.html">Task()</a></code>, function <code><a href="../../reference/makeResampleInstance.html">makeResampleInstance()</a></code> draws the training and test sets according to the <code>ResampleDesc</code> (<code><a href="../../reference/makeResampleDesc.html">makeResampleDesc()</a></code>).</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1"><span class="co"># Create a resample instance based an a task</span></a>
<a class="sourceLine" id="cb28-2" data-line-number="2">rin =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleInstance.html">makeResampleInstance</a></span>(rdesc, iris.task)</a>
<a class="sourceLine" id="cb28-3" data-line-number="3">rin</a>
<a class="sourceLine" id="cb28-4" data-line-number="4"><span class="co">## Resample instance for 150 cases.</span></a>
<a class="sourceLine" id="cb28-5" data-line-number="5"><span class="co">## Resample description: cross-validation with 3 iterations.</span></a>
<a class="sourceLine" id="cb28-6" data-line-number="6"><span class="co">## Predict: test</span></a>
<a class="sourceLine" id="cb28-7" data-line-number="7"><span class="co">## Stratification: FALSE</span></a>
<a class="sourceLine" id="cb28-8" data-line-number="8"></a>
<a class="sourceLine" id="cb28-9" data-line-number="9"><span class="kw">str</span>(rin)</a>
<a class="sourceLine" id="cb28-10" data-line-number="10"><span class="co">## List of 5</span></a>
<a class="sourceLine" id="cb28-11" data-line-number="11"><span class="co">##  $ desc      :List of 6</span></a>
<a class="sourceLine" id="cb28-12" data-line-number="12"><span class="co">##   ..$ fixed      : logi FALSE</span></a>
<a class="sourceLine" id="cb28-13" data-line-number="13"><span class="co">##   ..$ blocking.cv: logi FALSE</span></a>
<a class="sourceLine" id="cb28-14" data-line-number="14"><span class="co">##   ..$ id         : chr "cross-validation"</span></a>
<a class="sourceLine" id="cb28-15" data-line-number="15"><span class="co">##   ..$ iters      : int 3</span></a>
<a class="sourceLine" id="cb28-16" data-line-number="16"><span class="co">##   ..$ predict    : chr "test"</span></a>
<a class="sourceLine" id="cb28-17" data-line-number="17"><span class="co">##   ..$ stratify   : logi FALSE</span></a>
<a class="sourceLine" id="cb28-18" data-line-number="18"><span class="co">##   ..- attr(*, "class")= chr [1:2] "CVDesc" "ResampleDesc"</span></a>
<a class="sourceLine" id="cb28-19" data-line-number="19"><span class="co">##  $ size      : int 150</span></a>
<a class="sourceLine" id="cb28-20" data-line-number="20"><span class="co">##  $ train.inds:List of 3</span></a>
<a class="sourceLine" id="cb28-21" data-line-number="21"><span class="co">##   ..$ : int [1:100] 16 69 106 67 83 104 129 36 76 105 ...</span></a>
<a class="sourceLine" id="cb28-22" data-line-number="22"><span class="co">##   ..$ : int [1:100] 3 62 69 106 27 42 104 129 76 105 ...</span></a>
<a class="sourceLine" id="cb28-23" data-line-number="23"><span class="co">##   ..$ : int [1:100] 3 62 16 67 27 83 42 36 71 30 ...</span></a>
<a class="sourceLine" id="cb28-24" data-line-number="24"><span class="co">##  $ test.inds :List of 3</span></a>
<a class="sourceLine" id="cb28-25" data-line-number="25"><span class="co">##   ..$ : int [1:50] 3 7 8 14 17 18 22 27 29 30 ...</span></a>
<a class="sourceLine" id="cb28-26" data-line-number="26"><span class="co">##   ..$ : int [1:50] 9 10 12 16 19 20 25 28 33 36 ...</span></a>
<a class="sourceLine" id="cb28-27" data-line-number="27"><span class="co">##   ..$ : int [1:50] 1 2 4 5 6 11 13 15 21 23 ...</span></a>
<a class="sourceLine" id="cb28-28" data-line-number="28"><span class="co">##  $ group     : Factor w/ 0 levels: </span></a>
<a class="sourceLine" id="cb28-29" data-line-number="29"><span class="co">##  - attr(*, "class")= chr "ResampleInstance"</span></a>
<a class="sourceLine" id="cb28-30" data-line-number="30"></a>
<a class="sourceLine" id="cb28-31" data-line-number="31"><span class="co"># Create a resample instance given the size of the data set</span></a>
<a class="sourceLine" id="cb28-32" data-line-number="32">rin =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleInstance.html">makeResampleInstance</a></span>(rdesc, <span class="dt">size =</span> <span class="kw">nrow</span>(iris))</a>
<a class="sourceLine" id="cb28-33" data-line-number="33"><span class="kw">str</span>(rin)</a>
<a class="sourceLine" id="cb28-34" data-line-number="34"><span class="co">## List of 5</span></a>
<a class="sourceLine" id="cb28-35" data-line-number="35"><span class="co">##  $ desc      :List of 6</span></a>
<a class="sourceLine" id="cb28-36" data-line-number="36"><span class="co">##   ..$ fixed      : logi FALSE</span></a>
<a class="sourceLine" id="cb28-37" data-line-number="37"><span class="co">##   ..$ blocking.cv: logi FALSE</span></a>
<a class="sourceLine" id="cb28-38" data-line-number="38"><span class="co">##   ..$ id         : chr "cross-validation"</span></a>
<a class="sourceLine" id="cb28-39" data-line-number="39"><span class="co">##   ..$ iters      : int 3</span></a>
<a class="sourceLine" id="cb28-40" data-line-number="40"><span class="co">##   ..$ predict    : chr "test"</span></a>
<a class="sourceLine" id="cb28-41" data-line-number="41"><span class="co">##   ..$ stratify   : logi FALSE</span></a>
<a class="sourceLine" id="cb28-42" data-line-number="42"><span class="co">##   ..- attr(*, "class")= chr [1:2] "CVDesc" "ResampleDesc"</span></a>
<a class="sourceLine" id="cb28-43" data-line-number="43"><span class="co">##  $ size      : int 150</span></a>
<a class="sourceLine" id="cb28-44" data-line-number="44"><span class="co">##  $ train.inds:List of 3</span></a>
<a class="sourceLine" id="cb28-45" data-line-number="45"><span class="co">##   ..$ : int [1:100] 79 63 132 42 62 72 134 82 1 81 ...</span></a>
<a class="sourceLine" id="cb28-46" data-line-number="46"><span class="co">##   ..$ : int [1:100] 112 26 121 63 132 131 24 141 93 86 ...</span></a>
<a class="sourceLine" id="cb28-47" data-line-number="47"><span class="co">##   ..$ : int [1:100] 112 79 26 121 42 131 24 141 93 86 ...</span></a>
<a class="sourceLine" id="cb28-48" data-line-number="48"><span class="co">##  $ test.inds :List of 3</span></a>
<a class="sourceLine" id="cb28-49" data-line-number="49"><span class="co">##   ..$ : int [1:50] 14 17 18 19 24 25 26 27 31 35 ...</span></a>
<a class="sourceLine" id="cb28-50" data-line-number="50"><span class="co">##   ..$ : int [1:50] 1 4 6 10 12 23 37 40 42 44 ...</span></a>
<a class="sourceLine" id="cb28-51" data-line-number="51"><span class="co">##   ..$ : int [1:50] 2 3 5 7 8 9 11 13 15 16 ...</span></a>
<a class="sourceLine" id="cb28-52" data-line-number="52"><span class="co">##  $ group     : Factor w/ 0 levels: </span></a>
<a class="sourceLine" id="cb28-53" data-line-number="53"><span class="co">##  - attr(*, "class")= chr "ResampleInstance"</span></a>
<a class="sourceLine" id="cb28-54" data-line-number="54"></a>
<a class="sourceLine" id="cb28-55" data-line-number="55"><span class="co"># Access the indices of the training observations in iteration 3</span></a>
<a class="sourceLine" id="cb28-56" data-line-number="56">rin<span class="op">$</span>train.inds[[<span class="dv">3</span>]]</a>
<a class="sourceLine" id="cb28-57" data-line-number="57"><span class="co">##   [1] 112  79  26 121  42 131  24 141  93  86  72  82   1 115  98 110  27</span></a>
<a class="sourceLine" id="cb28-58" data-line-number="58"><span class="co">##  [18]  81  50  18 105  90 150 119  69 147 111 128  67  64  38  45  52  17</span></a>
<a class="sourceLine" id="cb28-59" data-line-number="59"><span class="co">##  [35]  51 124  48  41  80 108  96 145 148  89 133 127  19 142 104 101  92</span></a>
<a class="sourceLine" id="cb28-60" data-line-number="60"><span class="co">##  [52]  99 117  36  12 125  66 126  91  14 123   4 149  40  31  71  85 129</span></a>
<a class="sourceLine" id="cb28-61" data-line-number="61"><span class="co">##  [69]  56  95 107  49  44 114  35  59  77  46  94 102 130  23 139  74   6</span></a>
<a class="sourceLine" id="cb28-62" data-line-number="62"><span class="co">##  [86] 120  70  10 140 106  76  60 103  88 113  37  25  65  78  58</span></a></code></pre></div>
<p>The result <code>rin</code> inherits from class <code>ResampleInstance</code> (<code><a href="../../reference/makeResampleInstance.html">makeResampleInstance()</a></code>) and contains <code>list</code>s of index vectors for the train and test sets.</p>
<p>If a <code>ResampleDesc</code> (<code><a href="../../reference/makeResampleDesc.html">makeResampleDesc()</a></code>) is passed to <code><a href="../../reference/resample.html">resample()</a></code>, it is instantiated internally. Naturally, it is also possible to pass a <code>ResampleInstance</code> (<code><a href="../../reference/makeResampleInstance.html">makeResampleInstance()</a></code>) directly.</p>
<p>While the separation between resample descriptions, resample instances, and the <code><a href="../../reference/resample.html">resample()</a></code> function itself seems overly complicated, it has several advantages:</p>
<ul>
<li>Resample instances readily allow for paired experiments, that is comparing the performance of several learners on exactly the same training and test sets. This is particularly useful if you want to add another method to a comparison experiment you already did. Moreover, you can store the resample instance along with your data in order to be able to reproduce your results later on.</li>
</ul>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1">rdesc =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"CV"</span>, <span class="dt">iters =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb29-2" data-line-number="2">rin =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleInstance.html">makeResampleInstance</a></span>(rdesc, <span class="dt">task =</span> iris.task)</a>
<a class="sourceLine" id="cb29-3" data-line-number="3"></a>
<a class="sourceLine" id="cb29-4" data-line-number="4"><span class="co"># Calculate the performance of two learners based on the same resample instance</span></a>
<a class="sourceLine" id="cb29-5" data-line-number="5">r.lda =<span class="st"> </span><span class="kw"><a href="../../reference/resample.html">resample</a></span>(<span class="st">"classif.lda"</span>, iris.task, rin, <span class="dt">show.info =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb29-6" data-line-number="6">r.rpart =<span class="st"> </span><span class="kw"><a href="../../reference/resample.html">resample</a></span>(<span class="st">"classif.rpart"</span>, iris.task, rin, <span class="dt">show.info =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb29-7" data-line-number="7">r.lda<span class="op">$</span>aggr</a>
<a class="sourceLine" id="cb29-8" data-line-number="8"><span class="co">## mmce.test.mean </span></a>
<a class="sourceLine" id="cb29-9" data-line-number="9"><span class="co">##           0.02</span></a>
<a class="sourceLine" id="cb29-10" data-line-number="10"></a>
<a class="sourceLine" id="cb29-11" data-line-number="11">r.rpart<span class="op">$</span>aggr</a>
<a class="sourceLine" id="cb29-12" data-line-number="12"><span class="co">## mmce.test.mean </span></a>
<a class="sourceLine" id="cb29-13" data-line-number="13"><span class="co">##     0.06666667</span></a></code></pre></div>
<ul>
<li>In order to add further resampling methods you can simply derive from the <code>ResampleDesc</code> (<code><a href="../../reference/makeResampleDesc.html">makeResampleDesc()</a></code>) and <code>ResampleInstance</code> (<code><a href="../../reference/makeResampleInstance.html">makeResampleInstance()</a></code>) classes, but you do neither have to touch <code><a href="../../reference/resample.html">resample()</a></code> nor any further methods that use the resampling strategy.</li>
</ul>
<p>Usually, when calling <code><a href="../../reference/makeResampleInstance.html">makeResampleInstance()</a></code> the train and test index sets are drawn randomly. Mainly for <em>holdout</em> (<em>test sample</em>) <em>estimation</em> you might want full control about the training and tests set and specify them manually. This can be done using function <code><a href="../../reference/makeFixedHoldoutInstance.html">makeFixedHoldoutInstance()</a></code>.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1">rin =<span class="st"> </span><span class="kw"><a href="../../reference/makeFixedHoldoutInstance.html">makeFixedHoldoutInstance</a></span>(<span class="dt">train.inds =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">100</span>, <span class="dt">test.inds =</span> <span class="dv">101</span><span class="op">:</span><span class="dv">150</span>, <span class="dt">size =</span> <span class="dv">150</span>)</a>
<a class="sourceLine" id="cb30-2" data-line-number="2">rin</a>
<a class="sourceLine" id="cb30-3" data-line-number="3"><span class="co">## Resample instance for 150 cases.</span></a>
<a class="sourceLine" id="cb30-4" data-line-number="4"><span class="co">## Resample description: holdout with 0.67 split rate.</span></a>
<a class="sourceLine" id="cb30-5" data-line-number="5"><span class="co">## Predict: test</span></a>
<a class="sourceLine" id="cb30-6" data-line-number="6"><span class="co">## Stratification: FALSE</span></a></code></pre></div>
</div>
<div id="aggregating-performance-values" class="section level2">
<h2 class="hasAnchor">
<a href="#aggregating-performance-values" class="anchor"></a>Aggregating performance values</h2>
<p>In each resampling iteration <span class="math inline">\(b = 1,\ldots,B\)</span> we get performance values <span class="math inline">\(S(D^{*b}, D \setminus D^{*b})\)</span> (for each measure we wish to calculate), which are then aggregated to an overall performance.</p>
<p>For the great majority of common resampling strategies (like holdout, cross-validation, subsampling) performance values are calculated on the test data sets only and for most measures aggregated by taking the mean (<code>test.mean</code>(<code><a href="../../reference/aggregations.html">aggregations()</a></code>)).</p>
<p>Each performance <code>Measure</code> (<code><a href="../../reference/makeMeasure.html">makeMeasure()</a></code>) in <code>mlr</code> has a corresponding default aggregation method which is stored in slot <code>$aggr</code>. The default aggregation for most measures is <code>test.mean</code>(<code><a href="../../reference/aggregations.html">aggregations()</a></code>). One exception is the root mean square error (<a href="measures.html" target="_blank">rmse</a>).</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1"><span class="co"># Mean misclassification error</span></a>
<a class="sourceLine" id="cb31-2" data-line-number="2">mmce<span class="op">$</span>aggr</a>
<a class="sourceLine" id="cb31-3" data-line-number="3"><span class="co">## Aggregation function: test.mean</span></a>
<a class="sourceLine" id="cb31-4" data-line-number="4"></a>
<a class="sourceLine" id="cb31-5" data-line-number="5">mmce<span class="op">$</span>aggr<span class="op">$</span>fun</a>
<a class="sourceLine" id="cb31-6" data-line-number="6"><span class="co">## function (task, perf.test, perf.train, measure, group, pred) </span></a>
<a class="sourceLine" id="cb31-7" data-line-number="7"><span class="co">## mean(perf.test)</span></a>
<a class="sourceLine" id="cb31-8" data-line-number="8"><span class="co">## &lt;bytecode: 0xc8eade8&gt;</span></a>
<a class="sourceLine" id="cb31-9" data-line-number="9"><span class="co">## &lt;environment: namespace:mlr&gt;</span></a>
<a class="sourceLine" id="cb31-10" data-line-number="10"></a>
<a class="sourceLine" id="cb31-11" data-line-number="11"><span class="co"># Root mean square error</span></a>
<a class="sourceLine" id="cb31-12" data-line-number="12">rmse<span class="op">$</span>aggr</a>
<a class="sourceLine" id="cb31-13" data-line-number="13"><span class="co">## Aggregation function: test.rmse</span></a>
<a class="sourceLine" id="cb31-14" data-line-number="14"></a>
<a class="sourceLine" id="cb31-15" data-line-number="15">rmse<span class="op">$</span>aggr<span class="op">$</span>fun</a>
<a class="sourceLine" id="cb31-16" data-line-number="16"><span class="co">## function (task, perf.test, perf.train, measure, group, pred) </span></a>
<a class="sourceLine" id="cb31-17" data-line-number="17"><span class="co">## sqrt(mean(perf.test^2))</span></a>
<a class="sourceLine" id="cb31-18" data-line-number="18"><span class="co">## &lt;bytecode: 0x23ad72d8&gt;</span></a>
<a class="sourceLine" id="cb31-19" data-line-number="19"><span class="co">## &lt;environment: namespace:mlr&gt;</span></a></code></pre></div>
<p>You can change the aggregation method of a <code>Measure</code> (<code><a href="../../reference/makeMeasure.html">makeMeasure()</a></code>) via function <code><a href="../../reference/setAggregation.html">setAggregation()</a></code>. All available aggregation schemes are listed on the <code><a href="../../reference/aggregations.html">aggregations()</a></code> documentation page.</p>
<div id="example-one-measure-with-different-aggregations" class="section level4">
<h4 class="hasAnchor">
<a href="#example-one-measure-with-different-aggregations" class="anchor"></a>Example: One measure with different aggregations</h4>
<p>The aggregation schemes <code>test.median</code> (<code><a href="../../reference/aggregations.html">aggregations()</a></code>), <code>test.min</code> (<code><a href="../../reference/aggregations.html">aggregations()</a></code>), and <code>text.max</code> (<code><a href="../../reference/aggregations.html">aggregations()</a></code>) compute the median, minimum, and maximum of the performance values on the test sets.</p>
<pre><code>## Resampling: cross-validation
## Measures:             mse       mse       mse       mse
## [Resample] iter 1:    21.043561321.043561321.043561321.0435613
## [Resample] iter 2:    27.737793427.737793427.737793427.7377934
## [Resample] iter 3:    23.526411123.526411123.526411123.5264111
## 
## Aggregated Result: mse.test.mean=24.1025886,mse.test.median=23.5264111,mse.test.min=21.0435613,mse.test.max=27.7377934
## </code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1">mseTestMedian =<span class="st"> </span><span class="kw"><a href="../../reference/setAggregation.html">setAggregation</a></span>(mse, test.median)</a>
<a class="sourceLine" id="cb33-2" data-line-number="2">mseTestMin =<span class="st"> </span><span class="kw"><a href="../../reference/setAggregation.html">setAggregation</a></span>(mse, test.min)</a>
<a class="sourceLine" id="cb33-3" data-line-number="3">mseTestMax =<span class="st"> </span><span class="kw"><a href="../../reference/setAggregation.html">setAggregation</a></span>(mse, test.max)</a>
<a class="sourceLine" id="cb33-4" data-line-number="4"></a>
<a class="sourceLine" id="cb33-5" data-line-number="5">mseTestMedian</a>
<a class="sourceLine" id="cb33-6" data-line-number="6"><span class="co">## Name: Mean of squared errors</span></a>
<a class="sourceLine" id="cb33-7" data-line-number="7"><span class="co">## Performance measure: mse</span></a>
<a class="sourceLine" id="cb33-8" data-line-number="8"><span class="co">## Properties: regr,req.pred,req.truth</span></a>
<a class="sourceLine" id="cb33-9" data-line-number="9"><span class="co">## Minimize: TRUE</span></a>
<a class="sourceLine" id="cb33-10" data-line-number="10"><span class="co">## Best: 0; Worst: Inf</span></a>
<a class="sourceLine" id="cb33-11" data-line-number="11"><span class="co">## Aggregated by: test.median</span></a>
<a class="sourceLine" id="cb33-12" data-line-number="12"><span class="co">## Arguments: </span></a>
<a class="sourceLine" id="cb33-13" data-line-number="13"><span class="co">## Note: Defined as: mean((response - truth)^2)</span></a>
<a class="sourceLine" id="cb33-14" data-line-number="14"></a>
<a class="sourceLine" id="cb33-15" data-line-number="15">rdesc =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"CV"</span>, <span class="dt">iters =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb33-16" data-line-number="16">r =<span class="st"> </span><span class="kw"><a href="../../reference/resample.html">resample</a></span>(<span class="st">"regr.lm"</span>, bh.task, rdesc, <span class="dt">measures =</span> <span class="kw">list</span>(mse, mseTestMedian, mseTestMin, mseTestMax))</a>
<a class="sourceLine" id="cb33-17" data-line-number="17"><span class="co">## Resampling: cross-validation</span></a>
<a class="sourceLine" id="cb33-18" data-line-number="18"><span class="co">## Measures:             mse       mse       mse       mse</span></a>
<a class="sourceLine" id="cb33-19" data-line-number="19"><span class="co">## [Resample] iter 1:    24.078202624.078202624.078202624.0782026</span></a>
<a class="sourceLine" id="cb33-20" data-line-number="20"><span class="co">## [Resample] iter 2:    29.498307729.498307729.498307729.4983077</span></a>
<a class="sourceLine" id="cb33-21" data-line-number="21"><span class="co">## [Resample] iter 3:    18.689471818.689471818.689471818.6894718</span></a>
<a class="sourceLine" id="cb33-22" data-line-number="22"><span class="co">## </span></a>
<a class="sourceLine" id="cb33-23" data-line-number="23"><span class="co">## Aggregated Result: mse.test.mean=24.0886607,mse.test.median=24.0782026,mse.test.min=18.6894718,mse.test.max=29.4983077</span></a>
<a class="sourceLine" id="cb33-24" data-line-number="24"><span class="co">## </span></a>
<a class="sourceLine" id="cb33-25" data-line-number="25"></a>
<a class="sourceLine" id="cb33-26" data-line-number="26">r</a>
<a class="sourceLine" id="cb33-27" data-line-number="27"><span class="co">## Resample Result</span></a>
<a class="sourceLine" id="cb33-28" data-line-number="28"><span class="co">## Task: BostonHousing-example</span></a>
<a class="sourceLine" id="cb33-29" data-line-number="29"><span class="co">## Learner: regr.lm</span></a>
<a class="sourceLine" id="cb33-30" data-line-number="30"><span class="co">## Aggr perf: mse.test.mean=24.0886607,mse.test.median=24.0782026,mse.test.min=18.6894718,mse.test.max=29.4983077</span></a>
<a class="sourceLine" id="cb33-31" data-line-number="31"><span class="co">## Runtime: 0.0288048</span></a>
<a class="sourceLine" id="cb33-32" data-line-number="32"></a>
<a class="sourceLine" id="cb33-33" data-line-number="33">r<span class="op">$</span>aggr</a>
<a class="sourceLine" id="cb33-34" data-line-number="34"><span class="co">##   mse.test.mean mse.test.median    mse.test.min    mse.test.max </span></a>
<a class="sourceLine" id="cb33-35" data-line-number="35"><span class="co">##        24.08866        24.07820        18.68947        29.49831</span></a></code></pre></div>
</div>
<div id="example-calculating-the-training-error" class="section level3">
<h3 class="hasAnchor">
<a href="#example-calculating-the-training-error" class="anchor"></a>Example: Calculating the training error</h3>
<p>Below we calculate the mean misclassification error (<a href="measures.html" target="_blank">mmce</a>) on the training and the test data sets. Note that we have to set <code>predict = "both"</code> when calling <code><a href="../../reference/makeResampleDesc.html">makeResampleDesc()</a></code> in order to get predictions on both training and test sets.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1">mmceTrainMean =<span class="st"> </span><span class="kw"><a href="../../reference/setAggregation.html">setAggregation</a></span>(mmce, train.mean)</a>
<a class="sourceLine" id="cb34-2" data-line-number="2">rdesc =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"CV"</span>, <span class="dt">iters =</span> <span class="dv">3</span>, <span class="dt">predict =</span> <span class="st">"both"</span>)</a>
<a class="sourceLine" id="cb34-3" data-line-number="3">r =<span class="st"> </span><span class="kw"><a href="../../reference/resample.html">resample</a></span>(<span class="st">"classif.rpart"</span>, iris.task, rdesc, <span class="dt">measures =</span> <span class="kw">list</span>(mmce, mmceTrainMean))</a>
<a class="sourceLine" id="cb34-4" data-line-number="4"><span class="co">## Resampling: cross-validation</span></a>
<a class="sourceLine" id="cb34-5" data-line-number="5"><span class="co">## Measures:             mmce.train   mmce.test</span></a>
<a class="sourceLine" id="cb34-6" data-line-number="6"><span class="co">## [Resample] iter 1:    0.0300000    0.1000000</span></a>
<a class="sourceLine" id="cb34-7" data-line-number="7"><span class="co">## [Resample] iter 2:    0.0500000    0.0200000</span></a>
<a class="sourceLine" id="cb34-8" data-line-number="8"><span class="co">## [Resample] iter 3:    0.0200000    0.0800000</span></a>
<a class="sourceLine" id="cb34-9" data-line-number="9"><span class="co">## </span></a>
<a class="sourceLine" id="cb34-10" data-line-number="10"><span class="co">## Aggregated Result: mmce.test.mean=0.0666667,mmce.train.mean=0.0333333</span></a>
<a class="sourceLine" id="cb34-11" data-line-number="11"><span class="co">## </span></a>
<a class="sourceLine" id="cb34-12" data-line-number="12"></a>
<a class="sourceLine" id="cb34-13" data-line-number="13">r<span class="op">$</span>measures.train</a>
<a class="sourceLine" id="cb34-14" data-line-number="14"><span class="co">##   iter mmce mmce</span></a>
<a class="sourceLine" id="cb34-15" data-line-number="15"><span class="co">## 1    1 0.03 0.03</span></a>
<a class="sourceLine" id="cb34-16" data-line-number="16"><span class="co">## 2    2 0.05 0.05</span></a>
<a class="sourceLine" id="cb34-17" data-line-number="17"><span class="co">## 3    3 0.02 0.02</span></a>
<a class="sourceLine" id="cb34-18" data-line-number="18"></a>
<a class="sourceLine" id="cb34-19" data-line-number="19">r<span class="op">$</span>aggr</a>
<a class="sourceLine" id="cb34-20" data-line-number="20"><span class="co">##  mmce.test.mean mmce.train.mean </span></a>
<a class="sourceLine" id="cb34-21" data-line-number="21"><span class="co">##      0.06666667      0.03333333</span></a></code></pre></div>
</div>
<div id="example-bootstrap" class="section level3">
<h3 class="hasAnchor">
<a href="#example-bootstrap" class="anchor"></a>Example: Bootstrap</h3>
<p>In <em>out-of-bag bootstrap estimation</em> <span class="math inline">\(B\)</span> new data sets <span class="math inline">\(D^{*1}, \ldots, D^{*B}\)</span> are drawn from the data set <span class="math inline">\(D\)</span> with replacement, each of the same size as <span class="math inline">\(D\)</span>. In the <span class="math inline">\(b\)</span>-th iteration, <span class="math inline">\(D^{*b}\)</span> forms the training set, while the remaining elements from <span class="math inline">\(D\)</span>, i.e., <span class="math inline">\(D \setminus D^{*b}\)</span>, form the test set.</p>
<!--(
                     |resampling_desc_figure|

                     |resampling_nested_resampling_figure|
)-->
<p>The <em>b632</em> and <em>b632+</em> variants calculate a convex combination of the training performance and the out-of-bag bootstrap performance and thus require predictions on the training sets and an appropriate aggregation strategy.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" data-line-number="1"><span class="co"># Use bootstrap as resampling strategy and predict on both train and test sets</span></a>
<a class="sourceLine" id="cb35-2" data-line-number="2">rdesc =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"Bootstrap"</span>, <span class="dt">predict =</span> <span class="st">"both"</span>, <span class="dt">iters =</span> <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb35-3" data-line-number="3"></a>
<a class="sourceLine" id="cb35-4" data-line-number="4"><span class="co"># Set aggregation schemes for b632 and b632+ bootstrap</span></a>
<a class="sourceLine" id="cb35-5" data-line-number="5">mmceB632 =<span class="st"> </span><span class="kw"><a href="../../reference/setAggregation.html">setAggregation</a></span>(mmce, b632)</a>
<a class="sourceLine" id="cb35-6" data-line-number="6">mmceB632plus =<span class="st"> </span><span class="kw"><a href="../../reference/setAggregation.html">setAggregation</a></span>(mmce, b632plus)</a>
<a class="sourceLine" id="cb35-7" data-line-number="7"></a>
<a class="sourceLine" id="cb35-8" data-line-number="8">mmceB632</a>
<a class="sourceLine" id="cb35-9" data-line-number="9"><span class="co">## Name: Mean misclassification error</span></a>
<a class="sourceLine" id="cb35-10" data-line-number="10"><span class="co">## Performance measure: mmce</span></a>
<a class="sourceLine" id="cb35-11" data-line-number="11"><span class="co">## Properties: classif,classif.multi,req.pred,req.truth</span></a>
<a class="sourceLine" id="cb35-12" data-line-number="12"><span class="co">## Minimize: TRUE</span></a>
<a class="sourceLine" id="cb35-13" data-line-number="13"><span class="co">## Best: 0; Worst: 1</span></a>
<a class="sourceLine" id="cb35-14" data-line-number="14"><span class="co">## Aggregated by: b632</span></a>
<a class="sourceLine" id="cb35-15" data-line-number="15"><span class="co">## Arguments: list()</span></a>
<a class="sourceLine" id="cb35-16" data-line-number="16"><span class="co">## Note: Defined as: mean(response != truth)</span></a>
<a class="sourceLine" id="cb35-17" data-line-number="17"></a>
<a class="sourceLine" id="cb35-18" data-line-number="18">r =<span class="st"> </span><span class="kw"><a href="../../reference/resample.html">resample</a></span>(<span class="st">"classif.rpart"</span>, iris.task, rdesc, <span class="dt">measures =</span> <span class="kw">list</span>(mmce, mmceB632, mmceB632plus),</a>
<a class="sourceLine" id="cb35-19" data-line-number="19">  <span class="dt">show.info =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb35-20" data-line-number="20"><span class="kw">head</span>(r<span class="op">$</span>measures.train)</a>
<a class="sourceLine" id="cb35-21" data-line-number="21"><span class="co">##   iter       mmce       mmce       mmce</span></a>
<a class="sourceLine" id="cb35-22" data-line-number="22"><span class="co">## 1    1 0.04000000 0.04000000 0.04000000</span></a>
<a class="sourceLine" id="cb35-23" data-line-number="23"><span class="co">## 2    2 0.04000000 0.04000000 0.04000000</span></a>
<a class="sourceLine" id="cb35-24" data-line-number="24"><span class="co">## 3    3 0.02666667 0.02666667 0.02666667</span></a>
<a class="sourceLine" id="cb35-25" data-line-number="25"><span class="co">## 4    4 0.02000000 0.02000000 0.02000000</span></a>
<a class="sourceLine" id="cb35-26" data-line-number="26"><span class="co">## 5    5 0.02000000 0.02000000 0.02000000</span></a>
<a class="sourceLine" id="cb35-27" data-line-number="27"><span class="co">## 6    6 0.02000000 0.02000000 0.02000000</span></a>
<a class="sourceLine" id="cb35-28" data-line-number="28"></a>
<a class="sourceLine" id="cb35-29" data-line-number="29"><span class="co"># Compare misclassification rates for out-of-bag, b632, and b632+ bootstrap</span></a>
<a class="sourceLine" id="cb35-30" data-line-number="30">r<span class="op">$</span>aggr</a>
<a class="sourceLine" id="cb35-31" data-line-number="31"><span class="co">## mmce.test.mean      mmce.b632  mmce.b632plus </span></a>
<a class="sourceLine" id="cb35-32" data-line-number="32"><span class="co">##     0.05751504     0.04640817     0.04751579</span></a></code></pre></div>
</div>
</div>
<div id="convenience-functions" class="section level2">
<h2 class="hasAnchor">
<a href="#convenience-functions" class="anchor"></a>Convenience functions</h2>
<p>The functionality described on this page allows for much control and flexibility. However, when quickly trying out some learners, it can get tedious to type all the code for defining the resampling strategy, setting the aggregation scheme and so on. As mentioned above, <code>mlr</code> includes some pre-defined resample description objects for frequently used strategies like, e.g., 5-fold cross-validation (<code>cv5</code> (<code><a href="../../reference/makeResampleDesc.html">makeResampleDesc()</a></code>)). Moreover, <code>mlr</code> provides special functions for the most common resampling methods, for example <code>holdout</code> (<code><a href="../../reference/resample.html">resample()</a></code>), <code>crossval</code> (<code><a href="../../reference/resample.html">resample()</a></code>), or <code>bootstrapB632</code> (<code><a href="../../reference/resample.html">resample()</a></code>).</p>
<pre><code>## Resampling: cross-validation
## Measures:             mmce      ber
## [Resample] iter 1:    0.0200000 0.0185185
## [Resample] iter 2:    0.0000000 0.0000000
## [Resample] iter 3:    0.0600000 0.0640523
## 
## Aggregated Result: mmce.test.mean=0.0266667,ber.test.mean=0.0275236
## 
## Resampling: OOB bootstrapping
## Measures:             mse.train   mae.train   mse.test    mae.test
## [Resample] iter 1:    17.8574197  3.0527442   25.0329081  3.4522670
## [Resample] iter 2:    21.2690350  3.2048943   21.0377962  3.4237734
## [Resample] iter 3:    16.3170950  2.8646150   30.1866248  3.8006483
## 
## Aggregated Result: mse.b632plus=23.0152530,mae.b632plus=3.3816457
## </code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1"><span class="kw"><a href="../../reference/resample.html">crossval</a></span>(<span class="st">"classif.lda"</span>, iris.task, <span class="dt">iters =</span> <span class="dv">3</span>, <span class="dt">measures =</span> <span class="kw">list</span>(mmce, ber))</a>
<a class="sourceLine" id="cb37-2" data-line-number="2"><span class="co">## Resampling: cross-validation</span></a>
<a class="sourceLine" id="cb37-3" data-line-number="3"><span class="co">## Measures:             mmce      ber</span></a>
<a class="sourceLine" id="cb37-4" data-line-number="4"><span class="co">## [Resample] iter 1:    0.0200000 0.0238095</span></a>
<a class="sourceLine" id="cb37-5" data-line-number="5"><span class="co">## [Resample] iter 2:    0.0400000 0.0370370</span></a>
<a class="sourceLine" id="cb37-6" data-line-number="6"><span class="co">## [Resample] iter 3:    0.0000000 0.0000000</span></a>
<a class="sourceLine" id="cb37-7" data-line-number="7"><span class="co">## </span></a>
<a class="sourceLine" id="cb37-8" data-line-number="8"><span class="co">## Aggregated Result: mmce.test.mean=0.0200000,ber.test.mean=0.0202822</span></a>
<a class="sourceLine" id="cb37-9" data-line-number="9"><span class="co">## </span></a>
<a class="sourceLine" id="cb37-10" data-line-number="10"><span class="co">## Resample Result</span></a>
<a class="sourceLine" id="cb37-11" data-line-number="11"><span class="co">## Task: iris-example</span></a>
<a class="sourceLine" id="cb37-12" data-line-number="12"><span class="co">## Learner: classif.lda</span></a>
<a class="sourceLine" id="cb37-13" data-line-number="13"><span class="co">## Aggr perf: mmce.test.mean=0.0200000,ber.test.mean=0.0202822</span></a>
<a class="sourceLine" id="cb37-14" data-line-number="14"><span class="co">## Runtime: 0.0205457</span></a>
<a class="sourceLine" id="cb37-15" data-line-number="15"></a>
<a class="sourceLine" id="cb37-16" data-line-number="16"><span class="kw"><a href="../../reference/resample.html">bootstrapB632plus</a></span>(<span class="st">"regr.lm"</span>, bh.task, <span class="dt">iters =</span> <span class="dv">3</span>, <span class="dt">measures =</span> <span class="kw">list</span>(mse, mae))</a>
<a class="sourceLine" id="cb37-17" data-line-number="17"><span class="co">## Resampling: OOB bootstrapping</span></a>
<a class="sourceLine" id="cb37-18" data-line-number="18"><span class="co">## Measures:             mse.train   mae.train   mse.test    mae.test</span></a>
<a class="sourceLine" id="cb37-19" data-line-number="19"><span class="co">## [Resample] iter 1:    24.6425511  3.4107320   16.3415466  3.0123263</span></a>
<a class="sourceLine" id="cb37-20" data-line-number="20"><span class="co">## [Resample] iter 2:    17.0963191  2.9809210   29.6056968  3.7131236</span></a>
<a class="sourceLine" id="cb37-21" data-line-number="21"><span class="co">## [Resample] iter 3:    23.1440608  3.5079975   24.4183753  3.3467443</span></a>
<a class="sourceLine" id="cb37-22" data-line-number="22"><span class="co">## </span></a>
<a class="sourceLine" id="cb37-23" data-line-number="23"><span class="co">## Aggregated Result: mse.b632plus=22.9359054,mae.b632plus=3.3459751</span></a>
<a class="sourceLine" id="cb37-24" data-line-number="24"><span class="co">## </span></a>
<a class="sourceLine" id="cb37-25" data-line-number="25"><span class="co">## Resample Result</span></a>
<a class="sourceLine" id="cb37-26" data-line-number="26"><span class="co">## Task: BostonHousing-example</span></a>
<a class="sourceLine" id="cb37-27" data-line-number="27"><span class="co">## Learner: regr.lm</span></a>
<a class="sourceLine" id="cb37-28" data-line-number="28"><span class="co">## Aggr perf: mse.b632plus=22.9359054,mae.b632plus=3.3459751</span></a>
<a class="sourceLine" id="cb37-29" data-line-number="29"><span class="co">## Runtime: 0.0419419</span></a></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#defining-the-resampling-strategy">Defining the resampling strategy</a></li>
      <li><a href="#performing-the-resampling">Performing the resampling</a></li>
      <li><a href="#accessing-resample-results">Accessing resample results</a></li>
      <li><a href="#stratification-blocking-and-grouping">Stratification, Blocking and Grouping</a></li>
      <li><a href="#resample-descriptions-and-resample-instances">Resample descriptions and resample instances</a></li>
      <li><a href="#aggregating-performance-values">Aggregating performance values</a></li>
      <li><a href="#convenience-functions">Convenience functions</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><!--<div class="copyright">
  <p>Developed by Bernd Bischl, Michel Lang, Lars Kotthoff, Julia Schiffner, Jakob Richter, Zachary Jones, Giuseppe Casalicchio, Mason Gallo, Patrick Schratz.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>
--></footer>
</div>

   
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script><script type="text/javascript"> docsearch({
 apiKey: 'e300ecafdf04fe1199e3339c825ce7d0',
 indexName: 'mlr',
 inputSelector: 'input#search-input.form-control',
 debug: false // Set debug to true if you want to inspect the dropdown
});
</script>
</body>
</html>
