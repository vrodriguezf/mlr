<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- Google Site Verification --><meta name="google-site-verification" content="BrjL5fpoyHZu1rR8rwnnM2MBO3u3iIFB8NsmSuOsY84">
<title>Resampling • mlr</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../jquery.sticky-kit.min.js"></script><script src="../../pkgdown.js"></script><link href="../../extra.css" rel="stylesheet">
<script src="../../extra.js"></script><meta property="og:title" content="Resampling">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css">
<link rel="icon" type="image/png" href="https://mlr-org.github.io/mlr/favicon.ico">
<link rel="apple-touch-icon" type="image/png" href="https://mlr-org.github.io/mlr/favicon.ico">
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a class="navbar-brand" href="../../index.html"></a>
      </div>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Basics
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/tutorial/task.html">Tasks</a>
    </li>
    <li>
      <a href="../../articles/tutorial/learner.html">Learners</a>
    </li>
    <li>
      <a href="../../articles/tutorial/train.html">Train</a>
    </li>
    <li>
      <a href="../../articles/tutorial/predict.html">Predict</a>
    </li>
    <li>
      <a href="../../articles/tutorial/preproc.html">Preprocessing</a>
    </li>
    <li>
      <a href="../../articles/tutorial/performance.html">Performance</a>
    </li>
    <li>
      <a href="../../articles/tutorial/resample.html">Resampling</a>
    </li>
    <li>
      <a href="../../articles/tutorial/tune.html">Tuning</a>
    </li>
    <li>
      <a href="../../articles/tutorial/benchmark_experiments.html">Benchmark Experiments</a>
    </li>
    <li>
      <a href="../../articles/tutorial/parallelization.html">Parallelization</a>
    </li>
    <li>
      <a href="../../articles/tutorial/visualization.html">Visualization</a>
    </li>
    <li>
      <a href="../../articles/tutorial/usecase_regression.html">Use case - Regression</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Advanced
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/tutorial/configureMlr.html">Configuration</a>
    </li>
    <li>
      <a href="../../articles/tutorial/wrapper.html">Wrapped Learners</a>
    </li>
    <li>
      <a href="../../articles/tutorial/impute.html">Imputation</a>
    </li>
    <li>
      <a href="../../articles/tutorial/bagging.html">Generic Bagging</a>
    </li>
    <li>
      <a href="../../articles/tutorial/advanced_tune.html">Advanced Tuning</a>
    </li>
    <li>
      <a href="../../articles/tutorial/feature_selection.html">Feature Selection/Filtering</a>
    </li>
    <li>
      <a href="../../articles/tutorial/nested_resampling.html">Nested Resampling</a>
    </li>
    <li>
      <a href="../../articles/tutorial/cost_sensitive_classif.html">Cost-Sensitive Classification</a>
    </li>
    <li>
      <a href="../../articles/tutorial/over_and_undersampling.html">Imbalanced Classification Problems</a>
    </li>
    <li>
      <a href="../../articles/tutorial/roc_analysis.html">ROC Analysis and Performance Curves</a>
    </li>
    <li>
      <a href="../../articles/tutorial/multilabel.html">Multilabel Classification</a>
    </li>
    <li>
      <a href="../../articles/tutorial/learning_curve.html">Learning Curve Analysis</a>
    </li>
    <li>
      <a href="../../articles/tutorial/partial_dependence.html">Partial Dependence Plots</a>
    </li>
    <li>
      <a href="../../articles/tutorial/classifier_calibration.html">Classifier Calibration</a>
    </li>
    <li>
      <a href="../../articles/tutorial/hyperpar_tuning_effects.html">Hyperparameter Tuning Effects</a>
    </li>
    <li>
      <a href="../../articles/tutorial/out_of_bag_predictions.html">Out-of-Bag Predictions</a>
    </li>
    <li>
      <a href="../../articles/tutorial/handling_of_spatial_data.html">Handling of Spatial Data</a>
    </li>
    <li>
      <a href="../../articles/tutorial/functional_data.html">Functional Data</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Extending
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/tutorial/create_learner.html">Create Custom Learners</a>
    </li>
    <li>
      <a href="../../articles/tutorial/create_measure.html">Create Custom Measures</a>
    </li>
    <li>
      <a href="../../articles/tutorial/create_imputation.html">Create Imputation Methods</a>
    </li>
    <li>
      <a href="../../articles/tutorial/create_filter.html">Create Custom Filters</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Appendix
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../reference/index.html">Function Reference</a>
    </li>
    <li>
      <a href="../../news/index.html">News</a>
    </li>
    <li>
      <a href="../../articles/tutorial/example_tasks.html">Example Tasks</a>
    </li>
    <li>
      <a href="../../articles/tutorial/integrated_learners.html">Integrated Learners</a>
    </li>
    <li>
      <a href="../../articles/tutorial/measures.html">Implemented Measures</a>
    </li>
    <li>
      <a href="../../articles/tutorial/filter_methods.html">Integrated Filter Methods</a>
    </li>
    <li>
      <a href="../../articles/tutorial/mlr_publications.html">mlr Publications</a>
    </li>
    <li>
      <a href="../../articles/tutorial/talks_videos_workshops.html">Talks, Videos and Workshops</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    mlr-org Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="https://github.com/mlr-org/mlrMBO">mlrMBO</a>
    </li>
    <li>
      <a href="https://github.com/mlr-org/mlrCPO">mlrCPO</a>
    </li>
    <li>
      <a href="https://jakob-r.de/mlrHyperopt/index.html">mlrHyperopt</a>
    </li>
    <li>
      <a href="https://openml.github.io/openml-r/vignettes/OpenML.html">OpenML</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mlr-org/mlr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://mlr-org.slack.com">
    <span class="fa fa-slack"></span>
     
  </a>
</li>
<li>
  <a href="https://stackoverflow.com/questions/tagged/mlr">
    <span class="fa fa-stack-overflow"></span>
     
  </a>
</li>
<li>
  <a href="https://mlr-org.com/">
    <span class="fa fa-rss"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="search" class="form-control" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Resampling</h1>
            
      
      <!--The 'toc' block was inserted manually by @pat-s. It triggeres the inline ToC in the vignettes.-->
            <div id="toc">
      <h3 class="hasAnchor">
<a href="#toc" class="anchor"></a>Table of Contents</h3>
      <ul>
<li><a href="#defining-the-resampling-strategy">Defining the resampling strategy</a></li>
      <li><a href="#performing-the-resampling">Performing the resampling</a></li>
      <li>
<a href="#accessing-resample-results">Accessing resample results</a><ul>
<li><a href="#predictions">Predictions</a></li>
      <li><a href="#learner-models">Learner models</a></li>
      <li><a href="#the-extract-option">The extract option</a></li>
      </ul>
</li>
      <li>
<a href="#stratification-blocking-and-grouping">Stratification, Blocking and Grouping</a><ul>
<li><a href="#stratification-with-respect-to-the-target-variables">Stratification with respect to the target variable(s)</a></li>
      <li><a href="#stratification-with-respect-to-explanatory-variables">Stratification with respect to explanatory variables</a></li>
      <li><a href="#blocking-cv-with-flexible-predefined-indices">Blocking: CV with flexible predefined indices</a></li>
      <li><a href="#grouping-cv-with-fixed-predefined-indices">Grouping: CV with fixed predefined indices</a></li>
      </ul>
</li>
      <li><a href="#resample-descriptions-and-resample-instances">Resample descriptions and resample instances</a></li>
      <li>
<a href="#aggregating-performance-values">Aggregating performance values</a><ul>
<li><a href="#example-calculating-the-training-error">Example: Calculating the training error</a></li>
      <li><a href="#example-bootstrap">Example: Bootstrap</a></li>
      </ul>
</li>
      <li><a href="#convenience-functions">Convenience functions</a></li>
      </ul>
</div>
      
      <small>Source: <a href="https://github.com/mlr-org/mlr/blob/master/vignettes/tutorial/resample.Rmd"><code>vignettes/tutorial/resample.Rmd</code></a></small>

    </div>

    
    
<div class="contents">
<p>Resampling strategies are usually used to assess the performance of a learning algorithm: The entire data set is (repeatedly) split into training sets <span class="math inline">\(D^{*b}\)</span> and test sets <span class="math inline">\(D \setminus D^{*b}\)</span>, <span class="math inline">\(b = 1,\ldots,B\)</span>. The learner is trained on each training set, predictions are made on the corresponding test set (sometimes on the training set as well) and the performance measure <span class="math inline">\(S(D^{*b}, D \setminus D^{*b})\)</span> is calculated. Then the <span class="math inline">\(B\)</span> individual performance values are aggregated, most often by calculating the mean. There exist various different resampling strategies, for example cross-validation and bootstrap, to mention just two popular approaches.</p>
<div class="figure" style="text-align: center">
<img src="https://raw.githubusercontent.com/pat-s/mlr/master/vignettes/tutorial/devel/pdf/img/resampling.png" alt="Resampling Figure" width="600px"><p class="caption">
Resampling Figure
</p>
</div>
<p>If you want to read up on further details, the paper <a href="http://link.springer.com/chapter/10.1007%2F978-0-387-47509-7_8">Resampling Strategies for Model Assessment and Selection</a> by Simon is probably not a bad choice. Bernd has also published a paper <a href="http://www.mitpressjournals.org/doi/pdf/10.1162/EVCO_a_00069">Resampling methods for meta-model validation with recommendations for evolutionary computation</a> which contains detailed descriptions and lots of statistical background information on resampling methods.</p>
<div id="defining-the-resampling-strategy" class="section level2">
<h2 class="hasAnchor">
<a href="#defining-the-resampling-strategy" class="anchor"></a>Defining the resampling strategy</h2>
<p>In <code>mlr</code> the resampling strategy can be defined via function <code><a href="../../reference/makeResampleDesc.html">makeResampleDesc()</a></code>. It requires a string that specifies the resampling method and, depending on the selected strategy, further information like the number of iterations. The supported resampling strategies are:</p>
<ul>
<li>Cross-validation (<code>"CV"</code>),</li>
<li>Leave-one-out cross-validation (<code>"LOO"</code>),</li>
<li>Repeated cross-validation (<code>"RepCV"</code>),</li>
<li>Out-of-bag bootstrap and other variants like <em>b632</em> (<code>"Bootstrap"</code>),</li>
<li>Subsampling, also called Monte-Carlo cross-validation (<code>"Subsample"</code>),</li>
<li>Holdout (training/test) (<code>"Holdout"</code>).</li>
</ul>
<p>For example if you want to use 3-fold cross-validation type:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># 3-fold cross-validation</span></span>
<span id="cb1-2"><a href="#cb1-2"></a>rdesc =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"CV"</span>, <span class="dt">iters =</span> <span class="dv">3</span>)</span>
<span id="cb1-3"><a href="#cb1-3"></a>rdesc</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="co">## Resample description: cross-validation with 3 iterations.</span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="co">## Predict: test</span></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="co">## Stratification: FALSE</span></span></code></pre></div>
<p>For holdout estimation use:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># Holdout estimation</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>rdesc =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"Holdout"</span>)</span>
<span id="cb2-3"><a href="#cb2-3"></a>rdesc</span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="co">## Resample description: holdout with 0.67 split rate.</span></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="co">## Predict: test</span></span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="co">## Stratification: FALSE</span></span></code></pre></div>
<p>In order to save you some typing <code>mlr</code> contains some pre-defined resample descriptions for very common strategies like holdout (<code>hout</code> (<code><a href="../../reference/makeResampleDesc.html">makeResampleDesc()</a></code>)) as well as cross-validation with different numbers of folds (e.g., <code>cv5</code> (<code><a href="../../reference/makeResampleDesc.html">makeResampleDesc()</a></code>) or <code>cv10</code> (<code><a href="../../reference/makeResampleDesc.html">makeResampleDesc()</a></code>)).</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>hout</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="co">## Resample description: holdout with 0.67 split rate.</span></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="co">## Predict: test</span></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="co">## Stratification: FALSE</span></span>
<span id="cb3-5"><a href="#cb3-5"></a></span>
<span id="cb3-6"><a href="#cb3-6"></a>cv3</span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="co">## Resample description: cross-validation with 3 iterations.</span></span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="co">## Predict: test</span></span>
<span id="cb3-9"><a href="#cb3-9"></a><span class="co">## Stratification: FALSE</span></span></code></pre></div>
</div>
<div id="performing-the-resampling" class="section level2">
<h2 class="hasAnchor">
<a href="#performing-the-resampling" class="anchor"></a>Performing the resampling</h2>
<p>Function <code><a href="../../reference/resample.html">resample()</a></code> evaluates a Learner (<code><a href="../../reference/makeLearner.html">makeLearner()</a></code>) on a given machine learning <code><a href="../../reference/Task.html">Task()</a></code> using the selected resampling strategy (<code><a href="../../reference/makeResampleDesc.html">makeResampleDesc()</a></code>).</p>
<p>As a first example, the performance of linear regression (<code><a href="https://rdrr.io/r/stats/lm.html">stats::lm()</a></code>) on the <code>BostonHousing</code> (<code><a href="https://rdrr.io/pkg/mlbench/man/BostonHousing.html">mlbench::BostonHousing()</a></code>) data set is calculated using <em>3-fold cross-validation</em>.</p>
<p>Generally, for <em><span class="math inline">\(K\)</span>-fold cross-validation</em> the data set <span class="math inline">\(D\)</span> is partitioned into <span class="math inline">\(K\)</span> subsets of (approximately) equal size. In the <span class="math inline">\(b\)</span>-th of the <span class="math inline">\(K\)</span> iterations, the <span class="math inline">\(b\)</span>-th subset is used for testing, while the union of the remaining parts forms the training set.</p>
<p>As usual, you can either pass a Learner (<code><a href="../../reference/makeLearner.html">makeLearner()</a></code>) object to <code><a href="../../reference/resample.html">resample()</a></code> or, as done here, provide the class name <code>"regr.lm"</code> of the learner. Since no performance measure is specified the default for regression learners (mean squared error, <a href="measures.html" target="_blank">mse</a>) is calculated.</p>
<pre><code>## Resampling: cross-validation
## Measures:             mse
## [Resample] iter 1:    19.8630628
## [Resample] iter 2:    29.4831894
## [Resample] iter 3:    21.2694775
## 
## Aggregated Result: mse.test.mean=23.5385766
## </code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># Specify the resampling strategy (3-fold cross-validation)</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>rdesc =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"CV"</span>, <span class="dt">iters =</span> <span class="dv">3</span>)</span>
<span id="cb5-3"><a href="#cb5-3"></a></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="co"># Calculate the performance</span></span>
<span id="cb5-5"><a href="#cb5-5"></a>r =<span class="st"> </span><span class="kw"><a href="../../reference/resample.html">resample</a></span>(<span class="st">"regr.lm"</span>, bh.task, rdesc)</span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="co">## Resampling: cross-validation</span></span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="co">## Measures:             mse</span></span>
<span id="cb5-8"><a href="#cb5-8"></a><span class="co">## [Resample] iter 1:    25.1371739</span></span>
<span id="cb5-9"><a href="#cb5-9"></a><span class="co">## [Resample] iter 2:    23.1279497</span></span>
<span id="cb5-10"><a href="#cb5-10"></a><span class="co">## [Resample] iter 3:    21.9152672</span></span>
<span id="cb5-11"><a href="#cb5-11"></a><span class="co">## </span></span>
<span id="cb5-12"><a href="#cb5-12"></a><span class="co">## Aggregated Result: mse.test.mean=23.3934636</span></span>
<span id="cb5-13"><a href="#cb5-13"></a><span class="co">## </span></span>
<span id="cb5-14"><a href="#cb5-14"></a></span>
<span id="cb5-15"><a href="#cb5-15"></a>r</span>
<span id="cb5-16"><a href="#cb5-16"></a><span class="co">## Resample Result</span></span>
<span id="cb5-17"><a href="#cb5-17"></a><span class="co">## Task: BostonHousing-example</span></span>
<span id="cb5-18"><a href="#cb5-18"></a><span class="co">## Learner: regr.lm</span></span>
<span id="cb5-19"><a href="#cb5-19"></a><span class="co">## Aggr perf: mse.test.mean=23.3934636</span></span>
<span id="cb5-20"><a href="#cb5-20"></a><span class="co">## Runtime: 0.0375051</span></span></code></pre></div>
<p>The result <code>r</code> is an object of class <code><a href="../../reference/resample.html">resample()</a></code> result. It contains performance results for the learner and some additional information like the runtime, predicted values, and optionally the models fitted in single resampling iterations.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="co"># Peak into r</span></span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(r)</span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="co">##  [1] "learner.id"     "task.id"        "task.desc"      "measures.train"</span></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="co">##  [5] "measures.test"  "aggr"           "pred"           "models"        </span></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="co">##  [9] "err.msgs"       "err.dumps"      "extract"        "runtime"</span></span>
<span id="cb6-6"><a href="#cb6-6"></a></span>
<span id="cb6-7"><a href="#cb6-7"></a>r<span class="op">$</span>aggr</span>
<span id="cb6-8"><a href="#cb6-8"></a><span class="co">## mse.test.mean </span></span>
<span id="cb6-9"><a href="#cb6-9"></a><span class="co">##      23.53858</span></span>
<span id="cb6-10"><a href="#cb6-10"></a></span>
<span id="cb6-11"><a href="#cb6-11"></a>r<span class="op">$</span>measures.test</span>
<span id="cb6-12"><a href="#cb6-12"></a><span class="co">##   iter      mse</span></span>
<span id="cb6-13"><a href="#cb6-13"></a><span class="co">## 1    1 19.86306</span></span>
<span id="cb6-14"><a href="#cb6-14"></a><span class="co">## 2    2 29.48319</span></span>
<span id="cb6-15"><a href="#cb6-15"></a><span class="co">## 3    3 21.26948</span></span></code></pre></div>
<p><code>r$measures.test</code> gives the performance on each of the 3 test data sets. <code>r$aggr</code> shows the aggregated performance value. Its name <code>"mse.test.mean"</code> indicates the performance measure, <a href="measures.html" target="_blank">mse</a>, and the method, <code>test.mean</code> (<code><a href="../../reference/aggregations.html">aggregations()</a></code>), used to aggregate the 3 individual performances. <code>test.mean</code> (<code><a href="../../reference/aggregations.html">aggregations()</a></code>) is the default aggregation scheme for most performance measures and, as the name implies, takes the mean over the performances on the test data sets.</p>
<p>Resampling in <code>mlr</code> works the same way for all types of learning problems and learners. Below is a classification example where a classification tree (rpart) (<code><a href="https://rdrr.io/pkg/rpart/man/rpart.html">rpart::rpart()</a></code>) is evaluated on the <code>Sonar</code> (<code>mlbench::sonar()</code>) data set by subsampling with 5 iterations.</p>
<p>In each subsampling iteration the data set <span class="math inline">\(D\)</span> is randomly partitioned into a training and a test set according to a given percentage, e.g., 2/3 training and 1/3 test set. If there is just one iteration, the strategy is commonly called <em>holdout</em> or <em>test sample estimation</em>.</p>
<p>You can calculate several measures at once by passing a <code>list</code> of Measures (<code><a href="../../reference/makeMeasure.html">makeMeasure()</a></code>)s to <code><a href="../../reference/resample.html">resample()</a></code>. Below, the error rate (<a href="measures.html" target="_blank">mmce</a>), false positive and false negative rates (<a href="measures.html" target="_blank">fpr</a>, <a href="measures.html" target="_blank">fnr</a>), and the time it takes to train the learner (<a href="measures.html" target="_blank">timetrain</a>) are estimated by <em>subsampling</em> with 5 iterations.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># Subsampling with 5 iterations and default split ratio 2/3</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>rdesc =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"Subsample"</span>, <span class="dt">iters =</span> <span class="dv">5</span>)</span>
<span id="cb7-3"><a href="#cb7-3"></a></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="co"># Subsampling with 5 iterations and 4/5 training data</span></span>
<span id="cb7-5"><a href="#cb7-5"></a>rdesc =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"Subsample"</span>, <span class="dt">iters =</span> <span class="dv">5</span>, <span class="dt">split =</span> <span class="dv">4</span><span class="op">/</span><span class="dv">5</span>)</span>
<span id="cb7-6"><a href="#cb7-6"></a></span>
<span id="cb7-7"><a href="#cb7-7"></a><span class="co"># Classification tree with information splitting criterion</span></span>
<span id="cb7-8"><a href="#cb7-8"></a>lrn =<span class="st"> </span><span class="kw"><a href="../../reference/makeLearner.html">makeLearner</a></span>(<span class="st">"classif.rpart"</span>, <span class="dt">parms =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">split =</span> <span class="st">"information"</span>))</span>
<span id="cb7-9"><a href="#cb7-9"></a></span>
<span id="cb7-10"><a href="#cb7-10"></a><span class="co"># Calculate the performance measures</span></span>
<span id="cb7-11"><a href="#cb7-11"></a>r =<span class="st"> </span><span class="kw"><a href="../../reference/resample.html">resample</a></span>(lrn, sonar.task, rdesc, <span class="dt">measures =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(mmce, fpr, fnr, timetrain))</span>
<span id="cb7-12"><a href="#cb7-12"></a><span class="co">## Resampling: subsampling</span></span>
<span id="cb7-13"><a href="#cb7-13"></a><span class="co">## Measures:             mmce        fpr         fnr         timetrain</span></span>
<span id="cb7-14"><a href="#cb7-14"></a><span class="co">## [Resample] iter 1:    0.4047619   0.5416667   0.2222222   0.0110000</span></span>
<span id="cb7-15"><a href="#cb7-15"></a><span class="co">## [Resample] iter 2:    0.1666667   0.1200000   0.2352941   0.0070000</span></span>
<span id="cb7-16"><a href="#cb7-16"></a><span class="co">## [Resample] iter 3:    0.3333333   0.1333333   0.4444444   0.0100000</span></span>
<span id="cb7-17"><a href="#cb7-17"></a><span class="co">## [Resample] iter 4:    0.2380952   0.3913043   0.0526316   0.0280000</span></span>
<span id="cb7-18"><a href="#cb7-18"></a><span class="co">## [Resample] iter 5:    0.3095238   0.2800000   0.3529412   0.0080000</span></span>
<span id="cb7-19"><a href="#cb7-19"></a><span class="co">## </span></span>
<span id="cb7-20"><a href="#cb7-20"></a><span class="co">## Aggregated Result: mmce.test.mean=0.2904762,fpr.test.mean=0.2932609,fnr.test.mean=0.2615067,timetrain.test.mean=0.0128000</span></span>
<span id="cb7-21"><a href="#cb7-21"></a><span class="co">## </span></span>
<span id="cb7-22"><a href="#cb7-22"></a></span>
<span id="cb7-23"><a href="#cb7-23"></a>r</span>
<span id="cb7-24"><a href="#cb7-24"></a><span class="co">## Resample Result</span></span>
<span id="cb7-25"><a href="#cb7-25"></a><span class="co">## Task: Sonar-example</span></span>
<span id="cb7-26"><a href="#cb7-26"></a><span class="co">## Learner: classif.rpart</span></span>
<span id="cb7-27"><a href="#cb7-27"></a><span class="co">## Aggr perf: mmce.test.mean=0.2904762,fpr.test.mean=0.2932609,fnr.test.mean=0.2615067,timetrain.test.mean=0.0128000</span></span>
<span id="cb7-28"><a href="#cb7-28"></a><span class="co">## Runtime: 0.10692</span></span></code></pre></div>
<p>If you want to add further measures afterwards, use <code><a href="../../reference/addRRMeasure.html">addRRMeasure()</a></code>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="co"># Add balanced error rate (ber) and time used to predict</span></span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="kw"><a href="../../reference/addRRMeasure.html">addRRMeasure</a></span>(r, <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(ber, timepredict))</span>
<span id="cb8-3"><a href="#cb8-3"></a></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="co">## Resample Result</span></span>
<span id="cb8-5"><a href="#cb8-5"></a><span class="co">## Task: Sonar-example</span></span>
<span id="cb8-6"><a href="#cb8-6"></a><span class="co">## Learner: classif.rpart</span></span>
<span id="cb8-7"><a href="#cb8-7"></a><span class="co">## Aggr perf: mmce.test.mean=0.2904762,fpr.test.mean=0.2932609,fnr.test.mean=0.2615067,timetrain.test.mean=0.0128000,ber.test.mean=0.2773838,timepredict.test.mean=0.0032000</span></span>
<span id="cb8-8"><a href="#cb8-8"></a><span class="co">## Runtime: 0.10692</span></span></code></pre></div>
<p>By default, <code><a href="../../reference/resample.html">resample()</a></code> prints progress messages and intermediate results. You can turn this off by setting <code>show.info = FALSE</code>, as done in the code chunk below. (If you are interested in suppressing these messages permanently have a look at the tutorial page about <a href="configureMlr.html" target="_blank">configuring mlr</a>.)</p>
<p>In the above example, the Learner (<code><a href="../../reference/makeLearner.html">makeLearner()</a></code>) was explicitly constructed. For convenience you can also specify the learner as a string and pass any learner parameters via the <code>...</code> argument of <code><a href="../../reference/resample.html">resample()</a></code>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>r =<span class="st"> </span><span class="kw"><a href="../../reference/resample.html">resample</a></span>(<span class="st">"classif.rpart"</span>, <span class="dt">parms =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">split =</span> <span class="st">"information"</span>), sonar.task, rdesc,</span>
<span id="cb9-2"><a href="#cb9-2"></a>  <span class="dt">measures =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(mmce, fpr, fnr, timetrain), <span class="dt">show.info =</span> <span class="ot">FALSE</span>)</span>
<span id="cb9-3"><a href="#cb9-3"></a></span>
<span id="cb9-4"><a href="#cb9-4"></a>r</span>
<span id="cb9-5"><a href="#cb9-5"></a></span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="co">## Resample Result</span></span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="co">## Task: Sonar-example</span></span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="co">## Learner: classif.rpart</span></span>
<span id="cb9-9"><a href="#cb9-9"></a><span class="co">## Aggr perf: mmce.test.mean=0.2428571,fpr.test.mean=0.2968173,fnr.test.mean=0.1970195,timetrain.test.mean=0.0084000</span></span>
<span id="cb9-10"><a href="#cb9-10"></a><span class="co">## Runtime: 0.0791025</span></span></code></pre></div>
</div>
<div id="accessing-resample-results" class="section level2">
<h2 class="hasAnchor">
<a href="#accessing-resample-results" class="anchor"></a>Accessing resample results</h2>
<p>Apart from the learner performance you can extract further information from the resample results, for example predicted values or the models fitted in individual resample iterations.</p>
<div id="predictions" class="section level3">
<h3 class="hasAnchor">
<a href="#predictions" class="anchor"></a>Predictions</h3>
<p>Per default, the <code><a href="../../reference/resample.html">resample()</a></code> result contains the predictions made during the resampling. If you do not want to keep them, e.g., in order to conserve memory, set <code>keep.pred = FALSE</code> when calling <code><a href="../../reference/resample.html">resample()</a></code>.</p>
<p>The predictions are stored in slot <code>$pred</code> of the resampling result, which can also be accessed by function <code><a href="../../reference/getRRPredictions.html">getRRPredictions()</a></code>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>r<span class="op">$</span>pred</span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="co">## Resampled Prediction for:</span></span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="co">## Resample description: subsampling with 5 iterations and 0.80 split rate.</span></span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="co">## Predict: test</span></span>
<span id="cb10-5"><a href="#cb10-5"></a><span class="co">## Stratification: FALSE</span></span>
<span id="cb10-6"><a href="#cb10-6"></a><span class="co">## predict.type: response</span></span>
<span id="cb10-7"><a href="#cb10-7"></a><span class="co">## threshold: </span></span>
<span id="cb10-8"><a href="#cb10-8"></a><span class="co">## time (mean): 0.00</span></span>
<span id="cb10-9"><a href="#cb10-9"></a><span class="co">##    id truth response iter  set</span></span>
<span id="cb10-10"><a href="#cb10-10"></a><span class="co">## 1  18     R        M    1 test</span></span>
<span id="cb10-11"><a href="#cb10-11"></a><span class="co">## 2 189     M        M    1 test</span></span>
<span id="cb10-12"><a href="#cb10-12"></a><span class="co">## 3  88     R        R    1 test</span></span>
<span id="cb10-13"><a href="#cb10-13"></a><span class="co">## 4 121     M        R    1 test</span></span>
<span id="cb10-14"><a href="#cb10-14"></a><span class="co">## 5 165     M        R    1 test</span></span>
<span id="cb10-15"><a href="#cb10-15"></a><span class="co">## 6 111     M        M    1 test</span></span>
<span id="cb10-16"><a href="#cb10-16"></a><span class="co">## ... (#rows: 210, #cols: 5)</span></span>
<span id="cb10-17"><a href="#cb10-17"></a></span>
<span id="cb10-18"><a href="#cb10-18"></a>pred =<span class="st"> </span><span class="kw"><a href="../../reference/getRRPredictions.html">getRRPredictions</a></span>(r)</span>
<span id="cb10-19"><a href="#cb10-19"></a>pred</span>
<span id="cb10-20"><a href="#cb10-20"></a><span class="co">## Resampled Prediction for:</span></span>
<span id="cb10-21"><a href="#cb10-21"></a><span class="co">## Resample description: subsampling with 5 iterations and 0.80 split rate.</span></span>
<span id="cb10-22"><a href="#cb10-22"></a><span class="co">## Predict: test</span></span>
<span id="cb10-23"><a href="#cb10-23"></a><span class="co">## Stratification: FALSE</span></span>
<span id="cb10-24"><a href="#cb10-24"></a><span class="co">## predict.type: response</span></span>
<span id="cb10-25"><a href="#cb10-25"></a><span class="co">## threshold: </span></span>
<span id="cb10-26"><a href="#cb10-26"></a><span class="co">## time (mean): 0.00</span></span>
<span id="cb10-27"><a href="#cb10-27"></a><span class="co">##    id truth response iter  set</span></span>
<span id="cb10-28"><a href="#cb10-28"></a><span class="co">## 1  18     R        M    1 test</span></span>
<span id="cb10-29"><a href="#cb10-29"></a><span class="co">## 2 189     M        M    1 test</span></span>
<span id="cb10-30"><a href="#cb10-30"></a><span class="co">## 3  88     R        R    1 test</span></span>
<span id="cb10-31"><a href="#cb10-31"></a><span class="co">## 4 121     M        R    1 test</span></span>
<span id="cb10-32"><a href="#cb10-32"></a><span class="co">## 5 165     M        R    1 test</span></span>
<span id="cb10-33"><a href="#cb10-33"></a><span class="co">## 6 111     M        M    1 test</span></span>
<span id="cb10-34"><a href="#cb10-34"></a><span class="co">## ... (#rows: 210, #cols: 5)</span></span></code></pre></div>
<p><code>pred</code> is an object of class <code><a href="../../reference/resample.html">resample()</a></code> Prediction. Just as a <code><a href="../../reference/Prediction.html">Prediction()</a></code> object (see the tutorial page on making <a href="predict.html" target="_blank">predictions</a> it has an element <code>$data</code> which is a <code>data.frame</code> that contains the predictions and in the case of a supervised learning problem the true values of the target variable(s). You can use <code>as.data.frame</code> (<code><a href="../../reference/Prediction.html">Prediction()</a></code> to directly access the <code>$data</code> slot. Moreover, all getter functions for <code><a href="../../reference/Prediction.html">Prediction()</a></code> objects like <code><a href="../../reference/getPredictionResponse.html">getPredictionResponse()</a></code> or <code><a href="../../reference/getPredictionProbabilities.html">getPredictionProbabilities()</a></code> are applicable.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>(pred))</span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="co">##    id truth response iter  set</span></span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="co">## 1  66     R        R    1 test</span></span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="co">## 2 170     M        M    1 test</span></span>
<span id="cb11-5"><a href="#cb11-5"></a><span class="co">## 3  90     R        M    1 test</span></span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="co">## 4  26     R        R    1 test</span></span>
<span id="cb11-7"><a href="#cb11-7"></a><span class="co">## 5 187     M        R    1 test</span></span>
<span id="cb11-8"><a href="#cb11-8"></a><span class="co">## 6  89     R        M    1 test</span></span>
<span id="cb11-9"><a href="#cb11-9"></a></span>
<span id="cb11-10"><a href="#cb11-10"></a><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="kw"><a href="../../reference/getPredictionResponse.html">getPredictionTruth</a></span>(pred))</span>
<span id="cb11-11"><a href="#cb11-11"></a><span class="co">## [1] R M R R M R</span></span>
<span id="cb11-12"><a href="#cb11-12"></a><span class="co">## Levels: M R</span></span>
<span id="cb11-13"><a href="#cb11-13"></a></span>
<span id="cb11-14"><a href="#cb11-14"></a><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="kw"><a href="../../reference/getPredictionResponse.html">getPredictionResponse</a></span>(pred))</span>
<span id="cb11-15"><a href="#cb11-15"></a><span class="co">## [1] R M M R R M</span></span>
<span id="cb11-16"><a href="#cb11-16"></a><span class="co">## Levels: M R</span></span></code></pre></div>
<p>The columns <code>iter</code> and <code>set</code> in the <code>data.frame</code> indicate the resampling iteration and the data set (<code>train</code> or <code>test</code>) for which the prediction was made.</p>
<p>By default, predictions are made for the test sets only. If predictions for the training set are required, set <code>predict = "train"</code> (for predictions on the train set only) or <code>predict = "both"</code> (for predictions on both train and test sets) in <code><a href="../../reference/makeResampleDesc.html">makeResampleDesc()</a></code>. In any case, this is necessary for some bootstrap methods (<em>b632</em> and <em>b632+</em>) and some examples are shown later on.</p>
<p>Below, we use simple Holdout, i.e., split the data once into a training and test set, as resampling strategy and make predictions on both sets.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="co"># Make predictions on both training and test sets</span></span>
<span id="cb12-2"><a href="#cb12-2"></a>rdesc =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"Holdout"</span>, <span class="dt">predict =</span> <span class="st">"both"</span>)</span>
<span id="cb12-3"><a href="#cb12-3"></a></span>
<span id="cb12-4"><a href="#cb12-4"></a>r =<span class="st"> </span><span class="kw"><a href="../../reference/resample.html">resample</a></span>(<span class="st">"classif.lda"</span>, iris.task, rdesc, <span class="dt">show.info =</span> <span class="ot">FALSE</span>)</span>
<span id="cb12-5"><a href="#cb12-5"></a>r</span>
<span id="cb12-6"><a href="#cb12-6"></a><span class="co">## Resample Result</span></span>
<span id="cb12-7"><a href="#cb12-7"></a><span class="co">## Task: iris-example</span></span>
<span id="cb12-8"><a href="#cb12-8"></a><span class="co">## Learner: classif.lda</span></span>
<span id="cb12-9"><a href="#cb12-9"></a><span class="co">## Aggr perf: mmce.test.mean=0.0200000</span></span>
<span id="cb12-10"><a href="#cb12-10"></a><span class="co">## Runtime: 0.00993848</span></span>
<span id="cb12-11"><a href="#cb12-11"></a></span>
<span id="cb12-12"><a href="#cb12-12"></a>r<span class="op">$</span>measures.train</span>
<span id="cb12-13"><a href="#cb12-13"></a><span class="co">##   iter mmce</span></span>
<span id="cb12-14"><a href="#cb12-14"></a><span class="co">## 1    1 0.02</span></span></code></pre></div>
<p>(Please note that nonetheless the misclassification rate <code>r$aggr</code> is estimated on the test data only. How to calculate performance measures on the training sets is shown below.)</p>
<p>A second function to extract predictions from resample results is <code><a href="../../reference/getRRPredictionList.html">getRRPredictionList()</a></code> which returns a <code>list</code> of predictions split by data set (train/test) and resampling iteration.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>predList =<span class="st"> </span><span class="kw"><a href="../../reference/getRRPredictionList.html">getRRPredictionList</a></span>(r)</span>
<span id="cb13-2"><a href="#cb13-2"></a>predList</span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="co">## $train</span></span>
<span id="cb13-4"><a href="#cb13-4"></a><span class="co">## $train$`1`</span></span>
<span id="cb13-5"><a href="#cb13-5"></a><span class="co">## Prediction: 100 observations</span></span>
<span id="cb13-6"><a href="#cb13-6"></a><span class="co">## predict.type: response</span></span>
<span id="cb13-7"><a href="#cb13-7"></a><span class="co">## threshold: </span></span>
<span id="cb13-8"><a href="#cb13-8"></a><span class="co">## time: 0.00</span></span>
<span id="cb13-9"><a href="#cb13-9"></a><span class="co">##      id      truth   response</span></span>
<span id="cb13-10"><a href="#cb13-10"></a><span class="co">## 96   96 versicolor versicolor</span></span>
<span id="cb13-11"><a href="#cb13-11"></a><span class="co">## 130 130  virginica  virginica</span></span>
<span id="cb13-12"><a href="#cb13-12"></a><span class="co">## 120 120  virginica  virginica</span></span>
<span id="cb13-13"><a href="#cb13-13"></a><span class="co">## 77   77 versicolor versicolor</span></span>
<span id="cb13-14"><a href="#cb13-14"></a><span class="co">## 23   23     setosa     setosa</span></span>
<span id="cb13-15"><a href="#cb13-15"></a><span class="co">## 59   59 versicolor versicolor</span></span>
<span id="cb13-16"><a href="#cb13-16"></a><span class="co">## ... (#rows: 100, #cols: 3)</span></span>
<span id="cb13-17"><a href="#cb13-17"></a><span class="co">## </span></span>
<span id="cb13-18"><a href="#cb13-18"></a><span class="co">## </span></span>
<span id="cb13-19"><a href="#cb13-19"></a><span class="co">## $test</span></span>
<span id="cb13-20"><a href="#cb13-20"></a><span class="co">## $test$`1`</span></span>
<span id="cb13-21"><a href="#cb13-21"></a><span class="co">## Prediction: 50 observations</span></span>
<span id="cb13-22"><a href="#cb13-22"></a><span class="co">## predict.type: response</span></span>
<span id="cb13-23"><a href="#cb13-23"></a><span class="co">## threshold: </span></span>
<span id="cb13-24"><a href="#cb13-24"></a><span class="co">## time: 0.00</span></span>
<span id="cb13-25"><a href="#cb13-25"></a><span class="co">##      id      truth   response</span></span>
<span id="cb13-26"><a href="#cb13-26"></a><span class="co">## 92   92 versicolor versicolor</span></span>
<span id="cb13-27"><a href="#cb13-27"></a><span class="co">## 58   58 versicolor versicolor</span></span>
<span id="cb13-28"><a href="#cb13-28"></a><span class="co">## 48   48     setosa     setosa</span></span>
<span id="cb13-29"><a href="#cb13-29"></a><span class="co">## 103 103  virginica  virginica</span></span>
<span id="cb13-30"><a href="#cb13-30"></a><span class="co">## 70   70 versicolor versicolor</span></span>
<span id="cb13-31"><a href="#cb13-31"></a><span class="co">## 82   82 versicolor versicolor</span></span>
<span id="cb13-32"><a href="#cb13-32"></a><span class="co">## ... (#rows: 50, #cols: 3)</span></span></code></pre></div>
</div>
<div id="learner-models" class="section level3">
<h3 class="hasAnchor">
<a href="#learner-models" class="anchor"></a>Learner models</h3>
<p>In each resampling iteration a Learner (<code><a href="../../reference/makeLearner.html">makeLearner()</a></code>) is fitted on the respective training set. By default, the resulting <code>WrappedModel</code> (<code><a href="../../reference/makeWrappedModel.html">makeWrappedModel()</a></code>)s are not included in the <code><a href="../../reference/resample.html">resample()</a></code> result and slot <code>$models</code> is empty. In order to keep them, set <code>models = TRUE</code> when calling <code><a href="../../reference/resample.html">resample()</a></code>, as in the following survival analysis example.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="co"># 3-fold cross-validation</span></span>
<span id="cb14-2"><a href="#cb14-2"></a>rdesc =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"CV"</span>, <span class="dt">iters =</span> <span class="dv">3</span>)</span>
<span id="cb14-3"><a href="#cb14-3"></a></span>
<span id="cb14-4"><a href="#cb14-4"></a>r =<span class="st"> </span><span class="kw"><a href="../../reference/resample.html">resample</a></span>(<span class="st">"surv.coxph"</span>, lung.task, rdesc, <span class="dt">show.info =</span> <span class="ot">FALSE</span>, <span class="dt">models =</span> <span class="ot">TRUE</span>)</span>
<span id="cb14-5"><a href="#cb14-5"></a>r<span class="op">$</span>models</span>
<span id="cb14-6"><a href="#cb14-6"></a><span class="co">## [[1]]</span></span>
<span id="cb14-7"><a href="#cb14-7"></a><span class="co">## Model for learner.id=surv.coxph; learner.class=surv.coxph</span></span>
<span id="cb14-8"><a href="#cb14-8"></a><span class="co">## Trained on: task.id = lung-example; obs = 111; features = 8</span></span>
<span id="cb14-9"><a href="#cb14-9"></a><span class="co">## Hyperparameters: </span></span>
<span id="cb14-10"><a href="#cb14-10"></a><span class="co">## </span></span>
<span id="cb14-11"><a href="#cb14-11"></a><span class="co">## [[2]]</span></span>
<span id="cb14-12"><a href="#cb14-12"></a><span class="co">## Model for learner.id=surv.coxph; learner.class=surv.coxph</span></span>
<span id="cb14-13"><a href="#cb14-13"></a><span class="co">## Trained on: task.id = lung-example; obs = 111; features = 8</span></span>
<span id="cb14-14"><a href="#cb14-14"></a><span class="co">## Hyperparameters: </span></span>
<span id="cb14-15"><a href="#cb14-15"></a><span class="co">## </span></span>
<span id="cb14-16"><a href="#cb14-16"></a><span class="co">## [[3]]</span></span>
<span id="cb14-17"><a href="#cb14-17"></a><span class="co">## Model for learner.id=surv.coxph; learner.class=surv.coxph</span></span>
<span id="cb14-18"><a href="#cb14-18"></a><span class="co">## Trained on: task.id = lung-example; obs = 112; features = 8</span></span>
<span id="cb14-19"><a href="#cb14-19"></a><span class="co">## Hyperparameters:</span></span></code></pre></div>
</div>
<div id="the-extract-option" class="section level3">
<h3 class="hasAnchor">
<a href="#the-extract-option" class="anchor"></a>The extract option</h3>
<p>Keeping complete fitted models can be memory-intensive if these objects are large or the number of resampling iterations is high. Alternatively, you can use the <code>extract</code> argument of <code><a href="../../reference/resample.html">resample()</a></code> to retain only the information you need. To this end you need to pass a function to <code>extract</code> which is applied to each <code>WrappedModel</code> (<code><a href="../../reference/makeWrappedModel.html">makeWrappedModel()</a></code>) object fitted in each resampling iteration.</p>
<p>Below, we cluster the <code><a href="https://rdrr.io/r/datasets/mtcars.html">datasets::mtcars()</a></code> data using the <span class="math inline">\(k\)</span>-means algorithm with <span class="math inline">\(k = 3\)</span> and keep only the cluster centers.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="co"># 3-fold cross-validation</span></span>
<span id="cb15-2"><a href="#cb15-2"></a>rdesc =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"CV"</span>, <span class="dt">iters =</span> <span class="dv">3</span>)</span>
<span id="cb15-3"><a href="#cb15-3"></a></span>
<span id="cb15-4"><a href="#cb15-4"></a><span class="co"># Extract the compute cluster centers</span></span>
<span id="cb15-5"><a href="#cb15-5"></a>r =<span class="st"> </span><span class="kw"><a href="../../reference/resample.html">resample</a></span>(<span class="st">"cluster.kmeans"</span>, mtcars.task, rdesc, <span class="dt">show.info =</span> <span class="ot">FALSE</span>,</span>
<span id="cb15-6"><a href="#cb15-6"></a>  <span class="dt">centers =</span> <span class="dv">3</span>, <span class="dt">extract =</span> <span class="cf">function</span>(x) <span class="kw"><a href="../../reference/getLearnerModel.html">getLearnerModel</a></span>(x)<span class="op">$</span>centers)</span>
<span id="cb15-7"><a href="#cb15-7"></a>r<span class="op">$</span>extract</span>
<span id="cb15-8"><a href="#cb15-8"></a><span class="co">## [[1]]</span></span>
<span id="cb15-9"><a href="#cb15-9"></a><span class="co">##        mpg cyl     disp        hp     drat       wt     qsec        vs</span></span>
<span id="cb15-10"><a href="#cb15-10"></a><span class="co">## 1 26.45556   4 107.7556  83.33333 4.094444 2.291444 19.15889 0.8888889</span></span>
<span id="cb15-11"><a href="#cb15-11"></a><span class="co">## 2 14.94444   8 338.2889 208.33333 3.178889 3.894889 16.69889 0.0000000</span></span>
<span id="cb15-12"><a href="#cb15-12"></a><span class="co">## 3 19.57500   6 202.6500 112.00000 3.415000 3.247500 18.89500 0.7500000</span></span>
<span id="cb15-13"><a href="#cb15-13"></a><span class="co">##          am     gear     carb</span></span>
<span id="cb15-14"><a href="#cb15-14"></a><span class="co">## 1 0.6666667 4.111111 1.666667</span></span>
<span id="cb15-15"><a href="#cb15-15"></a><span class="co">## 2 0.1111111 3.222222 3.555556</span></span>
<span id="cb15-16"><a href="#cb15-16"></a><span class="co">## 3 0.2500000 3.500000 2.500000</span></span>
<span id="cb15-17"><a href="#cb15-17"></a><span class="co">## </span></span>
<span id="cb15-18"><a href="#cb15-18"></a><span class="co">## [[2]]</span></span>
<span id="cb15-19"><a href="#cb15-19"></a><span class="co">##        mpg      cyl      disp       hp     drat     wt     qsec        vs</span></span>
<span id="cb15-20"><a href="#cb15-20"></a><span class="co">## 1 18.32857 6.571429 202.40000 142.2857 3.465714 3.3200 17.85429 0.4285714</span></span>
<span id="cb15-21"><a href="#cb15-21"></a><span class="co">## 2 26.73333 4.000000  96.96667  77.5000 4.178333 2.1125 18.70167 0.8333333</span></span>
<span id="cb15-22"><a href="#cb15-22"></a><span class="co">## 3 14.96250 8.000000 387.75000 218.6250 3.238750 4.1955 16.65750 0.0000000</span></span>
<span id="cb15-23"><a href="#cb15-23"></a><span class="co">##          am     gear     carb</span></span>
<span id="cb15-24"><a href="#cb15-24"></a><span class="co">## 1 0.2857143 3.714286 3.571429</span></span>
<span id="cb15-25"><a href="#cb15-25"></a><span class="co">## 2 0.8333333 4.000000 1.333333</span></span>
<span id="cb15-26"><a href="#cb15-26"></a><span class="co">## 3 0.2500000 3.500000 3.750000</span></span>
<span id="cb15-27"><a href="#cb15-27"></a><span class="co">## </span></span>
<span id="cb15-28"><a href="#cb15-28"></a><span class="co">## [[3]]</span></span>
<span id="cb15-29"><a href="#cb15-29"></a><span class="co">##        mpg cyl     disp        hp     drat       wt     qsec  vs        am</span></span>
<span id="cb15-30"><a href="#cb15-30"></a><span class="co">## 1 20.46000   6 178.1200 125.60000 3.684000 2.984000 17.34400 0.4 0.6000000</span></span>
<span id="cb15-31"><a href="#cb15-31"></a><span class="co">## 2 26.87143   4 108.7714  86.14286 3.948571 2.426857 19.48286 1.0 0.7142857</span></span>
<span id="cb15-32"><a href="#cb15-32"></a><span class="co">## 3 15.12222   8 354.2889 208.22222 3.306667 3.983333 16.71889 0.0 0.1111111</span></span>
<span id="cb15-33"><a href="#cb15-33"></a><span class="co">##       gear     carb</span></span>
<span id="cb15-34"><a href="#cb15-34"></a><span class="co">## 1 4.000000 3.800000</span></span>
<span id="cb15-35"><a href="#cb15-35"></a><span class="co">## 2 4.142857 1.571429</span></span>
<span id="cb15-36"><a href="#cb15-36"></a><span class="co">## 3 3.222222 3.333333</span></span></code></pre></div>
<p>As a second example, we extract the variable importances from fitted regression trees using function <code><a href="../../reference/getFeatureImportance.html">getFeatureImportance()</a></code>. (For more detailed information on this topic see the <a href="feature_selection.html" target="_blank">feature selection</a> page.)</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="co"># Extract the variable importance in a regression tree</span></span>
<span id="cb16-2"><a href="#cb16-2"></a>r =<span class="st"> </span><span class="kw"><a href="../../reference/resample.html">resample</a></span>(<span class="st">"regr.rpart"</span>, bh.task, rdesc, <span class="dt">show.info =</span> <span class="ot">FALSE</span>, <span class="dt">extract =</span> getFeatureImportance)</span>
<span id="cb16-3"><a href="#cb16-3"></a>r<span class="op">$</span>extract</span>
<span id="cb16-4"><a href="#cb16-4"></a><span class="co">## [[1]]</span></span>
<span id="cb16-5"><a href="#cb16-5"></a><span class="co">## FeatureImportance:</span></span>
<span id="cb16-6"><a href="#cb16-6"></a><span class="co">## Task: BostonHousing-example</span></span>
<span id="cb16-7"><a href="#cb16-7"></a><span class="co">## </span></span>
<span id="cb16-8"><a href="#cb16-8"></a><span class="co">## Learner: regr.rpart</span></span>
<span id="cb16-9"><a href="#cb16-9"></a><span class="co">## Measure: NA</span></span>
<span id="cb16-10"><a href="#cb16-10"></a><span class="co">## Contrast: NA</span></span>
<span id="cb16-11"><a href="#cb16-11"></a><span class="co">## Aggregation: function (x)  x</span></span>
<span id="cb16-12"><a href="#cb16-12"></a><span class="co">## Replace: NA</span></span>
<span id="cb16-13"><a href="#cb16-13"></a><span class="co">## Number of Monte-Carlo iterations: NA</span></span>
<span id="cb16-14"><a href="#cb16-14"></a><span class="co">## Local: FALSE</span></span>
<span id="cb16-15"><a href="#cb16-15"></a><span class="co">##       crim       zn    indus     chas      nox       rm      age      dis</span></span>
<span id="cb16-16"><a href="#cb16-16"></a><span class="co">## 1 3101.823 1441.936 4512.804 407.3234 4079.684 17790.69 3437.573 3841.604</span></span>
<span id="cb16-17"><a href="#cb16-17"></a><span class="co">##        rad      tax  ptratio        b   lstat</span></span>
<span id="cb16-18"><a href="#cb16-18"></a><span class="co">## 1 139.3927 597.6171 4013.995 469.6105 11842.2</span></span>
<span id="cb16-19"><a href="#cb16-19"></a><span class="co">## </span></span>
<span id="cb16-20"><a href="#cb16-20"></a><span class="co">## [[2]]</span></span>
<span id="cb16-21"><a href="#cb16-21"></a><span class="co">## FeatureImportance:</span></span>
<span id="cb16-22"><a href="#cb16-22"></a><span class="co">## Task: BostonHousing-example</span></span>
<span id="cb16-23"><a href="#cb16-23"></a><span class="co">## </span></span>
<span id="cb16-24"><a href="#cb16-24"></a><span class="co">## Learner: regr.rpart</span></span>
<span id="cb16-25"><a href="#cb16-25"></a><span class="co">## Measure: NA</span></span>
<span id="cb16-26"><a href="#cb16-26"></a><span class="co">## Contrast: NA</span></span>
<span id="cb16-27"><a href="#cb16-27"></a><span class="co">## Aggregation: function (x)  x</span></span>
<span id="cb16-28"><a href="#cb16-28"></a><span class="co">## Replace: NA</span></span>
<span id="cb16-29"><a href="#cb16-29"></a><span class="co">## Number of Monte-Carlo iterations: NA</span></span>
<span id="cb16-30"><a href="#cb16-30"></a><span class="co">## Local: FALSE</span></span>
<span id="cb16-31"><a href="#cb16-31"></a><span class="co">##       crim       zn    indus     chas      nox       rm     age      dis</span></span>
<span id="cb16-32"><a href="#cb16-32"></a><span class="co">## 1 3456.299 1219.795 3972.659 193.0891 2217.923 15577.64 2493.07 225.4885</span></span>
<span id="cb16-33"><a href="#cb16-33"></a><span class="co">##        rad      tax ptratio b    lstat</span></span>
<span id="cb16-34"><a href="#cb16-34"></a><span class="co">## 1 58.27396 2250.441 2558.66 0 9659.698</span></span>
<span id="cb16-35"><a href="#cb16-35"></a><span class="co">## </span></span>
<span id="cb16-36"><a href="#cb16-36"></a><span class="co">## [[3]]</span></span>
<span id="cb16-37"><a href="#cb16-37"></a><span class="co">## FeatureImportance:</span></span>
<span id="cb16-38"><a href="#cb16-38"></a><span class="co">## Task: BostonHousing-example</span></span>
<span id="cb16-39"><a href="#cb16-39"></a><span class="co">## </span></span>
<span id="cb16-40"><a href="#cb16-40"></a><span class="co">## Learner: regr.rpart</span></span>
<span id="cb16-41"><a href="#cb16-41"></a><span class="co">## Measure: NA</span></span>
<span id="cb16-42"><a href="#cb16-42"></a><span class="co">## Contrast: NA</span></span>
<span id="cb16-43"><a href="#cb16-43"></a><span class="co">## Aggregation: function (x)  x</span></span>
<span id="cb16-44"><a href="#cb16-44"></a><span class="co">## Replace: NA</span></span>
<span id="cb16-45"><a href="#cb16-45"></a><span class="co">## Number of Monte-Carlo iterations: NA</span></span>
<span id="cb16-46"><a href="#cb16-46"></a><span class="co">## Local: FALSE</span></span>
<span id="cb16-47"><a href="#cb16-47"></a><span class="co">##       crim       zn    indus chas      nox       rm      age     dis</span></span>
<span id="cb16-48"><a href="#cb16-48"></a><span class="co">## 1 5431.503 2233.188 4145.386    0 3114.175 8294.477 5013.095 1539.99</span></span>
<span id="cb16-49"><a href="#cb16-49"></a><span class="co">##        rad      tax  ptratio        b    lstat</span></span>
<span id="cb16-50"><a href="#cb16-50"></a><span class="co">## 1 630.7023 3062.834 688.6419 104.4289 18634.34</span></span></code></pre></div>
<p>There is also an convenience function <code><a href="../../reference/getResamplingIndices.html">getResamplingIndices()</a></code> to extract the resampling indices from the <code>ResampleResult</code> object:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="kw"><a href="../../reference/getResamplingIndices.html">getResamplingIndices</a></span>(r)</span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="co">## $train.inds</span></span>
<span id="cb17-3"><a href="#cb17-3"></a><span class="co">## $train.inds[[1]]</span></span>
<span id="cb17-4"><a href="#cb17-4"></a><span class="co">##   [1] 366 235  79 466 361  88  16 346 218 438 444 397  55 456 327 226  38</span></span>
<span id="cb17-5"><a href="#cb17-5"></a><span class="co">##  [18] 172 252 500 450 464 149 136  71  47 423 208 203 462 205 116 350 129</span></span>
<span id="cb17-6"><a href="#cb17-6"></a><span class="co">##  [35] 261 243 490 241 406 430 340 420  10 277 100 190  26 188 437 130 282</span></span>
<span id="cb17-7"><a href="#cb17-7"></a><span class="co">##  [52] 225 328 317  95  51 398 237 285 146  24 238 223   5 152 300 232 151</span></span>
<span id="cb17-8"><a href="#cb17-8"></a><span class="co">##  [69] 169 383 470  42  83 322 179 198 162 103 220 382 202 240 125 443 256</span></span>
<span id="cb17-9"><a href="#cb17-9"></a><span class="co">##  [86]  43  32  77 275 426 181 273 451 142 332 442 257 119 489  39 305  63</span></span>
<span id="cb17-10"><a href="#cb17-10"></a><span class="co">## [103] 127 263 424 289  60  78  59 314 148  90 387 455 411 502  65 267 269</span></span>
<span id="cb17-11"><a href="#cb17-11"></a><span class="co">## [120] 176  31 484  70 196 435 439 492 410 473 313 154 506 210 377 499 482</span></span>
<span id="cb17-12"><a href="#cb17-12"></a><span class="co">## [137]  96 431 452  49  92 178 270 265 219 461 297 415 120  58 333 117 497</span></span>
<span id="cb17-13"><a href="#cb17-13"></a><span class="co">## [154] 349 141 266 445 164  36 329 389  81 339  98 348 380 474  13 221 414</span></span>
<span id="cb17-14"><a href="#cb17-14"></a><span class="co">## [171] 264 375 352 107  12 308 280 384 177 295 143 165 126 227 189 393 447</span></span>
<span id="cb17-15"><a href="#cb17-15"></a><span class="co">## [188] 183  50 290 209 360 504  27 139 402 255 422 312 315 372 251 491 104</span></span>
<span id="cb17-16"><a href="#cb17-16"></a><span class="co">## [205] 416 400 138 501 330 454 485 199 417 302 498  56 413 460   2 428 351</span></span>
<span id="cb17-17"><a href="#cb17-17"></a><span class="co">## [222] 156 356 163 215 197 394 288 354 376 448 171 287 390 242 370   7 303</span></span>
<span id="cb17-18"><a href="#cb17-18"></a><span class="co">## [239] 167  45  91 353 344 102 403 274  64 106  76 294 419 378 228 204  73</span></span>
<span id="cb17-19"><a href="#cb17-19"></a><span class="co">## [256] 379 284 463 161 355 323 272  87 111 418  53  21 316  94 486 131 381</span></span>
<span id="cb17-20"><a href="#cb17-20"></a><span class="co">## [273] 293 425  85 388 214 345 276 182  61 108 325 145  68 246 121  19 427</span></span>
<span id="cb17-21"><a href="#cb17-21"></a><span class="co">## [290]   6 234 259  35 341 133 391  67 175 421 195  99 216 365 503 248  44</span></span>
<span id="cb17-22"><a href="#cb17-22"></a><span class="co">## [307] 173 459 236  11 286  52 296 335 475 144 359 432 429 331 114 123 113</span></span>
<span id="cb17-23"><a href="#cb17-23"></a><span class="co">## [324] 311   4 186  86 187 279 268 140 409 363 206  84   3 192</span></span>
<span id="cb17-24"><a href="#cb17-24"></a><span class="co">## </span></span>
<span id="cb17-25"><a href="#cb17-25"></a><span class="co">## $train.inds[[2]]</span></span>
<span id="cb17-26"><a href="#cb17-26"></a><span class="co">##   [1] 235  79 249  16 212 456 457 105  38 449 172 357  72 500  20   9 321</span></span>
<span id="cb17-27"><a href="#cb17-27"></a><span class="co">##  [18] 436 458 385 200  47 208 396 193 205 350 129 261 496 241 132 278 406</span></span>
<span id="cb17-28"><a href="#cb17-28"></a><span class="co">##  [35]  25 340 118 306 440 453 277  80 188  54 224 225 328  95  51 319 505</span></span>
<span id="cb17-29"><a href="#cb17-29"></a><span class="co">##  [52] 247  97 238 223   5 407  62  22 300 153 309 358  46  17 383 322 198</span></span>
<span id="cb17-30"><a href="#cb17-30"></a><span class="co">##  [69] 162 441 202 240  40 125 230 194 426 343 433 181 273 451 434  82 142</span></span>
<span id="cb17-31"><a href="#cb17-31"></a><span class="co">##  [86] 332 442 467 489  39 127 263  48 364 367 326 101 362 347 471 338 213</span></span>
<span id="cb17-32"><a href="#cb17-32"></a><span class="co">## [103] 124  60 401 185 314 148  18 387 455 411 476 502  65 488 260 267 336</span></span>
<span id="cb17-33"><a href="#cb17-33"></a><span class="co">## [120]  34 484 410 313 154 271  29 210 377 499 482 320 166 307 483 431 452</span></span>
<span id="cb17-34"><a href="#cb17-34"></a><span class="co">## [137]  92 178 211 494 270 477 170 404 265  30 219 304 231 461 297 495   8</span></span>
<span id="cb17-35"><a href="#cb17-35"></a><span class="co">## [154] 117 374 262 266 164  36 368 155 329 334 389 412 339 337  98 134 479</span></span>
<span id="cb17-36"><a href="#cb17-36"></a><span class="co">## [171] 380 184 115  13  57 414 264  23 352 229 157 384 150 177 250 165 126</span></span>
<span id="cb17-37"><a href="#cb17-37"></a><span class="co">## [188] 227 147 258 487  50 290 465 174 292 209  93 504  27 139 422 310 245</span></span>
<span id="cb17-38"><a href="#cb17-38"></a><span class="co">## [205] 222 491 299  33 416 399 138 480 501 330 199 342 168 493 128 137 233</span></span>
<span id="cb17-39"><a href="#cb17-39"></a><span class="co">## [222]  41  56 180 428 156 478 163 215 197 394 376 135 386 287 242   7 239</span></span>
<span id="cb17-40"><a href="#cb17-40"></a><span class="co">## [239]  69 468 353  89 472 344   1 481 102 274  64 395 110  76  37  74  14</span></span>
<span id="cb17-41"><a href="#cb17-41"></a><span class="co">## [256] 298 294 419 318 228 122 371  73 463 161 355 272  87 369 111 112 418</span></span>
<span id="cb17-42"><a href="#cb17-42"></a><span class="co">## [273] 254 283  53 316  94 159 131 293 425  28 324 281 345 217 109 276 446</span></span>
<span id="cb17-43"><a href="#cb17-43"></a><span class="co">## [290] 182 325 145  68 158 121  19 405   6 259 341 201 291 391  67  15 421</span></span>
<span id="cb17-44"><a href="#cb17-44"></a><span class="co">## [307] 195 301 503  44 244  66 236  11 286 408  52 144 432 429 253 207   4</span></span>
<span id="cb17-45"><a href="#cb17-45"></a><span class="co">## [324]  86 392 187 268  75 409 363 160 373 206  84 469 192 191</span></span>
<span id="cb17-46"><a href="#cb17-46"></a><span class="co">## </span></span>
<span id="cb17-47"><a href="#cb17-47"></a><span class="co">## $train.inds[[3]]</span></span>
<span id="cb17-48"><a href="#cb17-48"></a><span class="co">##   [1] 366 249 466 361  88 346 218 212 438 444 397  55 457 105 327 226 449</span></span>
<span id="cb17-49"><a href="#cb17-49"></a><span class="co">##  [18] 357 252  72  20   9 321 450 436 458 385 464 149 200 136  71 423 396</span></span>
<span id="cb17-50"><a href="#cb17-50"></a><span class="co">##  [35] 203 193 462 116 243 496 490 132 278 430  25 420 118  10 306 440 453</span></span>
<span id="cb17-51"><a href="#cb17-51"></a><span class="co">##  [52] 100 190  26  80  54 437 130 224 282 317 319 398 505 237 247 285 146</span></span>
<span id="cb17-52"><a href="#cb17-52"></a><span class="co">##  [69]  97  24 407  62  22 152 153 232 309 358 151  46  17 169 470  42  83</span></span>
<span id="cb17-53"><a href="#cb17-53"></a><span class="co">##  [86] 179 103 441 220 382  40 230 443 256  43  32  77 275 194 343 433 434</span></span>
<span id="cb17-54"><a href="#cb17-54"></a><span class="co">## [103]  82 257 119 467 305  63 424  48 289 364 367 326 101 362 347 471 338</span></span>
<span id="cb17-55"><a href="#cb17-55"></a><span class="co">## [120] 213 124 401 185  78  59  90  18 476 488 260 336 269  34 176  31  70</span></span>
<span id="cb17-56"><a href="#cb17-56"></a><span class="co">## [137] 196 435 439 492 473 271 506  29 320 166 307  96 483  49 211 494 477</span></span>
<span id="cb17-57"><a href="#cb17-57"></a><span class="co">## [154] 170 404  30 304 231 415 120 495  58   8 333 374 497 349 141 262 445</span></span>
<span id="cb17-58"><a href="#cb17-58"></a><span class="co">## [171] 368 155 334 412  81 337 134 479 348 474 184 115  57 221  23 375 107</span></span>
<span id="cb17-59"><a href="#cb17-59"></a><span class="co">## [188]  12 308 280 229 157 150 250 295 143 147 189 258 393 447 487 183 465</span></span>
<span id="cb17-60"><a href="#cb17-60"></a><span class="co">## [205] 174 292 360  93 402 255 312 315 310 372 245 251 222 104 299  33 399</span></span>
<span id="cb17-61"><a href="#cb17-61"></a><span class="co">## [222] 400 480 454 485 342 168 417 493 128 137 302 233 498  41 413 460   2</span></span>
<span id="cb17-62"><a href="#cb17-62"></a><span class="co">## [239] 180 351 478 356 288 354 135 448 386 171 390 370 239 303 167  45  69</span></span>
<span id="cb17-63"><a href="#cb17-63"></a><span class="co">## [256] 468  91  89 472   1 481 403 395 110 106  37  74  14 298 318 378 122</span></span>
<span id="cb17-64"><a href="#cb17-64"></a><span class="co">## [273] 204 371 379 284 323 369 112 254 283  21 486 159 381  28  85 388 324</span></span>
<span id="cb17-65"><a href="#cb17-65"></a><span class="co">## [290] 281 214 217 109 446  61 108 246 158 405 427 234  35 133 201 291  15</span></span>
<span id="cb17-66"><a href="#cb17-66"></a><span class="co">## [307] 175 301  99 216 365 248 244  66 173 459 408 296 335 475 359 331 253</span></span>
<span id="cb17-67"><a href="#cb17-67"></a><span class="co">## [324] 114 123 207 113 311 186 392 279 140  75 160 373 469   3 191</span></span>
<span id="cb17-68"><a href="#cb17-68"></a><span class="co">## </span></span>
<span id="cb17-69"><a href="#cb17-69"></a><span class="co">## </span></span>
<span id="cb17-70"><a href="#cb17-70"></a><span class="co">## $test.inds</span></span>
<span id="cb17-71"><a href="#cb17-71"></a><span class="co">## $test.inds[[1]]</span></span>
<span id="cb17-72"><a href="#cb17-72"></a><span class="co">##   [1]   1   8   9  14  15  17  18  20  22  23  25  28  29  30  33  34  37</span></span>
<span id="cb17-73"><a href="#cb17-73"></a><span class="co">##  [18]  40  41  46  48  54  57  62  66  69  72  74  75  80  82  89  93  97</span></span>
<span id="cb17-74"><a href="#cb17-74"></a><span class="co">##  [35] 101 105 109 110 112 115 118 122 124 128 132 134 135 137 147 150 153</span></span>
<span id="cb17-75"><a href="#cb17-75"></a><span class="co">##  [52] 155 157 158 159 160 166 168 170 174 180 184 185 191 193 194 200 201</span></span>
<span id="cb17-76"><a href="#cb17-76"></a><span class="co">##  [69] 207 211 212 213 217 222 224 229 230 231 233 239 244 245 247 249 250</span></span>
<span id="cb17-77"><a href="#cb17-77"></a><span class="co">##  [86] 253 254 258 260 262 271 278 281 283 291 292 298 299 301 304 306 307</span></span>
<span id="cb17-78"><a href="#cb17-78"></a><span class="co">## [103] 309 310 318 319 320 321 324 326 334 336 337 338 342 343 347 357 358</span></span>
<span id="cb17-79"><a href="#cb17-79"></a><span class="co">## [120] 362 364 367 368 369 371 373 374 385 386 392 395 396 399 401 404 405</span></span>
<span id="cb17-80"><a href="#cb17-80"></a><span class="co">## [137] 407 408 412 433 434 436 440 441 446 449 453 457 458 465 467 468 469</span></span>
<span id="cb17-81"><a href="#cb17-81"></a><span class="co">## [154] 471 472 476 477 478 479 480 481 483 487 488 493 494 495 496 505</span></span>
<span id="cb17-82"><a href="#cb17-82"></a><span class="co">## </span></span>
<span id="cb17-83"><a href="#cb17-83"></a><span class="co">## $test.inds[[2]]</span></span>
<span id="cb17-84"><a href="#cb17-84"></a><span class="co">##   [1]   2   3  10  12  21  24  26  31  32  35  42  43  45  49  55  58  59</span></span>
<span id="cb17-85"><a href="#cb17-85"></a><span class="co">##  [18]  61  63  70  71  77  78  81  83  85  88  90  91  96  99 100 103 104</span></span>
<span id="cb17-86"><a href="#cb17-86"></a><span class="co">##  [35] 106 107 108 113 114 116 119 120 123 130 133 136 140 141 143 146 149</span></span>
<span id="cb17-87"><a href="#cb17-87"></a><span class="co">##  [52] 151 152 167 169 171 173 175 176 179 183 186 189 190 196 203 204 214</span></span>
<span id="cb17-88"><a href="#cb17-88"></a><span class="co">##  [69] 216 218 220 221 226 232 234 237 243 246 248 251 252 255 256 257 269</span></span>
<span id="cb17-89"><a href="#cb17-89"></a><span class="co">##  [86] 275 279 280 282 284 285 288 289 295 296 302 303 305 308 311 312 315</span></span>
<span id="cb17-90"><a href="#cb17-90"></a><span class="co">## [103] 317 323 327 331 333 335 346 348 349 351 354 356 359 360 361 365 366</span></span>
<span id="cb17-91"><a href="#cb17-91"></a><span class="co">## [120] 370 372 375 378 379 381 382 388 390 393 397 398 400 402 403 413 415</span></span>
<span id="cb17-92"><a href="#cb17-92"></a><span class="co">## [137] 417 420 423 424 427 430 435 437 438 439 443 444 445 447 448 450 454</span></span>
<span id="cb17-93"><a href="#cb17-93"></a><span class="co">## [154] 459 460 462 464 466 470 473 474 475 485 486 490 492 497 498 506</span></span>
<span id="cb17-94"><a href="#cb17-94"></a><span class="co">## </span></span>
<span id="cb17-95"><a href="#cb17-95"></a><span class="co">## $test.inds[[3]]</span></span>
<span id="cb17-96"><a href="#cb17-96"></a><span class="co">##   [1]   4   5   6   7  11  13  16  19  27  36  38  39  44  47  50  51  52</span></span>
<span id="cb17-97"><a href="#cb17-97"></a><span class="co">##  [18]  53  56  60  64  65  67  68  73  76  79  84  86  87  92  94  95  98</span></span>
<span id="cb17-98"><a href="#cb17-98"></a><span class="co">##  [35] 102 111 117 121 125 126 127 129 131 138 139 142 144 145 148 154 156</span></span>
<span id="cb17-99"><a href="#cb17-99"></a><span class="co">##  [52] 161 162 163 164 165 172 177 178 181 182 187 188 192 195 197 198 199</span></span>
<span id="cb17-100"><a href="#cb17-100"></a><span class="co">##  [69] 202 205 206 208 209 210 215 219 223 225 227 228 235 236 238 240 241</span></span>
<span id="cb17-101"><a href="#cb17-101"></a><span class="co">##  [86] 242 259 261 263 264 265 266 267 268 270 272 273 274 276 277 286 287</span></span>
<span id="cb17-102"><a href="#cb17-102"></a><span class="co">## [103] 290 293 294 297 300 313 314 316 322 325 328 329 330 332 339 340 341</span></span>
<span id="cb17-103"><a href="#cb17-103"></a><span class="co">## [120] 344 345 350 352 353 355 363 376 377 380 383 384 387 389 391 394 406</span></span>
<span id="cb17-104"><a href="#cb17-104"></a><span class="co">## [137] 409 410 411 414 416 418 419 421 422 425 426 428 429 431 432 442 451</span></span>
<span id="cb17-105"><a href="#cb17-105"></a><span class="co">## [154] 452 455 456 461 463 482 484 489 491 499 500 501 502 503 504</span></span></code></pre></div>
</div>
</div>
<div id="stratification-blocking-and-grouping" class="section level2">
<h2 class="hasAnchor">
<a href="#stratification-blocking-and-grouping" class="anchor"></a>Stratification, Blocking and Grouping</h2>
<ul>
<li><p><em>Stratification</em> with respect to a categorical variable makes sure that all its values are present in each training and test set in approximately the same proportion as in the original data set. Stratification is possible with regard to categorical target variables (and thus for supervised classification and survival analysis) or categorical explanatory variables.</p></li>
<li><p><em>Blocking</em> refers to the situation that subsets of observations belong together and must not be separated during resampling. Hence, for one train/test set pair the entire block is either in the training set or in the test set.</p></li>
<li><p><em>Grouping</em> means that the folds are composed out of a factor vector given by the user. In this setting no repetitions are possible as all folds are predefined. The approach can also be used in a nested resampling setting. Note the subtle but important difference to “Blocking”: In “Blocking” factor levels are respected when splitting into train and test (e.g. the test set could be composed out of two given factor levels) whereas in “Grouping” the folds will strictly follow the factor level grouping (meaning that the test set will always only consist of one factor level).</p></li>
</ul>
<div id="stratification-with-respect-to-the-target-variables" class="section level3">
<h3 class="hasAnchor">
<a href="#stratification-with-respect-to-the-target-variables" class="anchor"></a>Stratification with respect to the target variable(s)</h3>
<p>For classification, it is usually desirable to have the same proportion of the classes in all of the partitions of the original data set. This is particularly useful in the case of imbalanced classes and small data sets. Otherwise, it may happen that observations of less frequent classes are missing in some of the training sets which can decrease the performance of the learner, or lead to model crashes. In order to conduct stratified resampling, set <code>stratify = TRUE</code> in <code><a href="../../reference/makeResampleDesc.html">makeResampleDesc()</a></code>.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="co"># 3-fold cross-validation</span></span>
<span id="cb18-2"><a href="#cb18-2"></a>rdesc =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"CV"</span>, <span class="dt">iters =</span> <span class="dv">3</span>, <span class="dt">stratify =</span> <span class="ot">TRUE</span>)</span>
<span id="cb18-3"><a href="#cb18-3"></a></span>
<span id="cb18-4"><a href="#cb18-4"></a>r =<span class="st"> </span><span class="kw"><a href="../../reference/resample.html">resample</a></span>(<span class="st">"classif.lda"</span>, iris.task, rdesc, <span class="dt">show.info =</span> <span class="ot">FALSE</span>)</span>
<span id="cb18-5"><a href="#cb18-5"></a>r</span>
<span id="cb18-6"><a href="#cb18-6"></a><span class="co">## Resample Result</span></span>
<span id="cb18-7"><a href="#cb18-7"></a><span class="co">## Task: iris-example</span></span>
<span id="cb18-8"><a href="#cb18-8"></a><span class="co">## Learner: classif.lda</span></span>
<span id="cb18-9"><a href="#cb18-9"></a><span class="co">## Aggr perf: mmce.test.mean=0.0200000</span></span>
<span id="cb18-10"><a href="#cb18-10"></a><span class="co">## Runtime: 0.0176296</span></span></code></pre></div>
<p>Stratification is also available for survival tasks. Here the stratification balances the censoring rate.</p>
</div>
<div id="stratification-with-respect-to-explanatory-variables" class="section level3">
<h3 class="hasAnchor">
<a href="#stratification-with-respect-to-explanatory-variables" class="anchor"></a>Stratification with respect to explanatory variables</h3>
<p>Sometimes it is required to also stratify on the input data, e.g., to ensure that all subgroups are represented in all training and test sets. To stratify on the input columns, specify <code>factor</code> columns of your task data via <code>stratify.cols</code>.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>rdesc =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"CV"</span>, <span class="dt">iters =</span> <span class="dv">3</span>, <span class="dt">stratify.cols =</span> <span class="st">"chas"</span>)</span>
<span id="cb19-2"><a href="#cb19-2"></a></span>
<span id="cb19-3"><a href="#cb19-3"></a>r =<span class="st"> </span><span class="kw"><a href="../../reference/resample.html">resample</a></span>(<span class="st">"regr.rpart"</span>, bh.task, rdesc, <span class="dt">show.info =</span> <span class="ot">FALSE</span>)</span>
<span id="cb19-4"><a href="#cb19-4"></a>r</span>
<span id="cb19-5"><a href="#cb19-5"></a><span class="co">## Resample Result</span></span>
<span id="cb19-6"><a href="#cb19-6"></a><span class="co">## Task: BostonHousing-example</span></span>
<span id="cb19-7"><a href="#cb19-7"></a><span class="co">## Learner: regr.rpart</span></span>
<span id="cb19-8"><a href="#cb19-8"></a><span class="co">## Aggr perf: mse.test.mean=23.8843587</span></span>
<span id="cb19-9"><a href="#cb19-9"></a><span class="co">## Runtime: 0.0268815</span></span></code></pre></div>
</div>
<div id="blocking-cv-with-flexible-predefined-indices" class="section level3">
<h3 class="hasAnchor">
<a href="#blocking-cv-with-flexible-predefined-indices" class="anchor"></a>Blocking: CV with flexible predefined indices</h3>
<p>If some observations “belong together” and must not be separated when splitting the data into training and test sets for resampling, you can supply this information via a <code>blocking</code> factor when creating the <a href="task.html" target="_blank">task</a>.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="co"># 5 blocks containing 30 observations each</span></span>
<span id="cb20-2"><a href="#cb20-2"></a>task =<span class="st"> </span><span class="kw"><a href="../../reference/ClassifTask.html">makeClassifTask</a></span>(<span class="dt">data =</span> iris, <span class="dt">target =</span> <span class="st">"Species"</span>, <span class="dt">blocking =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dt">each =</span> <span class="dv">30</span>)))</span>
<span id="cb20-3"><a href="#cb20-3"></a>task</span>
<span id="cb20-4"><a href="#cb20-4"></a><span class="co">## Supervised task: iris</span></span>
<span id="cb20-5"><a href="#cb20-5"></a><span class="co">## Type: classif</span></span>
<span id="cb20-6"><a href="#cb20-6"></a><span class="co">## Target: Species</span></span>
<span id="cb20-7"><a href="#cb20-7"></a><span class="co">## Observations: 150</span></span>
<span id="cb20-8"><a href="#cb20-8"></a><span class="co">## Features:</span></span>
<span id="cb20-9"><a href="#cb20-9"></a><span class="co">##    numerics     factors     ordered functionals </span></span>
<span id="cb20-10"><a href="#cb20-10"></a><span class="co">##           4           0           0           0 </span></span>
<span id="cb20-11"><a href="#cb20-11"></a><span class="co">## Missings: FALSE</span></span>
<span id="cb20-12"><a href="#cb20-12"></a><span class="co">## Has weights: FALSE</span></span>
<span id="cb20-13"><a href="#cb20-13"></a><span class="co">## Has blocking: TRUE</span></span>
<span id="cb20-14"><a href="#cb20-14"></a><span class="co">## Has coordinates: FALSE</span></span>
<span id="cb20-15"><a href="#cb20-15"></a><span class="co">## Classes: 3</span></span>
<span id="cb20-16"><a href="#cb20-16"></a><span class="co">##     setosa versicolor  virginica </span></span>
<span id="cb20-17"><a href="#cb20-17"></a><span class="co">##         50         50         50 </span></span>
<span id="cb20-18"><a href="#cb20-18"></a><span class="co">## Positive class: NA</span></span></code></pre></div>
<p>When performing a simple “CV” resampling and inspecting the result, we see that the training indices in fold 1 correspond to the specified grouping set in <code>blocking</code> in the task. To initiate this method, we need to set <code>blocking.cv = TRUE</code> when creating the resample description object.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>rdesc =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"CV"</span>, <span class="dt">iters =</span> <span class="dv">3</span>, <span class="dt">blocking.cv =</span> <span class="ot">TRUE</span>)</span>
<span id="cb21-2"><a href="#cb21-2"></a>p =<span class="st"> </span><span class="kw"><a href="../../reference/resample.html">resample</a></span>(<span class="st">"classif.lda"</span>, task, rdesc)</span>
<span id="cb21-3"><a href="#cb21-3"></a><span class="co">## Resampling: cross-validation</span></span>
<span id="cb21-4"><a href="#cb21-4"></a><span class="co">## Measures:             mmce</span></span>
<span id="cb21-5"><a href="#cb21-5"></a><span class="co">## [Resample] iter 1:    0.0000000</span></span>
<span id="cb21-6"><a href="#cb21-6"></a><span class="co">## [Resample] iter 2:    0.0500000</span></span>
<span id="cb21-7"><a href="#cb21-7"></a><span class="co">## [Resample] iter 3:    0.0500000</span></span>
<span id="cb21-8"><a href="#cb21-8"></a><span class="co">## </span></span>
<span id="cb21-9"><a href="#cb21-9"></a><span class="co">## Aggregated Result: mmce.test.mean=0.0333333</span></span>
<span id="cb21-10"><a href="#cb21-10"></a><span class="co">## </span></span>
<span id="cb21-11"><a href="#cb21-11"></a></span>
<span id="cb21-12"><a href="#cb21-12"></a><span class="kw"><a href="https://rdrr.io/r/base/sort.html">sort</a></span>(p<span class="op">$</span>pred<span class="op">$</span>instance<span class="op">$</span>train.inds[[<span class="dv">1</span>]])</span>
<span id="cb21-13"><a href="#cb21-13"></a><span class="co">##   [1]  31  32  33  34  35  36  37  38  39  40  41  42  43  44  45  46  47</span></span>
<span id="cb21-14"><a href="#cb21-14"></a><span class="co">##  [18]  48  49  50  51  52  53  54  55  56  57  58  59  60  61  62  63  64</span></span>
<span id="cb21-15"><a href="#cb21-15"></a><span class="co">##  [35]  65  66  67  68  69  70  71  72  73  74  75  76  77  78  79  80  81</span></span>
<span id="cb21-16"><a href="#cb21-16"></a><span class="co">##  [52]  82  83  84  85  86  87  88  89  90  91  92  93  94  95  96  97  98</span></span>
<span id="cb21-17"><a href="#cb21-17"></a><span class="co">##  [69]  99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115</span></span>
<span id="cb21-18"><a href="#cb21-18"></a><span class="co">##  [86] 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132</span></span>
<span id="cb21-19"><a href="#cb21-19"></a><span class="co">## [103] 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149</span></span>
<span id="cb21-20"><a href="#cb21-20"></a><span class="co">## [120] 150</span></span></code></pre></div>
<p>However, please note the effects of this method: The created folds will not have the same size! Here, Fold 1 has a 120/30 split while the other two folds have a 90/60 split.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(p<span class="op">$</span>pred<span class="op">$</span>instance<span class="op">$</span>train.inds, <span class="cf">function</span>(x) <span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(x))</span>
<span id="cb22-2"><a href="#cb22-2"></a><span class="co">## [[1]]</span></span>
<span id="cb22-3"><a href="#cb22-3"></a><span class="co">## [1] 120</span></span>
<span id="cb22-4"><a href="#cb22-4"></a><span class="co">## </span></span>
<span id="cb22-5"><a href="#cb22-5"></a><span class="co">## [[2]]</span></span>
<span id="cb22-6"><a href="#cb22-6"></a><span class="co">## [1] 90</span></span>
<span id="cb22-7"><a href="#cb22-7"></a><span class="co">## </span></span>
<span id="cb22-8"><a href="#cb22-8"></a><span class="co">## [[3]]</span></span>
<span id="cb22-9"><a href="#cb22-9"></a><span class="co">## [1] 90</span></span></code></pre></div>
<p>This is caused by the fact that we supplied five groups that must belong together but only used a three fold resampling strategy here.</p>
</div>
<div id="grouping-cv-with-fixed-predefined-indices" class="section level3">
<h3 class="hasAnchor">
<a href="#grouping-cv-with-fixed-predefined-indices" class="anchor"></a>Grouping: CV with fixed predefined indices</h3>
<p>There is a second way of using predefined indices in resampling in <code>mlr</code>: Constructing the folds based on the supplied indices in <code>blocking</code>. We refer to this method here as “grouping” to distinguish it from “blocking”. This method is more restrictive in the way that it will always use the number of levels supplied via <code>blocking</code> as the number of folds. To use this method, we need to set <code>fixed = TRUE</code> instead of <code>blocking.cv</code> when creating the resampling description object.</p>
<p>We can leave out the <code>iters</code> argument, as it will be set internally to the number of supplied factor levels.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>rdesc =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"CV"</span>, <span class="dt">fixed =</span> <span class="ot">TRUE</span>)</span>
<span id="cb23-2"><a href="#cb23-2"></a>p =<span class="st"> </span><span class="kw"><a href="../../reference/resample.html">resample</a></span>(<span class="st">"classif.lda"</span>, task, rdesc)</span>
<span id="cb23-3"><a href="#cb23-3"></a><span class="co">## Warning in instantiateResampleInstance.CVDesc(desc, size, task): Adjusting</span></span>
<span id="cb23-4"><a href="#cb23-4"></a><span class="co">## levels to match number of blocking levels.</span></span>
<span id="cb23-5"><a href="#cb23-5"></a><span class="co">## Resampling: cross-validation</span></span>
<span id="cb23-6"><a href="#cb23-6"></a><span class="co">## Measures:             mmce</span></span>
<span id="cb23-7"><a href="#cb23-7"></a><span class="co">## [Resample] iter 1:    0.0000000</span></span>
<span id="cb23-8"><a href="#cb23-8"></a><span class="co">## [Resample] iter 2:    0.1000000</span></span>
<span id="cb23-9"><a href="#cb23-9"></a><span class="co">## [Resample] iter 3:    0.0000000</span></span>
<span id="cb23-10"><a href="#cb23-10"></a><span class="co">## [Resample] iter 4:    0.1000000</span></span>
<span id="cb23-11"><a href="#cb23-11"></a><span class="co">## [Resample] iter 5:    0.0000000</span></span>
<span id="cb23-12"><a href="#cb23-12"></a><span class="co">## </span></span>
<span id="cb23-13"><a href="#cb23-13"></a><span class="co">## Aggregated Result: mmce.test.mean=0.0400000</span></span>
<span id="cb23-14"><a href="#cb23-14"></a><span class="co">## </span></span>
<span id="cb23-15"><a href="#cb23-15"></a><span class="kw"><a href="https://rdrr.io/r/base/sort.html">sort</a></span>(p<span class="op">$</span>pred<span class="op">$</span>instance<span class="op">$</span>train.inds[[<span class="dv">1</span>]])</span>
<span id="cb23-16"><a href="#cb23-16"></a><span class="co">##   [1]  31  32  33  34  35  36  37  38  39  40  41  42  43  44  45  46  47</span></span>
<span id="cb23-17"><a href="#cb23-17"></a><span class="co">##  [18]  48  49  50  51  52  53  54  55  56  57  58  59  60  61  62  63  64</span></span>
<span id="cb23-18"><a href="#cb23-18"></a><span class="co">##  [35]  65  66  67  68  69  70  71  72  73  74  75  76  77  78  79  80  81</span></span>
<span id="cb23-19"><a href="#cb23-19"></a><span class="co">##  [52]  82  83  84  85  86  87  88  89  90  91  92  93  94  95  96  97  98</span></span>
<span id="cb23-20"><a href="#cb23-20"></a><span class="co">##  [69]  99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115</span></span>
<span id="cb23-21"><a href="#cb23-21"></a><span class="co">##  [86] 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132</span></span>
<span id="cb23-22"><a href="#cb23-22"></a><span class="co">## [103] 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149</span></span>
<span id="cb23-23"><a href="#cb23-23"></a><span class="co">## [120] 150</span></span></code></pre></div>
<p>You can see that we automatically created five folds in which the test set always corresponds to one factor level.</p>
<p>Doing it this way also means that we cannot do repeated CV because there is no way to create multiple shuffled folds of this fixed arrangement.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(p<span class="op">$</span>pred<span class="op">$</span>instance<span class="op">$</span>train.inds, <span class="cf">function</span>(x) <span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(x))</span>
<span id="cb24-2"><a href="#cb24-2"></a><span class="co">## [[1]]</span></span>
<span id="cb24-3"><a href="#cb24-3"></a><span class="co">## [1] 120</span></span>
<span id="cb24-4"><a href="#cb24-4"></a><span class="co">## </span></span>
<span id="cb24-5"><a href="#cb24-5"></a><span class="co">## [[2]]</span></span>
<span id="cb24-6"><a href="#cb24-6"></a><span class="co">## [1] 120</span></span>
<span id="cb24-7"><a href="#cb24-7"></a><span class="co">## </span></span>
<span id="cb24-8"><a href="#cb24-8"></a><span class="co">## [[3]]</span></span>
<span id="cb24-9"><a href="#cb24-9"></a><span class="co">## [1] 120</span></span>
<span id="cb24-10"><a href="#cb24-10"></a><span class="co">## </span></span>
<span id="cb24-11"><a href="#cb24-11"></a><span class="co">## [[4]]</span></span>
<span id="cb24-12"><a href="#cb24-12"></a><span class="co">## [1] 120</span></span>
<span id="cb24-13"><a href="#cb24-13"></a><span class="co">## </span></span>
<span id="cb24-14"><a href="#cb24-14"></a><span class="co">## [[5]]</span></span>
<span id="cb24-15"><a href="#cb24-15"></a><span class="co">## [1] 120</span></span></code></pre></div>
<p>However, this method can also be used in nested resampling settings (e.g. in hyperparameter tuning). In the inner level, the factor levels are honored and the function simply creates one fold less than in the outer level.</p>
<p>Please note that the <code>iters</code> argument has no effect in <code><a href="../../reference/makeResampleDesc.html">makeResampleDesc()</a></code> if <code>fixed = TRUE</code>. The number of folds will be automatically set based on the supplied number of factor levels via <code>blocking</code>. In the inner level, the number of folds will simply be one less than in the outer level.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="co"># test fixed in nested resampling</span></span>
<span id="cb25-2"><a href="#cb25-2"></a>lrn =<span class="st"> </span><span class="kw"><a href="../../reference/makeLearner.html">makeLearner</a></span>(<span class="st">"classif.lda"</span>)</span>
<span id="cb25-3"><a href="#cb25-3"></a>ctrl &lt;-<span class="st"> </span><span class="kw"><a href="../../reference/makeTuneControlRandom.html">makeTuneControlRandom</a></span>(<span class="dt">maxit =</span> <span class="dv">2</span>)</span>
<span id="cb25-4"><a href="#cb25-4"></a>ps &lt;-<span class="st"> </span><span class="kw">makeParamSet</span>(<span class="kw">makeNumericParam</span>(<span class="st">"nu"</span>, <span class="dt">lower =</span> <span class="dv">2</span>, <span class="dt">upper =</span> <span class="dv">20</span>))</span>
<span id="cb25-5"><a href="#cb25-5"></a>inner =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"CV"</span>, <span class="dt">fixed =</span> <span class="ot">TRUE</span>)</span>
<span id="cb25-6"><a href="#cb25-6"></a>outer =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"CV"</span>, <span class="dt">fixed =</span> <span class="ot">TRUE</span>)</span>
<span id="cb25-7"><a href="#cb25-7"></a>tune_wrapper =<span class="st"> </span><span class="kw"><a href="../../reference/makeTuneWrapper.html">makeTuneWrapper</a></span>(lrn, <span class="dt">resampling =</span> inner, <span class="dt">par.set =</span> ps,</span>
<span id="cb25-8"><a href="#cb25-8"></a>  <span class="dt">control =</span> ctrl, <span class="dt">show.info =</span> <span class="ot">FALSE</span>)</span>
<span id="cb25-9"><a href="#cb25-9"></a></span>
<span id="cb25-10"><a href="#cb25-10"></a>p =<span class="st"> </span><span class="kw"><a href="../../reference/resample.html">resample</a></span>(tune_wrapper, task, outer, <span class="dt">show.info =</span> <span class="ot">FALSE</span>,</span>
<span id="cb25-11"><a href="#cb25-11"></a>  <span class="dt">extract =</span> getTuneResult)</span></code></pre></div>
<p>To check on the inner resampling indices, you can call <code><a href="../../reference/getResamplingIndices.html">getResamplingIndices(inner = TRUE)</a></code>. You can see that for every outer fold (List of 5), four inner folds were created that respect the grouping supplied via the <code>blocking</code> argument.</p>
<p>Of course you can also use a normal random sampling “CV” description in the inner level by just setting <code>fixed = FALSE</code>.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="kw"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="kw"><a href="../../reference/getResamplingIndices.html">getResamplingIndices</a></span>(p, <span class="dt">inner =</span> <span class="ot">TRUE</span>))</span>
<span id="cb26-2"><a href="#cb26-2"></a><span class="co">## List of 5</span></span>
<span id="cb26-3"><a href="#cb26-3"></a><span class="co">##  $ :List of 2</span></span>
<span id="cb26-4"><a href="#cb26-4"></a><span class="co">##   ..$ train.inds:List of 4</span></span>
<span id="cb26-5"><a href="#cb26-5"></a><span class="co">##   .. ..$ : int [1:90] 106 93 149 103 133 150 119 48 100 142 ...</span></span>
<span id="cb26-6"><a href="#cb26-6"></a><span class="co">##   .. ..$ : int [1:90] 106 11 93 149 29 103 133 150 27 119 ...</span></span>
<span id="cb26-7"><a href="#cb26-7"></a><span class="co">##   .. ..$ : int [1:90] 106 11 93 29 103 27 119 48 3 100 ...</span></span>
<span id="cb26-8"><a href="#cb26-8"></a><span class="co">##   .. ..$ : int [1:90] 11 149 29 133 150 27 48 3 26 142 ...</span></span>
<span id="cb26-9"><a href="#cb26-9"></a><span class="co">##   ..$ test.inds :List of 4</span></span>
<span id="cb26-10"><a href="#cb26-10"></a><span class="co">##   .. ..$ : int [1:30] 23 22 13 18 10 16 1 30 11 15 ...</span></span>
<span id="cb26-11"><a href="#cb26-11"></a><span class="co">##   .. ..$ : int [1:30] 35 46 37 54 31 53 51 58 48 33 ...</span></span>
<span id="cb26-12"><a href="#cb26-12"></a><span class="co">##   .. ..$ : int [1:30] 138 146 149 126 123 143 124 139 136 150 ...</span></span>
<span id="cb26-13"><a href="#cb26-13"></a><span class="co">##   .. ..$ : int [1:30] 99 104 109 112 108 111 98 115 117 100 ...</span></span>
<span id="cb26-14"><a href="#cb26-14"></a><span class="co">##  $ :List of 2</span></span>
<span id="cb26-15"><a href="#cb26-15"></a><span class="co">##   ..$ train.inds:List of 4</span></span>
<span id="cb26-16"><a href="#cb26-16"></a><span class="co">##   .. ..$ : int [1:90] 116 40 83 103 84 97 114 53 57 47 ...</span></span>
<span id="cb26-17"><a href="#cb26-17"></a><span class="co">##   .. ..$ : int [1:90] 128 40 83 84 146 141 140 53 57 142 ...</span></span>
<span id="cb26-18"><a href="#cb26-18"></a><span class="co">##   .. ..$ : int [1:90] 116 128 83 103 84 146 97 141 140 114 ...</span></span>
<span id="cb26-19"><a href="#cb26-19"></a><span class="co">##   .. ..$ : int [1:90] 116 128 40 103 146 97 141 140 114 53 ...</span></span>
<span id="cb26-20"><a href="#cb26-20"></a><span class="co">##   ..$ test.inds :List of 4</span></span>
<span id="cb26-21"><a href="#cb26-21"></a><span class="co">##   .. ..$ : int [1:30] 138 146 149 126 123 143 124 139 136 150 ...</span></span>
<span id="cb26-22"><a href="#cb26-22"></a><span class="co">##   .. ..$ : int [1:30] 99 104 109 112 108 111 98 115 117 100 ...</span></span>
<span id="cb26-23"><a href="#cb26-23"></a><span class="co">##   .. ..$ : int [1:30] 35 46 37 54 31 53 51 58 48 33 ...</span></span>
<span id="cb26-24"><a href="#cb26-24"></a><span class="co">##   .. ..$ : int [1:30] 74 68 78 88 67 73 62 85 86 89 ...</span></span>
<span id="cb26-25"><a href="#cb26-25"></a><span class="co">##  $ :List of 2</span></span>
<span id="cb26-26"><a href="#cb26-26"></a><span class="co">##   ..$ train.inds:List of 4</span></span>
<span id="cb26-27"><a href="#cb26-27"></a><span class="co">##   .. ..$ : int [1:90] 41 113 18 36 22 108 5 29 120 4 ...</span></span>
<span id="cb26-28"><a href="#cb26-28"></a><span class="co">##   .. ..$ : int [1:90] 75 82 41 113 78 36 108 61 120 57 ...</span></span>
<span id="cb26-29"><a href="#cb26-29"></a><span class="co">##   .. ..$ : int [1:90] 75 82 113 78 18 22 108 5 29 61 ...</span></span>
<span id="cb26-30"><a href="#cb26-30"></a><span class="co">##   .. ..$ : int [1:90] 75 82 41 78 18 36 22 5 29 61 ...</span></span>
<span id="cb26-31"><a href="#cb26-31"></a><span class="co">##   ..$ test.inds :List of 4</span></span>
<span id="cb26-32"><a href="#cb26-32"></a><span class="co">##   .. ..$ : int [1:30] 74 68 78 88 67 73 62 85 86 89 ...</span></span>
<span id="cb26-33"><a href="#cb26-33"></a><span class="co">##   .. ..$ : int [1:30] 23 22 13 18 10 16 1 30 11 15 ...</span></span>
<span id="cb26-34"><a href="#cb26-34"></a><span class="co">##   .. ..$ : int [1:30] 35 46 37 54 31 53 51 58 48 33 ...</span></span>
<span id="cb26-35"><a href="#cb26-35"></a><span class="co">##   .. ..$ : int [1:30] 99 104 109 112 108 111 98 115 117 100 ...</span></span>
<span id="cb26-36"><a href="#cb26-36"></a><span class="co">##  $ :List of 2</span></span>
<span id="cb26-37"><a href="#cb26-37"></a><span class="co">##   ..$ train.inds:List of 4</span></span>
<span id="cb26-38"><a href="#cb26-38"></a><span class="co">##   .. ..$ : int [1:90] 123 145 109 92 84 103 70 116 90 131 ...</span></span>
<span id="cb26-39"><a href="#cb26-39"></a><span class="co">##   .. ..$ : int [1:90] 123 145 30 1 21 109 92 103 116 8 ...</span></span>
<span id="cb26-40"><a href="#cb26-40"></a><span class="co">##   .. ..$ : int [1:90] 123 145 30 1 21 84 70 8 4 90 ...</span></span>
<span id="cb26-41"><a href="#cb26-41"></a><span class="co">##   .. ..$ : int [1:90] 30 1 21 109 92 84 103 70 116 8 ...</span></span>
<span id="cb26-42"><a href="#cb26-42"></a><span class="co">##   ..$ test.inds :List of 4</span></span>
<span id="cb26-43"><a href="#cb26-43"></a><span class="co">##   .. ..$ : int [1:30] 23 22 13 18 10 16 1 30 11 15 ...</span></span>
<span id="cb26-44"><a href="#cb26-44"></a><span class="co">##   .. ..$ : int [1:30] 74 68 78 88 67 73 62 85 86 89 ...</span></span>
<span id="cb26-45"><a href="#cb26-45"></a><span class="co">##   .. ..$ : int [1:30] 99 104 109 112 108 111 98 115 117 100 ...</span></span>
<span id="cb26-46"><a href="#cb26-46"></a><span class="co">##   .. ..$ : int [1:30] 138 146 149 126 123 143 124 139 136 150 ...</span></span>
<span id="cb26-47"><a href="#cb26-47"></a><span class="co">##  $ :List of 2</span></span>
<span id="cb26-48"><a href="#cb26-48"></a><span class="co">##   ..$ train.inds:List of 4</span></span>
<span id="cb26-49"><a href="#cb26-49"></a><span class="co">##   .. ..$ : int [1:90] 25 11 12 26 63 138 137 69 14 15 ...</span></span>
<span id="cb26-50"><a href="#cb26-50"></a><span class="co">##   .. ..$ : int [1:90] 44 25 33 11 12 48 51 26 34 138 ...</span></span>
<span id="cb26-51"><a href="#cb26-51"></a><span class="co">##   .. ..$ : int [1:90] 44 25 33 11 12 48 51 26 63 34 ...</span></span>
<span id="cb26-52"><a href="#cb26-52"></a><span class="co">##   .. ..$ : int [1:90] 44 33 48 51 63 34 138 137 69 46 ...</span></span>
<span id="cb26-53"><a href="#cb26-53"></a><span class="co">##   ..$ test.inds :List of 4</span></span>
<span id="cb26-54"><a href="#cb26-54"></a><span class="co">##   .. ..$ : int [1:30] 35 46 37 54 31 53 51 58 48 33 ...</span></span>
<span id="cb26-55"><a href="#cb26-55"></a><span class="co">##   .. ..$ : int [1:30] 74 68 78 88 67 73 62 85 86 89 ...</span></span>
<span id="cb26-56"><a href="#cb26-56"></a><span class="co">##   .. ..$ : int [1:30] 138 146 149 126 123 143 124 139 136 150 ...</span></span>
<span id="cb26-57"><a href="#cb26-57"></a><span class="co">##   .. ..$ : int [1:30] 23 22 13 18 10 16 1 30 11 15 ...</span></span></code></pre></div>
</div>
</div>
<div id="resample-descriptions-and-resample-instances" class="section level2">
<h2 class="hasAnchor">
<a href="#resample-descriptions-and-resample-instances" class="anchor"></a>Resample descriptions and resample instances</h2>
<p>As already mentioned, you can specify a resampling strategy using function <code><a href="../../reference/makeResampleDesc.html">makeResampleDesc()</a></code>.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>rdesc =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"CV"</span>, <span class="dt">iters =</span> <span class="dv">3</span>)</span>
<span id="cb27-2"><a href="#cb27-2"></a>rdesc</span>
<span id="cb27-3"><a href="#cb27-3"></a><span class="co">## Resample description: cross-validation with 3 iterations.</span></span>
<span id="cb27-4"><a href="#cb27-4"></a><span class="co">## Predict: test</span></span>
<span id="cb27-5"><a href="#cb27-5"></a><span class="co">## Stratification: FALSE</span></span>
<span id="cb27-6"><a href="#cb27-6"></a></span>
<span id="cb27-7"><a href="#cb27-7"></a><span class="kw"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(rdesc)</span>
<span id="cb27-8"><a href="#cb27-8"></a><span class="co">## List of 6</span></span>
<span id="cb27-9"><a href="#cb27-9"></a><span class="co">##  $ fixed      : logi FALSE</span></span>
<span id="cb27-10"><a href="#cb27-10"></a><span class="co">##  $ blocking.cv: logi FALSE</span></span>
<span id="cb27-11"><a href="#cb27-11"></a><span class="co">##  $ id         : chr "cross-validation"</span></span>
<span id="cb27-12"><a href="#cb27-12"></a><span class="co">##  $ iters      : int 3</span></span>
<span id="cb27-13"><a href="#cb27-13"></a><span class="co">##  $ predict    : chr "test"</span></span>
<span id="cb27-14"><a href="#cb27-14"></a><span class="co">##  $ stratify   : logi FALSE</span></span>
<span id="cb27-15"><a href="#cb27-15"></a><span class="co">##  - attr(*, "class")= chr [1:2] "CVDesc" "ResampleDesc"</span></span>
<span id="cb27-16"><a href="#cb27-16"></a></span>
<span id="cb27-17"><a href="#cb27-17"></a><span class="kw"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"Subsample"</span>, <span class="dt">stratify.cols =</span> <span class="st">"chas"</span>))</span>
<span id="cb27-18"><a href="#cb27-18"></a><span class="co">## List of 8</span></span>
<span id="cb27-19"><a href="#cb27-19"></a><span class="co">##  $ split        : num 0.667</span></span>
<span id="cb27-20"><a href="#cb27-20"></a><span class="co">##  $ id           : chr "subsampling"</span></span>
<span id="cb27-21"><a href="#cb27-21"></a><span class="co">##  $ iters        : int 30</span></span>
<span id="cb27-22"><a href="#cb27-22"></a><span class="co">##  $ predict      : chr "test"</span></span>
<span id="cb27-23"><a href="#cb27-23"></a><span class="co">##  $ stratify     : logi FALSE</span></span>
<span id="cb27-24"><a href="#cb27-24"></a><span class="co">##  $ stratify.cols: chr "chas"</span></span>
<span id="cb27-25"><a href="#cb27-25"></a><span class="co">##  $ fixed        : logi FALSE</span></span>
<span id="cb27-26"><a href="#cb27-26"></a><span class="co">##  $ blocking.cv  : logi FALSE</span></span>
<span id="cb27-27"><a href="#cb27-27"></a><span class="co">##  - attr(*, "class")= chr [1:2] "SubsampleDesc" "ResampleDesc"</span></span></code></pre></div>
<p>The result <code>rdesc</code> inherits from class <code>ResampleDesc</code> (<code><a href="../../reference/makeResampleDesc.html">makeResampleDesc()</a></code>) (short for resample description) and, in principle, contains all necessary information about the resampling strategy including the number of iterations, the proportion of training and test sets, stratification variables, etc.</p>
<p>Given either the size of the data set at hand or the <code><a href="../../reference/Task.html">Task()</a></code>, function <code><a href="../../reference/makeResampleInstance.html">makeResampleInstance()</a></code> draws the training and test sets according to the <code>ResampleDesc</code> (<code><a href="../../reference/makeResampleDesc.html">makeResampleDesc()</a></code>).</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="co"># Create a resample instance based an a task</span></span>
<span id="cb28-2"><a href="#cb28-2"></a>rin =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleInstance.html">makeResampleInstance</a></span>(rdesc, iris.task)</span>
<span id="cb28-3"><a href="#cb28-3"></a>rin</span>
<span id="cb28-4"><a href="#cb28-4"></a><span class="co">## Resample instance for 150 cases.</span></span>
<span id="cb28-5"><a href="#cb28-5"></a><span class="co">## Resample description: cross-validation with 3 iterations.</span></span>
<span id="cb28-6"><a href="#cb28-6"></a><span class="co">## Predict: test</span></span>
<span id="cb28-7"><a href="#cb28-7"></a><span class="co">## Stratification: FALSE</span></span>
<span id="cb28-8"><a href="#cb28-8"></a></span>
<span id="cb28-9"><a href="#cb28-9"></a><span class="kw"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(rin)</span>
<span id="cb28-10"><a href="#cb28-10"></a><span class="co">## List of 5</span></span>
<span id="cb28-11"><a href="#cb28-11"></a><span class="co">##  $ desc      :List of 6</span></span>
<span id="cb28-12"><a href="#cb28-12"></a><span class="co">##   ..$ fixed      : logi FALSE</span></span>
<span id="cb28-13"><a href="#cb28-13"></a><span class="co">##   ..$ blocking.cv: logi FALSE</span></span>
<span id="cb28-14"><a href="#cb28-14"></a><span class="co">##   ..$ id         : chr "cross-validation"</span></span>
<span id="cb28-15"><a href="#cb28-15"></a><span class="co">##   ..$ iters      : int 3</span></span>
<span id="cb28-16"><a href="#cb28-16"></a><span class="co">##   ..$ predict    : chr "test"</span></span>
<span id="cb28-17"><a href="#cb28-17"></a><span class="co">##   ..$ stratify   : logi FALSE</span></span>
<span id="cb28-18"><a href="#cb28-18"></a><span class="co">##   ..- attr(*, "class")= chr [1:2] "CVDesc" "ResampleDesc"</span></span>
<span id="cb28-19"><a href="#cb28-19"></a><span class="co">##  $ size      : int 150</span></span>
<span id="cb28-20"><a href="#cb28-20"></a><span class="co">##  $ train.inds:List of 3</span></span>
<span id="cb28-21"><a href="#cb28-21"></a><span class="co">##   ..$ : int [1:100] 75 43 147 7 74 55 104 111 23 9 ...</span></span>
<span id="cb28-22"><a href="#cb28-22"></a><span class="co">##   ..$ : int [1:100] 29 20 74 129 124 111 9 31 5 21 ...</span></span>
<span id="cb28-23"><a href="#cb28-23"></a><span class="co">##   ..$ : int [1:100] 29 75 43 147 20 7 129 124 55 104 ...</span></span>
<span id="cb28-24"><a href="#cb28-24"></a><span class="co">##  $ test.inds :List of 3</span></span>
<span id="cb28-25"><a href="#cb28-25"></a><span class="co">##   ..$ : int [1:50] 4 5 6 10 15 17 19 20 21 22 ...</span></span>
<span id="cb28-26"><a href="#cb28-26"></a><span class="co">##   ..$ : int [1:50] 1 3 7 11 12 14 16 23 27 33 ...</span></span>
<span id="cb28-27"><a href="#cb28-27"></a><span class="co">##   ..$ : int [1:50] 2 8 9 13 18 24 25 26 28 30 ...</span></span>
<span id="cb28-28"><a href="#cb28-28"></a><span class="co">##  $ group     : Factor w/ 0 levels: </span></span>
<span id="cb28-29"><a href="#cb28-29"></a><span class="co">##  - attr(*, "class")= chr "ResampleInstance"</span></span>
<span id="cb28-30"><a href="#cb28-30"></a></span>
<span id="cb28-31"><a href="#cb28-31"></a><span class="co"># Create a resample instance given the size of the data set</span></span>
<span id="cb28-32"><a href="#cb28-32"></a>rin =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleInstance.html">makeResampleInstance</a></span>(rdesc, <span class="dt">size =</span> <span class="kw"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(iris))</span>
<span id="cb28-33"><a href="#cb28-33"></a><span class="kw"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(rin)</span>
<span id="cb28-34"><a href="#cb28-34"></a><span class="co">## List of 5</span></span>
<span id="cb28-35"><a href="#cb28-35"></a><span class="co">##  $ desc      :List of 6</span></span>
<span id="cb28-36"><a href="#cb28-36"></a><span class="co">##   ..$ fixed      : logi FALSE</span></span>
<span id="cb28-37"><a href="#cb28-37"></a><span class="co">##   ..$ blocking.cv: logi FALSE</span></span>
<span id="cb28-38"><a href="#cb28-38"></a><span class="co">##   ..$ id         : chr "cross-validation"</span></span>
<span id="cb28-39"><a href="#cb28-39"></a><span class="co">##   ..$ iters      : int 3</span></span>
<span id="cb28-40"><a href="#cb28-40"></a><span class="co">##   ..$ predict    : chr "test"</span></span>
<span id="cb28-41"><a href="#cb28-41"></a><span class="co">##   ..$ stratify   : logi FALSE</span></span>
<span id="cb28-42"><a href="#cb28-42"></a><span class="co">##   ..- attr(*, "class")= chr [1:2] "CVDesc" "ResampleDesc"</span></span>
<span id="cb28-43"><a href="#cb28-43"></a><span class="co">##  $ size      : int 150</span></span>
<span id="cb28-44"><a href="#cb28-44"></a><span class="co">##  $ train.inds:List of 3</span></span>
<span id="cb28-45"><a href="#cb28-45"></a><span class="co">##   ..$ : int [1:100] 38 94 73 82 14 77 75 150 27 85 ...</span></span>
<span id="cb28-46"><a href="#cb28-46"></a><span class="co">##   ..$ : int [1:100] 90 82 14 77 75 150 27 56 16 22 ...</span></span>
<span id="cb28-47"><a href="#cb28-47"></a><span class="co">##   ..$ : int [1:100] 38 94 73 90 85 36 19 104 127 55 ...</span></span>
<span id="cb28-48"><a href="#cb28-48"></a><span class="co">##  $ test.inds :List of 3</span></span>
<span id="cb28-49"><a href="#cb28-49"></a><span class="co">##   ..$ : int [1:50] 3 6 10 12 13 15 19 23 25 26 ...</span></span>
<span id="cb28-50"><a href="#cb28-50"></a><span class="co">##   ..$ : int [1:50] 2 7 18 20 29 31 33 35 37 38 ...</span></span>
<span id="cb28-51"><a href="#cb28-51"></a><span class="co">##   ..$ : int [1:50] 1 4 5 8 9 11 14 16 17 21 ...</span></span>
<span id="cb28-52"><a href="#cb28-52"></a><span class="co">##  $ group     : Factor w/ 0 levels: </span></span>
<span id="cb28-53"><a href="#cb28-53"></a><span class="co">##  - attr(*, "class")= chr "ResampleInstance"</span></span>
<span id="cb28-54"><a href="#cb28-54"></a></span>
<span id="cb28-55"><a href="#cb28-55"></a><span class="co"># Access the indices of the training observations in iteration 3</span></span>
<span id="cb28-56"><a href="#cb28-56"></a>rin<span class="op">$</span>train.inds[[<span class="dv">3</span>]]</span>
<span id="cb28-57"><a href="#cb28-57"></a><span class="co">##   [1]  38  94  73  90  85  36  19 104 127  55 103  91  44  49 132  59  34</span></span>
<span id="cb28-58"><a href="#cb28-58"></a><span class="co">##  [18]  12  29 145  25  81  33  86  40 117  99  62 112 119 135 125 146  20</span></span>
<span id="cb28-59"><a href="#cb28-59"></a><span class="co">##  [35]  37 107 113  68 149 102 115  74 129 147 130  97 106  76  66  67  50</span></span>
<span id="cb28-60"><a href="#cb28-60"></a><span class="co">##  [52]  61   6  72  42  54  45 111  52 108  95 120 101  63  31  43 141  47</span></span>
<span id="cb28-61"><a href="#cb28-61"></a><span class="co">##  [69]  51  89 142  23 136 148 116 122  10  13  26 126 123   7  60 118 140</span></span>
<span id="cb28-62"><a href="#cb28-62"></a><span class="co">##  [86] 139  18  93  71   2  84  15  35   3 109  79  87 124 114  57</span></span></code></pre></div>
<p>The result <code>rin</code> inherits from class <code>ResampleInstance</code> (<code><a href="../../reference/makeResampleInstance.html">makeResampleInstance()</a></code>) and contains <code>list</code>s of index vectors for the train and test sets.</p>
<p>If a <code>ResampleDesc</code> (<code><a href="../../reference/makeResampleDesc.html">makeResampleDesc()</a></code>) is passed to <code><a href="../../reference/resample.html">resample()</a></code>, it is instantiated internally. Naturally, it is also possible to pass a <code>ResampleInstance</code> (<code><a href="../../reference/makeResampleInstance.html">makeResampleInstance()</a></code>) directly.</p>
<p>While the separation between resample descriptions, resample instances, and the <code><a href="../../reference/resample.html">resample()</a></code> function itself seems overly complicated, it has several advantages:</p>
<ul>
<li>Resample instances readily allow for paired experiments, that is comparing the performance of several learners on exactly the same training and test sets. This is particularly useful if you want to add another method to a comparison experiment you already did. Moreover, you can store the resample instance along with your data in order to be able to reproduce your results later on.</li>
</ul>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>rdesc =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"CV"</span>, <span class="dt">iters =</span> <span class="dv">3</span>)</span>
<span id="cb29-2"><a href="#cb29-2"></a>rin =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleInstance.html">makeResampleInstance</a></span>(rdesc, <span class="dt">task =</span> iris.task)</span>
<span id="cb29-3"><a href="#cb29-3"></a></span>
<span id="cb29-4"><a href="#cb29-4"></a><span class="co"># Calculate the performance of two learners based on the same resample instance</span></span>
<span id="cb29-5"><a href="#cb29-5"></a>r.lda =<span class="st"> </span><span class="kw"><a href="../../reference/resample.html">resample</a></span>(<span class="st">"classif.lda"</span>, iris.task, rin, <span class="dt">show.info =</span> <span class="ot">FALSE</span>)</span>
<span id="cb29-6"><a href="#cb29-6"></a>r.rpart =<span class="st"> </span><span class="kw"><a href="../../reference/resample.html">resample</a></span>(<span class="st">"classif.rpart"</span>, iris.task, rin, <span class="dt">show.info =</span> <span class="ot">FALSE</span>)</span>
<span id="cb29-7"><a href="#cb29-7"></a>r.lda<span class="op">$</span>aggr</span>
<span id="cb29-8"><a href="#cb29-8"></a><span class="co">## mmce.test.mean </span></span>
<span id="cb29-9"><a href="#cb29-9"></a><span class="co">##           0.02</span></span>
<span id="cb29-10"><a href="#cb29-10"></a></span>
<span id="cb29-11"><a href="#cb29-11"></a>r.rpart<span class="op">$</span>aggr</span>
<span id="cb29-12"><a href="#cb29-12"></a><span class="co">## mmce.test.mean </span></span>
<span id="cb29-13"><a href="#cb29-13"></a><span class="co">##           0.06</span></span></code></pre></div>
<ul>
<li>In order to add further resampling methods you can simply derive from the <code>ResampleDesc</code> (<code><a href="../../reference/makeResampleDesc.html">makeResampleDesc()</a></code>) and <code>ResampleInstance</code> (<code><a href="../../reference/makeResampleInstance.html">makeResampleInstance()</a></code>) classes, but you do neither have to touch <code><a href="../../reference/resample.html">resample()</a></code> nor any further methods that use the resampling strategy.</li>
</ul>
<p>Usually, when calling <code><a href="../../reference/makeResampleInstance.html">makeResampleInstance()</a></code> the train and test index sets are drawn randomly. Mainly for <em>holdout</em> (<em>test sample</em>) <em>estimation</em> you might want full control about the training and tests set and specify them manually. This can be done using function <code><a href="../../reference/makeFixedHoldoutInstance.html">makeFixedHoldoutInstance()</a></code>.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>rin =<span class="st"> </span><span class="kw"><a href="../../reference/makeFixedHoldoutInstance.html">makeFixedHoldoutInstance</a></span>(<span class="dt">train.inds =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">100</span>, <span class="dt">test.inds =</span> <span class="dv">101</span><span class="op">:</span><span class="dv">150</span>, <span class="dt">size =</span> <span class="dv">150</span>)</span>
<span id="cb30-2"><a href="#cb30-2"></a>rin</span>
<span id="cb30-3"><a href="#cb30-3"></a><span class="co">## Resample instance for 150 cases.</span></span>
<span id="cb30-4"><a href="#cb30-4"></a><span class="co">## Resample description: holdout with 0.67 split rate.</span></span>
<span id="cb30-5"><a href="#cb30-5"></a><span class="co">## Predict: test</span></span>
<span id="cb30-6"><a href="#cb30-6"></a><span class="co">## Stratification: FALSE</span></span></code></pre></div>
</div>
<div id="aggregating-performance-values" class="section level2">
<h2 class="hasAnchor">
<a href="#aggregating-performance-values" class="anchor"></a>Aggregating performance values</h2>
<p>In each resampling iteration <span class="math inline">\(b = 1,\ldots,B\)</span> we get performance values <span class="math inline">\(S(D^{*b}, D \setminus D^{*b})\)</span> (for each measure we wish to calculate), which are then aggregated to an overall performance.</p>
<p>For the great majority of common resampling strategies (like holdout, cross-validation, subsampling) performance values are calculated on the test data sets only and for most measures aggregated by taking the mean (<code>test.mean</code>(<code><a href="../../reference/aggregations.html">aggregations()</a></code>)).</p>
<p>Each performance <code>Measure</code> (<code><a href="../../reference/makeMeasure.html">makeMeasure()</a></code>) in <code>mlr</code> has a corresponding default aggregation method which is stored in slot <code>$aggr</code>. The default aggregation for most measures is <code>test.mean</code>(<code><a href="../../reference/aggregations.html">aggregations()</a></code>). One exception is the root mean square error (<a href="measures.html" target="_blank">rmse</a>).</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="co"># Mean misclassification error</span></span>
<span id="cb31-2"><a href="#cb31-2"></a>mmce<span class="op">$</span>aggr</span>
<span id="cb31-3"><a href="#cb31-3"></a><span class="co">## Aggregation function: test.mean</span></span>
<span id="cb31-4"><a href="#cb31-4"></a></span>
<span id="cb31-5"><a href="#cb31-5"></a>mmce<span class="op">$</span>aggr<span class="op">$</span>fun</span>
<span id="cb31-6"><a href="#cb31-6"></a><span class="co">## function (task, perf.test, perf.train, measure, group, pred) </span></span>
<span id="cb31-7"><a href="#cb31-7"></a><span class="co">## mean(perf.test)</span></span>
<span id="cb31-8"><a href="#cb31-8"></a><span class="co">## &lt;bytecode: 0xc8eade8&gt;</span></span>
<span id="cb31-9"><a href="#cb31-9"></a><span class="co">## &lt;environment: namespace:mlr&gt;</span></span>
<span id="cb31-10"><a href="#cb31-10"></a></span>
<span id="cb31-11"><a href="#cb31-11"></a><span class="co"># Root mean square error</span></span>
<span id="cb31-12"><a href="#cb31-12"></a>rmse<span class="op">$</span>aggr</span>
<span id="cb31-13"><a href="#cb31-13"></a><span class="co">## Aggregation function: test.rmse</span></span>
<span id="cb31-14"><a href="#cb31-14"></a></span>
<span id="cb31-15"><a href="#cb31-15"></a>rmse<span class="op">$</span>aggr<span class="op">$</span>fun</span>
<span id="cb31-16"><a href="#cb31-16"></a><span class="co">## function (task, perf.test, perf.train, measure, group, pred) </span></span>
<span id="cb31-17"><a href="#cb31-17"></a><span class="co">## sqrt(mean(perf.test^2))</span></span>
<span id="cb31-18"><a href="#cb31-18"></a><span class="co">## &lt;bytecode: 0x23ad72d8&gt;</span></span>
<span id="cb31-19"><a href="#cb31-19"></a><span class="co">## &lt;environment: namespace:mlr&gt;</span></span></code></pre></div>
<p>You can change the aggregation method of a <code>Measure</code> (<code><a href="../../reference/makeMeasure.html">makeMeasure()</a></code>) via function <code><a href="../../reference/setAggregation.html">setAggregation()</a></code>. All available aggregation schemes are listed on the <code><a href="../../reference/aggregations.html">aggregations()</a></code> documentation page.</p>
<div id="example-one-measure-with-different-aggregations" class="section level4">
<h4 class="hasAnchor">
<a href="#example-one-measure-with-different-aggregations" class="anchor"></a>Example: One measure with different aggregations</h4>
<p>The aggregation schemes <code>test.median</code> (<code><a href="../../reference/aggregations.html">aggregations()</a></code>), <code>test.min</code> (<code><a href="../../reference/aggregations.html">aggregations()</a></code>), and <code>text.max</code> (<code><a href="../../reference/aggregations.html">aggregations()</a></code>) compute the median, minimum, and maximum of the performance values on the test sets.</p>
<pre><code>## Resampling: cross-validation
## Measures:             mse       mse       mse       mse
## [Resample] iter 1:    29.519658829.519658829.519658829.5196588
## [Resample] iter 2:    19.585943919.585943919.585943919.5859439
## [Resample] iter 3:    25.396095325.396095325.396095325.3960953
## 
## Aggregated Result: mse.test.mean=24.8338993,mse.test.median=25.3960953,mse.test.min=19.5859439,mse.test.max=29.5196588
## </code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>mseTestMedian =<span class="st"> </span><span class="kw"><a href="../../reference/setAggregation.html">setAggregation</a></span>(mse, test.median)</span>
<span id="cb33-2"><a href="#cb33-2"></a>mseTestMin =<span class="st"> </span><span class="kw"><a href="../../reference/setAggregation.html">setAggregation</a></span>(mse, test.min)</span>
<span id="cb33-3"><a href="#cb33-3"></a>mseTestMax =<span class="st"> </span><span class="kw"><a href="../../reference/setAggregation.html">setAggregation</a></span>(mse, test.max)</span>
<span id="cb33-4"><a href="#cb33-4"></a></span>
<span id="cb33-5"><a href="#cb33-5"></a>mseTestMedian</span>
<span id="cb33-6"><a href="#cb33-6"></a><span class="co">## Name: Mean of squared errors</span></span>
<span id="cb33-7"><a href="#cb33-7"></a><span class="co">## Performance measure: mse</span></span>
<span id="cb33-8"><a href="#cb33-8"></a><span class="co">## Properties: regr,req.pred,req.truth</span></span>
<span id="cb33-9"><a href="#cb33-9"></a><span class="co">## Minimize: TRUE</span></span>
<span id="cb33-10"><a href="#cb33-10"></a><span class="co">## Best: 0; Worst: Inf</span></span>
<span id="cb33-11"><a href="#cb33-11"></a><span class="co">## Aggregated by: test.median</span></span>
<span id="cb33-12"><a href="#cb33-12"></a><span class="co">## Arguments: </span></span>
<span id="cb33-13"><a href="#cb33-13"></a><span class="co">## Note: Defined as: mean((response - truth)^2)</span></span>
<span id="cb33-14"><a href="#cb33-14"></a></span>
<span id="cb33-15"><a href="#cb33-15"></a>rdesc =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"CV"</span>, <span class="dt">iters =</span> <span class="dv">3</span>)</span>
<span id="cb33-16"><a href="#cb33-16"></a>r =<span class="st"> </span><span class="kw"><a href="../../reference/resample.html">resample</a></span>(<span class="st">"regr.lm"</span>, bh.task, rdesc, <span class="dt">measures =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(mse, mseTestMedian, mseTestMin, mseTestMax))</span>
<span id="cb33-17"><a href="#cb33-17"></a><span class="co">## Resampling: cross-validation</span></span>
<span id="cb33-18"><a href="#cb33-18"></a><span class="co">## Measures:             mse       mse       mse       mse</span></span>
<span id="cb33-19"><a href="#cb33-19"></a><span class="co">## [Resample] iter 1:    24.078202624.078202624.078202624.0782026</span></span>
<span id="cb33-20"><a href="#cb33-20"></a><span class="co">## [Resample] iter 2:    29.498307729.498307729.498307729.4983077</span></span>
<span id="cb33-21"><a href="#cb33-21"></a><span class="co">## [Resample] iter 3:    18.689471818.689471818.689471818.6894718</span></span>
<span id="cb33-22"><a href="#cb33-22"></a><span class="co">## </span></span>
<span id="cb33-23"><a href="#cb33-23"></a><span class="co">## Aggregated Result: mse.test.mean=24.0886607,mse.test.median=24.0782026,mse.test.min=18.6894718,mse.test.max=29.4983077</span></span>
<span id="cb33-24"><a href="#cb33-24"></a><span class="co">## </span></span>
<span id="cb33-25"><a href="#cb33-25"></a></span>
<span id="cb33-26"><a href="#cb33-26"></a>r</span>
<span id="cb33-27"><a href="#cb33-27"></a><span class="co">## Resample Result</span></span>
<span id="cb33-28"><a href="#cb33-28"></a><span class="co">## Task: BostonHousing-example</span></span>
<span id="cb33-29"><a href="#cb33-29"></a><span class="co">## Learner: regr.lm</span></span>
<span id="cb33-30"><a href="#cb33-30"></a><span class="co">## Aggr perf: mse.test.mean=24.0886607,mse.test.median=24.0782026,mse.test.min=18.6894718,mse.test.max=29.4983077</span></span>
<span id="cb33-31"><a href="#cb33-31"></a><span class="co">## Runtime: 0.0288048</span></span>
<span id="cb33-32"><a href="#cb33-32"></a></span>
<span id="cb33-33"><a href="#cb33-33"></a>r<span class="op">$</span>aggr</span>
<span id="cb33-34"><a href="#cb33-34"></a><span class="co">##   mse.test.mean mse.test.median    mse.test.min    mse.test.max </span></span>
<span id="cb33-35"><a href="#cb33-35"></a><span class="co">##        24.08866        24.07820        18.68947        29.49831</span></span></code></pre></div>
</div>
<div id="example-calculating-the-training-error" class="section level3">
<h3 class="hasAnchor">
<a href="#example-calculating-the-training-error" class="anchor"></a>Example: Calculating the training error</h3>
<p>Below we calculate the mean misclassification error (<a href="measures.html" target="_blank">mmce</a>) on the training and the test data sets. Note that we have to set <code>predict = "both"</code> when calling <code><a href="../../reference/makeResampleDesc.html">makeResampleDesc()</a></code> in order to get predictions on both training and test sets.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a>mmceTrainMean =<span class="st"> </span><span class="kw"><a href="../../reference/setAggregation.html">setAggregation</a></span>(mmce, train.mean)</span>
<span id="cb34-2"><a href="#cb34-2"></a>rdesc =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"CV"</span>, <span class="dt">iters =</span> <span class="dv">3</span>, <span class="dt">predict =</span> <span class="st">"both"</span>)</span>
<span id="cb34-3"><a href="#cb34-3"></a>r =<span class="st"> </span><span class="kw"><a href="../../reference/resample.html">resample</a></span>(<span class="st">"classif.rpart"</span>, iris.task, rdesc, <span class="dt">measures =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(mmce, mmceTrainMean))</span>
<span id="cb34-4"><a href="#cb34-4"></a><span class="co">## Resampling: cross-validation</span></span>
<span id="cb34-5"><a href="#cb34-5"></a><span class="co">## Measures:             mmce.train   mmce.test</span></span>
<span id="cb34-6"><a href="#cb34-6"></a><span class="co">## [Resample] iter 1:    0.0300000    0.0600000</span></span>
<span id="cb34-7"><a href="#cb34-7"></a><span class="co">## [Resample] iter 2:    0.0400000    0.0600000</span></span>
<span id="cb34-8"><a href="#cb34-8"></a><span class="co">## [Resample] iter 3:    0.0300000    0.0600000</span></span>
<span id="cb34-9"><a href="#cb34-9"></a><span class="co">## </span></span>
<span id="cb34-10"><a href="#cb34-10"></a><span class="co">## Aggregated Result: mmce.test.mean=0.0600000,mmce.train.mean=0.0333333</span></span>
<span id="cb34-11"><a href="#cb34-11"></a><span class="co">## </span></span>
<span id="cb34-12"><a href="#cb34-12"></a></span>
<span id="cb34-13"><a href="#cb34-13"></a>r<span class="op">$</span>measures.train</span>
<span id="cb34-14"><a href="#cb34-14"></a><span class="co">##   iter mmce mmce</span></span>
<span id="cb34-15"><a href="#cb34-15"></a><span class="co">## 1    1 0.03 0.03</span></span>
<span id="cb34-16"><a href="#cb34-16"></a><span class="co">## 2    2 0.04 0.04</span></span>
<span id="cb34-17"><a href="#cb34-17"></a><span class="co">## 3    3 0.03 0.03</span></span>
<span id="cb34-18"><a href="#cb34-18"></a></span>
<span id="cb34-19"><a href="#cb34-19"></a>r<span class="op">$</span>aggr</span>
<span id="cb34-20"><a href="#cb34-20"></a><span class="co">##  mmce.test.mean mmce.train.mean </span></span>
<span id="cb34-21"><a href="#cb34-21"></a><span class="co">##      0.06000000      0.03333333</span></span></code></pre></div>
</div>
<div id="example-bootstrap" class="section level3">
<h3 class="hasAnchor">
<a href="#example-bootstrap" class="anchor"></a>Example: Bootstrap</h3>
<p>In <em>out-of-bag bootstrap estimation</em> <span class="math inline">\(B\)</span> new data sets <span class="math inline">\(D^{*1}, \ldots, D^{*B}\)</span> are drawn from the data set <span class="math inline">\(D\)</span> with replacement, each of the same size as <span class="math inline">\(D\)</span>. In the <span class="math inline">\(b\)</span>-th iteration, <span class="math inline">\(D^{*b}\)</span> forms the training set, while the remaining elements from <span class="math inline">\(D\)</span>, i.e., <span class="math inline">\(D \setminus D^{*b}\)</span>, form the test set.</p>
<!--(
                     |resampling_desc_figure|

                     |resampling_nested_resampling_figure|
)-->
<p>The <em>b632</em> and <em>b632+</em> variants calculate a convex combination of the training performance and the out-of-bag bootstrap performance and thus require predictions on the training sets and an appropriate aggregation strategy.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="co"># Use bootstrap as resampling strategy and predict on both train and test sets</span></span>
<span id="cb35-2"><a href="#cb35-2"></a>rdesc =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"Bootstrap"</span>, <span class="dt">predict =</span> <span class="st">"both"</span>, <span class="dt">iters =</span> <span class="dv">10</span>)</span>
<span id="cb35-3"><a href="#cb35-3"></a></span>
<span id="cb35-4"><a href="#cb35-4"></a><span class="co"># Set aggregation schemes for b632 and b632+ bootstrap</span></span>
<span id="cb35-5"><a href="#cb35-5"></a>mmceB632 =<span class="st"> </span><span class="kw"><a href="../../reference/setAggregation.html">setAggregation</a></span>(mmce, b632)</span>
<span id="cb35-6"><a href="#cb35-6"></a>mmceB632plus =<span class="st"> </span><span class="kw"><a href="../../reference/setAggregation.html">setAggregation</a></span>(mmce, b632plus)</span>
<span id="cb35-7"><a href="#cb35-7"></a></span>
<span id="cb35-8"><a href="#cb35-8"></a>mmceB632</span>
<span id="cb35-9"><a href="#cb35-9"></a><span class="co">## Name: Mean misclassification error</span></span>
<span id="cb35-10"><a href="#cb35-10"></a><span class="co">## Performance measure: mmce</span></span>
<span id="cb35-11"><a href="#cb35-11"></a><span class="co">## Properties: classif,classif.multi,req.pred,req.truth</span></span>
<span id="cb35-12"><a href="#cb35-12"></a><span class="co">## Minimize: TRUE</span></span>
<span id="cb35-13"><a href="#cb35-13"></a><span class="co">## Best: 0; Worst: 1</span></span>
<span id="cb35-14"><a href="#cb35-14"></a><span class="co">## Aggregated by: b632</span></span>
<span id="cb35-15"><a href="#cb35-15"></a><span class="co">## Arguments: </span></span>
<span id="cb35-16"><a href="#cb35-16"></a><span class="co">## Note: Defined as: mean(response != truth)</span></span>
<span id="cb35-17"><a href="#cb35-17"></a></span>
<span id="cb35-18"><a href="#cb35-18"></a>r =<span class="st"> </span><span class="kw"><a href="../../reference/resample.html">resample</a></span>(<span class="st">"classif.rpart"</span>, iris.task, rdesc, <span class="dt">measures =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(mmce, mmceB632, mmceB632plus),</span>
<span id="cb35-19"><a href="#cb35-19"></a>  <span class="dt">show.info =</span> <span class="ot">FALSE</span>)</span>
<span id="cb35-20"><a href="#cb35-20"></a><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(r<span class="op">$</span>measures.train)</span>
<span id="cb35-21"><a href="#cb35-21"></a><span class="co">##   iter       mmce       mmce       mmce</span></span>
<span id="cb35-22"><a href="#cb35-22"></a><span class="co">## 1    1 0.04000000 0.04000000 0.04000000</span></span>
<span id="cb35-23"><a href="#cb35-23"></a><span class="co">## 2    2 0.02666667 0.02666667 0.02666667</span></span>
<span id="cb35-24"><a href="#cb35-24"></a><span class="co">## 3    3 0.04666667 0.04666667 0.04666667</span></span>
<span id="cb35-25"><a href="#cb35-25"></a><span class="co">## 4    4 0.02666667 0.02666667 0.02666667</span></span>
<span id="cb35-26"><a href="#cb35-26"></a><span class="co">## 5    5 0.03333333 0.03333333 0.03333333</span></span>
<span id="cb35-27"><a href="#cb35-27"></a><span class="co">## 6    6 0.02000000 0.02000000 0.02000000</span></span>
<span id="cb35-28"><a href="#cb35-28"></a></span>
<span id="cb35-29"><a href="#cb35-29"></a><span class="co"># Compare misclassification rates for out-of-bag, b632, and b632+ bootstrap</span></span>
<span id="cb35-30"><a href="#cb35-30"></a>r<span class="op">$</span>aggr</span>
<span id="cb35-31"><a href="#cb35-31"></a><span class="co">## mmce.test.mean      mmce.b632  mmce.b632plus </span></span>
<span id="cb35-32"><a href="#cb35-32"></a><span class="co">##     0.05059931     0.04228276     0.04303127</span></span></code></pre></div>
</div>
</div>
<div id="convenience-functions" class="section level2">
<h2 class="hasAnchor">
<a href="#convenience-functions" class="anchor"></a>Convenience functions</h2>
<p>The functionality described on this page allows for much control and flexibility. However, when quickly trying out some learners, it can get tedious to type all the code for defining the resampling strategy, setting the aggregation scheme and so on. As mentioned above, <code>mlr</code> includes some pre-defined resample description objects for frequently used strategies like, e.g., 5-fold cross-validation (<code>cv5</code> (<code><a href="../../reference/makeResampleDesc.html">makeResampleDesc()</a></code>)). Moreover, <code>mlr</code> provides special functions for the most common resampling methods, for example <code>holdout</code> (<code><a href="../../reference/resample.html">resample()</a></code>), <code>crossval</code> (<code><a href="../../reference/resample.html">resample()</a></code>), or <code>bootstrapB632</code> (<code><a href="../../reference/resample.html">resample()</a></code>).</p>
<pre><code>## Resampling: cross-validation
## Measures:             mmce      ber
## [Resample] iter 1:    0.0400000 0.0444444
## [Resample] iter 2:    0.0000000 0.0000000
## [Resample] iter 3:    0.0200000 0.0303030
## 
## Aggregated Result: mmce.test.mean=0.0200000,ber.test.mean=0.0249158
## 
## Resampling: OOB bootstrapping
## Measures:             mse.train   mae.train   mse.test    mae.test
## [Resample] iter 1:    23.4927114  3.6008531   25.7782322  3.7183011
## [Resample] iter 2:    18.5886427  2.9238599   27.5961506  3.7304597
## [Resample] iter 3:    20.6455357  3.1039182   26.2183904  3.6727966
## 
## Aggregated Result: mse.b632plus=24.5409802,mae.b632plus=3.5372475
## </code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="kw"><a href="../../reference/resample.html">crossval</a></span>(<span class="st">"classif.lda"</span>, iris.task, <span class="dt">iters =</span> <span class="dv">3</span>, <span class="dt">measures =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(mmce, ber))</span>
<span id="cb37-2"><a href="#cb37-2"></a><span class="co">## Resampling: cross-validation</span></span>
<span id="cb37-3"><a href="#cb37-3"></a><span class="co">## Measures:             mmce      ber</span></span>
<span id="cb37-4"><a href="#cb37-4"></a><span class="co">## [Resample] iter 1:    0.0200000 0.0238095</span></span>
<span id="cb37-5"><a href="#cb37-5"></a><span class="co">## [Resample] iter 2:    0.0400000 0.0370370</span></span>
<span id="cb37-6"><a href="#cb37-6"></a><span class="co">## [Resample] iter 3:    0.0000000 0.0000000</span></span>
<span id="cb37-7"><a href="#cb37-7"></a><span class="co">## </span></span>
<span id="cb37-8"><a href="#cb37-8"></a><span class="co">## Aggregated Result: mmce.test.mean=0.0200000,ber.test.mean=0.0202822</span></span>
<span id="cb37-9"><a href="#cb37-9"></a><span class="co">## </span></span>
<span id="cb37-10"><a href="#cb37-10"></a><span class="co">## Resample Result</span></span>
<span id="cb37-11"><a href="#cb37-11"></a><span class="co">## Task: iris-example</span></span>
<span id="cb37-12"><a href="#cb37-12"></a><span class="co">## Learner: classif.lda</span></span>
<span id="cb37-13"><a href="#cb37-13"></a><span class="co">## Aggr perf: mmce.test.mean=0.0200000,ber.test.mean=0.0202822</span></span>
<span id="cb37-14"><a href="#cb37-14"></a><span class="co">## Runtime: 0.0205457</span></span>
<span id="cb37-15"><a href="#cb37-15"></a></span>
<span id="cb37-16"><a href="#cb37-16"></a><span class="kw"><a href="../../reference/resample.html">bootstrapB632plus</a></span>(<span class="st">"regr.lm"</span>, bh.task, <span class="dt">iters =</span> <span class="dv">3</span>, <span class="dt">measures =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(mse, mae))</span>
<span id="cb37-17"><a href="#cb37-17"></a><span class="co">## Resampling: OOB bootstrapping</span></span>
<span id="cb37-18"><a href="#cb37-18"></a><span class="co">## Measures:             mse.train   mae.train   mse.test    mae.test</span></span>
<span id="cb37-19"><a href="#cb37-19"></a><span class="co">## [Resample] iter 1:    24.6425511  3.4107320   16.3415466  3.0123263</span></span>
<span id="cb37-20"><a href="#cb37-20"></a><span class="co">## [Resample] iter 2:    17.0963191  2.9809210   29.6056968  3.7131236</span></span>
<span id="cb37-21"><a href="#cb37-21"></a><span class="co">## [Resample] iter 3:    23.1440608  3.5079975   24.4183753  3.3467443</span></span>
<span id="cb37-22"><a href="#cb37-22"></a><span class="co">## </span></span>
<span id="cb37-23"><a href="#cb37-23"></a><span class="co">## Aggregated Result: mse.b632plus=22.9359054,mae.b632plus=3.3459751</span></span>
<span id="cb37-24"><a href="#cb37-24"></a><span class="co">## </span></span>
<span id="cb37-25"><a href="#cb37-25"></a><span class="co">## Resample Result</span></span>
<span id="cb37-26"><a href="#cb37-26"></a><span class="co">## Task: BostonHousing-example</span></span>
<span id="cb37-27"><a href="#cb37-27"></a><span class="co">## Learner: regr.lm</span></span>
<span id="cb37-28"><a href="#cb37-28"></a><span class="co">## Aggr perf: mse.b632plus=22.9359054,mae.b632plus=3.3459751</span></span>
<span id="cb37-29"><a href="#cb37-29"></a><span class="co">## Runtime: 0.0419419</span></span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#defining-the-resampling-strategy">Defining the resampling strategy</a></li>
      <li><a href="#performing-the-resampling">Performing the resampling</a></li>
      <li>
<a href="#accessing-resample-results">Accessing resample results</a><ul class="nav nav-pills nav-stacked">
<li><a href="#predictions">Predictions</a></li>
      <li><a href="#learner-models">Learner models</a></li>
      <li><a href="#the-extract-option">The extract option</a></li>
      </ul>
</li>
      <li>
<a href="#stratification-blocking-and-grouping">Stratification, Blocking and Grouping</a><ul class="nav nav-pills nav-stacked">
<li><a href="#stratification-with-respect-to-the-target-variables">Stratification with respect to the target variable(s)</a></li>
      <li><a href="#stratification-with-respect-to-explanatory-variables">Stratification with respect to explanatory variables</a></li>
      <li><a href="#blocking-cv-with-flexible-predefined-indices">Blocking: CV with flexible predefined indices</a></li>
      <li><a href="#grouping-cv-with-fixed-predefined-indices">Grouping: CV with fixed predefined indices</a></li>
      </ul>
</li>
      <li><a href="#resample-descriptions-and-resample-instances">Resample descriptions and resample instances</a></li>
      <li>
<a href="#aggregating-performance-values">Aggregating performance values</a><ul class="nav nav-pills nav-stacked">
<li><a href="#example-calculating-the-training-error">Example: Calculating the training error</a></li>
      <li><a href="#example-bootstrap">Example: Bootstrap</a></li>
      </ul>
</li>
      <li><a href="#convenience-functions">Convenience functions</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><!--<div class="copyright">
  <p>Developed by Bernd Bischl, Michel Lang, Lars Kotthoff, Julia Schiffner, Jakob Richter, Zachary Jones, Giuseppe Casalicchio, Mason Gallo, Patrick Schratz.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>
--></footer>
</div>

   <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script><script type="text/javascript"> docsearch({
 apiKey: 'e300ecafdf04fe1199e3339c825ce7d0',
 indexName: 'mlr',
 inputSelector: 'input#search-input.form-control',
 debug: false // Set debug to true if you want to inspect the dropdown
});
</script>
</body>
</html>
